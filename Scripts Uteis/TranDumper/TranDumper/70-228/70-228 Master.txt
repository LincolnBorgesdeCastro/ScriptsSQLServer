This Dump is Victor's Questions for exam 70-228

but with Corrections, Explanations, and References.

Reference Material:

SQL Server 2000 Books On Line (BOL)

SQL Server 2000 Administrator's Companion (SAC)

SQL Server 2000 System Administration (Sys Admin)


1. You are the administrator of a SQL Server 2000 computer. The server contains a database named Sales. The database will store sales transactions. Retail locations must be able to add transactions to the database 24 hours a day every day. The server is configured as shown in the exhibit.
<br><button onClick="window.open('./70-228/images/pic228-01.gif','Exhibit','height=220,width=450,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes,alwaysontop=yes')">Exhibit</button>

You need to configure the data files and transaction log for the Sales database. What should you do?

A. Place the transaction log on physical disk 0 and and the data file on the RAID-5 disk array.
B. Place the transaction log on the RAID-5 disk array and and the data file on physical disk 0.
C. Place the transaction log and the data file on physical disk 0.
D. Place the transaction log and the data file on the RAID-5 disk array

ANSWER: D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>You should choose your disk subsystem for your transaction log to reflect the fact that the primary function of the transaction log is to provide for recoverability of your data in case one or more of the disks containing your data files should fail.<br><BR>The transaction log is critical to the operation, the stability, and the performance of the database server. The transaction log is used to record changes to the database, thus allowing the system to recover in the event of a failure. Because recovery relies on the transaction log, it is important that you use a RAID I/O device to protect this component of the database from possible faults. In the event of the loss of a disk drive, the transaction log should still be available.<br><br><b>--REF: (SAC) ch4, Database Layout, Transaction Log, pg. 64-65<br>--REF: (Sys Admin) ch6, Lesson 4, Transaction Log, pg. 172-173</b></font>








2. You are the administrator of a SQL Server 2000 computer. The server Contains a database named Acct. You purge the Acct database of old records In addition, perform a full backup. The database now uses 4 GB of space. The database files are configured as shown below.

<br><button onClick="window.open('./70-228/images/pic228-02a.gif','Exhibit','height=386,width=406,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>
	
The server has two hard disks that are configured as shown below.
 
<br><button onClick="window.open('./70-228/images/pic228-02b.gif','Exhibit','height=212,width=340,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>

The 3 GB transaction log file for the Acct database is stored on drive C. You need to make room for a new database that has a 3 GB data file and a 1 GB transaction log file. You want to optimize database performance on both databases. You also want to minimize administrative overhead.

What should you do?

A. Shrink the empty data file on drive E. Place the new data file and the new log file on drive E.
B. Shrink the empty data file on drive E. Backup and shrink the log file on drive C to 2 GB. Place the new data file on drive E and the new log file on drive C.
C. Shrink the data file on drive D to 1 GB, and then shrink the data file on drive E to 2 GB. Place the new data file on drive D and the new log file on drive E.
D. Shrink and delete the data file on drive C, and then shrink the database files on drives D and E so that they are both 2 GB. Place the new data file and the new log file on drive C.

ANSWER: B

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>You want to optimize database performance on both databases. You also want to minimize administrative overhead. Answer B is the only option which allows both databases to be on separate physical disks than the Transaction Log file.<br><BR>Create the transaction log on a physically separate disk or RAID (redundant array of independent disks) device. The transaction log file is written serially; therefore, using a separate, dedicated disk allows the disk heads to stay in place for the next write operation.<BR><BR>The next level in optimizing your transaction log performance is to use dedicated disks for the transaction log files for each database. If you use a disk dedicated to a single transaction log, you can ensure that the disk head remains in place from one write operation to the next. Also read requests will be faster because the data will be laid down sequentially on the disk. Thus, using separate disks for the data files and the transaction log files has a transaction log performance benefit as well as being essential for recoverability.<BR><BR>Based on the primary function of the transaction log, the disks containing the transaction log files should not be shared with the data files for the database. Obviously, if your data files and your transaction log files share a common physical disk, you cannot completely recover your data if that disk fails.<br><br><b>--REF: (Sys Admin) ch6, Lesson 4, Transaction Log, pg. 172-173<br>--REF: (BOL) Optimizing Transaction Log Performance, Optimizing database Performance.</b></font>






      3. You are the administrator of a SQL Server 2000 computer. The server 
      contains your company's Accounts database. Hundreds of users access the 
      database each day.

      Because you have had power interruptions in the past, you want to protect 
      the physical integrity of the Accounts database. You do not want to slow 
      down server operations.

      What should you do?

      a. Enable the torn page detection database option for each database.

      b. Disable write caching on all disk controllers.

      c. Ensure that the write caching disk controllers have battery backups.

      d. Create a database maintenance plan to check database integrity and make 
      repairs each night.

      ANSWER: C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><br>
(A) Is wrong because Torn Page Detection allows SQL Server to detect incomplete I/O operations caused by power failures or other system outages it does not protect the physical integrity of the database.

(B) Is wrong because write caching is one of the ways you can protect the physical integrity of the database. RAID and Backups are others. 

(D) Is wrong because nightly database integrity checks and repairs will slow server operations.

To improve I/O performance, many vendors offer controllers with caches. A controller cache is RAM that resides on the disk controller. This cache serves two purposes:
Write caching Because there is memory on the controller, it is possible for the controller to tell the operating system (and subsequently SQL Server) that the I/O operation has been completed as soon as it has been written to the cache, thus greatly increasing write performance. 
Don't use write caching without a battery backup. Most caching controllers include a battery or offer one as an option. This battery retains data in the cache in the event of a power failure. Without this battery, the data in the cache would be lost, and the database might become corrupted.<br><br><b>--REF: (SAC) ch5, I/O Subsystem Concepts, Caching Controllers, pg. 79-80<BR>--REF: (BOL) key word search; "Torn pages" "sp_dboption"</b></font>








      4. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. Pierre reports that he cannot modify data in the database. You use SQL Profiler to capture his activities as shown in the exhibit.

<br><button onClick="window.open('./70-228/images/pic228-04.gif','Exhibit','height=302,width=643,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You want Pierre to be able to modify data. You also want the Transact-SQL 
      statement to execute without compromising data integrity.

      What are two possible ways to achieve this goal? (Each correct answer 
      represents a complete solution. Choose two.)

      a. Change the isolation level of the database connection.

      b. Add indexes to the Products table.

      c. Remove the explicit transaction from the Transact-SQL batch.

      d. Create a stored procedure to execute the Transact-SQL batch.

      e. Add a cascading UPDATE trigger to the Products table

Answer:A, C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>
By isolating the transaction Serializable a HoldLock is placed on the products table. By Creating an Explicit transaction the transaction is written to cache prior to commit. Because of the Holdlock, the transaction is unable to commit and is rolled back. 

Changing the Isolation level removes the lock.
Removing the explicit transaction returns to the default autocommit mode.

Serializable Highest level of isolation
Transactions are completely isolated from each other. At this level, the results achieved by running concurrent transactions on a database are the same as if the transactions had been run serially (one at a time in some order). 

Explicit mode
Is used most often for programming applications and for stored procedures, triggers, and scripts. When you are executing a group of statements to perform a task, you might need to determine at what point the transaction should start and end so that either the entire group of statements succeeds or the entire group's modifications are rolled back. When you explicitly identify the beginning and the end of a transaction, you are using explicit mode, and the transaction is referred to as an explicit transaction. You specify an explicit transaction by using either T-SQL statements or API functions.

A committed transaction
Is one in which all modifications performed by the transaction are made a permanent part of the database. Before a transaction can commit, a record of its modifications and a commit record are written to the database transaction log. Thus, modifications that are a permanent part of the database can be in one of two locations: either the modifications are actually written to disk and thus are literally in the database, or they are in the data cache, and the transaction log can thus roll forward this transaction in the case of a failure so the transaction will not be lost.

In autocommit mode,
Each T-SQL statement is committed when it finishes-there is no need for any additional statements to control transactions with this mode. In other words, each transaction consists of just one T-SQL statement. Autocommit mode is useful when you are executing statements by interactive command line, using OSQL or SQL Server Query Analyzer, because you do not have to worry about explicitly starting and ending each transaction. You know that each statement will be treated as its own transaction by SQL Server and will be committed as soon as it is finished.<br><br><b>--REF: (SAC) ch19, Understanding Transactions and Transaction Locking, pg. 467-483<br>--REF: (BOL) keyword search "explicit transactions", controling transactions<br>--REF: (BOL) keyword search "ACID"</b></font>










      5. You are the database administrator for a retail company. The company owns 
      270 stores. Every month, each store submits approximately 2,000 sales 
      records, which are loaded into a SQL Server 2000 database at the corporate 
      headquarters.

      A Data Transformation Services (DTS) package transforms the sales records 
      as they are loaded. The package writes the transformed sales records to 
      the Sales table, which has a column for integer primary key values. The 
      IDENTITY property automatically assigns a key value to each transformed 
      sales record.

      After loading this month's sales data, you discover that a portion of the 
      data contains errors. You stop loading data, identify the problem records, 
      and delete those records from the database.

      You want to reuse the key values that were assigned to the records that 
      you deleted. you want to assign the deleted key values to the next sales 
      records you load. You also want to disrupt users' work as little as 
      possible.

      What should you do?

      a. Export all records from the Sales table to a temporary table.
      Truncate the Sales table, and then reload the records from the temporary 
      table.

      b. Export all records from the Sales table to a text file.
      Drop the Sales table, and then reload the records from the text file.

      c. Use the DBCC CHECKIDENT statement to reseed the Sales table's IDENTITY 
      property.

      d. Set the Sales table's IDENTITY_INSERT property to ON.
      Add new sales records that have the desired key values.

ANSWER: C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>
When you create a table, you can specify a column as an identity column by adding the IDENTITY property to the column definition. If a column is created with the IDENTITY property, SQL Server automatically generates a row value for that column, based on a seed value and an increment value. The seed is a value that will be the identity value for the first row inserted into the table. The increment is the amount by which SQL Server will increase the identity value for successive inserts.

(A) (B) Would disrupt users' work. 
(C) DBCC CHECKIDENT Checks the current identity value for the specified table and, if needed, corrects the identity value.
(D) Would work but is not the best choice.

By default, identity columns cannot have data inserted directly into them and they cannot be updated. If you want to reinsert a row that was deleted and want to keep the original identity value for that row, you can override the default setting by using the following statement:

<font color=blue>SET IDENTITY_INSERT</font> tablename <font color=blue>ON</font> | <font color=blue>OFF</font><br>

This statement will enable you to insert a row and assign the value you want for its identity column. After you have finished, you should disallow identity column inserts. SQL Server will then take the highest identity value for the column at that time and use it as the seed it must increment for the next inserted row.<br><br><b>--REF: (BOL) Keyword search, "DBCC CHECKIDENT"<br>--REF: (SAC) ch10, Adding the Identity Property, pg. 222</b></font>












      6. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Inventory. The database contains a table that is 
      used to store information about equipment scheduling. The 
      EquipmentSchedules table is configured as shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-06.gif','Exhibit','height=431,width=500,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>
      
      Users report that some equipment schedules have an end date that is 
      earlier than the start date. You need to ensure that the start date is 
      always earlier than or equal to the end date. You also want to minimize 
      physical I/O. You do not want users to change the Transact-SQL statements 
      they use to modify data within the database.

      What should you do?

      a. Create a constraint that compares the start date to the end date.

      b. Create a trigger that compares the start date to the end date.

      c. Create a rule that compares the start date to the end date.

      d. Create a stored procedure that tests the start and end dates before 
      inserting the row into the database.

ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>
Constraints define rules regarding the values allowed in columns and are the standard mechanism for enforcing data integrity.The five types of constraints are NOT NULL, UNIQUE, PRIMARY KEY, FOREIGN KEY, and CHECK.

The CHECK constraint is used to restrict the values allowed in a column to specific values. The values to be inserted or updated in a column are validated if they return TRUE from the specified Boolean search condition in the constraint.For example, if we wanted to restrict the possible range of values that will be allowed in the enddate column of the inventory table, we would use the following statement:

<font color=blue>ALTER TABLE</font> inventory<br><font color=blue>ADD CONSTRAINT</font> ck_date <font color=blue>CHECK</font> (enddate >= startdate)<br>go<br>

<b>--REF: (SAC) ch16, Constraints, pg. 370, 379-381</B></font>












      7. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Inventory. Users report that several storage 
      locations in the UnitsStored field contain negative numbers. You examine 
      the database's table structure. The table properties are configured as 
      shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-07.gif','Exhibit','height=300,width=332,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You correct all the negative numbers in the table. You must prevent the 
      database from storing negative numbers. You also want to minimize use of 
      server resources and physical I/O.

      Which Transact-SQL statement should you execute?

      a. ALTER TABLE dbo.StorageLocations ADD CONSTRAINT
      CK_StorageLocations_UnitsStored
      CHECK (UnitsStored >= 0)

      b. CREATE TRIGGER CK_UnitsStored On StorageLocations
      FOR INSERT, UPDATE AS
      IF INSERTED.UnitsStored < 0 ROLLBACK TRAN

      c. CREATE RULE CK_UnitsStored As @Units >= 0
      GO
      sp_bindrule 'CK_UnitsStored'
      'StorageLocations.UnitsStored'
      GO

      d. CREATE PROC UpdateUnitsStored
      (@StorageLocationID int, @UnitsStored bigint) AS
      IF @UnitsStored < 0
      RAISERROR (50099, 17)
      ELSE
      UPDATE StorageLocations
      SET UnitsStored = @UnitsStored
      WHERE StorageLocationID = @StorageLocationID

      ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><br>
(A) The CHECK constraint is used to restrict the values allowed in a column to specific values.

(B) Triggers, like constraints, can be used to maintain data integrity and business rules, but a trigger should not replace a constraint where a constraint alone is sufficient.SQL Server creates two special, temporary tables when you create a trigger.These tables are always in memory and are local to the trigger, and each trigger can access only its own temporary tables. (This uses server resources).

(C) An alternative to using the CHECK constraint is to create a Rule object to restrict the values that can be inserted or updated in a column. The Rule object is similar to the Default object in that it is created apart from a table and is not deleted when the table is dropped (which uses server resources). The Rule object is available with SQL Server 2000 for backward compatibility. Using the CHECK constraint is the preferred method of restricting column values.

(D) RAISERROR. By default, events that have a severity level less than 19 are not logged, and therefore, an alert cannot be triggered by those events. To enable those events to be logged so that an alert can be triggered, you must use sp_altermessage, the RAISERROR WITH LOG statement, or xp_logevent to change the logging status of the event or message.<br><br><font color=blue> RAISERROR</font> (50099, 17) <font color=blue>WITH LOG</font><br><br>
A user-defined message must have a message ID value (msg_id) of 50001 or greater. The severity parameter is the severity level of the error that the message refers to, ranging from 1 through 25, with higher numbers indicating higher severity of error.
Error messages with a severity level of 10 are informational. Error messages with severity levels from 11 through 16 are generated by the user and can be corrected by the user. Severity levels from 17 and 18 are generated by resource or system errors; the user's session is not interrupted.

<u>Severity Level 10: Status Information:</u>
This is an informational message that indicates a problem caused by mistakes in the information the user has entered. Severity level 0 is not visible in SQL Server.

<u>Severity Levels 11 through 16:</u>
These messages indicate errors that can be corrected by the user.

<u>Severity Level 17; Insufficient Resources:</u>
These messages indicate that the statement caused SQL Server to run out of resources (such as locks or disk space for the database) or to exceed some limit set by the system administrator.<br><br><b>--REF: (BOL) keyword search, "Alert Message Severity Levels"<BR>--REF: (SAC) ch16 Rule Object, pg. 394<br>--REF: (SAC) ch22, What is a Trigger, pg.541<br>--REF: (SAC) ch31, Event Message Logging, pg.557-558</b></font>












      8.  You are the administrator of a SQL Server 2000 computer. You have two new 
      hard disks on which you will create a database named Inventory. You want 
      to insert, update, and delete data as quickly as possible.

      Which two actions should you take? (Each correct answer represents part of 
      the solution. Choose two.)

      a. Configure the hard disks as two mirrored NTFS volumes.

      b. Configure the hard disks as one mirrored NTFS volume.

      c. Configure the hard disks as two independent NTFS volumes.

      d. Configure the hard disks as one extended NTFS volume.

      e. Place Inventory_data.mdf on the first volume and Inventory_log.ldf on 
      the second volume.

      f. Place Inventory_data.mdf and Inventory_log.ldf on the first volume and 
      Inventory_data2.ndf and Inventory_log2.ldf on the second volume

      g. Place Inventory_data.mdf and Inventory_log.ldf on the same volume.


ANSWER: C, E

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>The goal is to optimize performance. Isolate the SQL Server transaction log onto its own volume. I/O operations to the transaction log are almost 100 percent sequential and almost 100 percent writes. The only time the transaction log handles random I/O is during a rollback operation. If the data needed for a rollback is no longer cached, the information must be read from the transaction log.<br><br><b>--REF: (SAC) ch5, I/O Subsystem Tips and Recommendations, pg. 100-102<br>--REF: (SAC) ch9, Database Structure, pg. 179-186</b></font>











      9. You are the administrator of a SQL Server 2000 computer. The sever 
      contains a database named Inventory. The database has a Parts table that 
      has a field named InStock.

      When the parts have shipped, a table named PartsShipped is updated. When 
      the parts are received, a table named PartsReceived is updated. The 
      relationship of these tables is shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-09.gif','Exhibit','height=246,width=335,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You want the database to update the InStock field automatically. What 
      should you do?

      a. Add triggers to the PartsShipped and the PartsReceived tables that 
      update the InStock field in the Parts table.

      b. Create a user-defined function that calculates current inventory by 
      running aggregate queries on the PartsShipped and PartsReceived tables.

      c. Use a view that creates an InStock field as part of an aggregate query.

      d. Create stored procedures for modifying the PartsShipped and 
      PartsReceived tables that also modify the InStock field in the Parts table.
      Use these procedures exclusively when modifying data in the PartsShipped 
      and PartsReceived tables.


ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Aggrigate queries use aggrigate functions to combine rows, columns, tables, and views. They do not update the tables. Therefore, (B) and (C) are incorrect. Creating procedures is not the best choice as it does not guarantee an update of the parts table if other methods are used to change data in the PartsShipped and PartsReceived tables.
 
Triggers can cascade changes through related tables in the database. For example, you can write a delete trigger on the title_id column of the titles table to cause a deletion of matching rows in other tables. The trigger uses the title_id column as a unique key to locate matching rows in the titleauthor, sales, and roysched tables.

To summarize all the data in a table, you create an aggregate query that involves a function such as SUM( ) or AVG( ). When you run the query, the result set contains a single row with the summary information. Aggregate functions perform a calculation on a set of values and return a single value.<br><br><b>--REF: (BOL) keyword search, "triggers"<br>--REF: (BOL) keyword search, "Aggrigate querry"-- aggrigate function</b></font>













      10. You are the administrator of a SQL Server 2000 computer. The server is 
      configured as shown in the Database Server Configuration exhibit.

     <br><button onClick="window.open('./70-228/images/pic228-10a.gif','Exhibit','height=225,width=343,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You need to create a new database named Inventory. Employees in your 
      company will use the Inventory database to track inventory data. Users 
      will require immediate responses to queries that help them locate where 
      parts are stored. The tables in the database will be configured as shown 
      in the Database Schema exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-10b.gif','Exhibit','height=245,width=522,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      The database will consume 14 GB of disk space. You must configure the data 
      files and transaction log to accellerate query response time.

      Which two courses of action should you take? (Each correct answer 
      represents part of the solution. Choose two.)

      a. On drive C, create a transaction log.
      On drive D, create a data file in the PRIMARY filegroup.
      On drive E, create a data file in the SECONDARY filegroup.

      b. On each drive, create a transaction log.
      On each drive, create a data file in the PRIMARY filegroup.

      c. On drive D, create a transaction log.
      On drive E, create a data file in the PRIMARY filegroup.

      d. On the PRIMARY filegroup, create all tables and all indexes.

      e. On the PRIMARY filegroup, create all tables. On the SECONDARY 
      filegroup, create all indexes.

      f. On the PRIMARY filegroup, create the Parts table and its indexes.
      On the SECONDARY filegroup, create all other tables and their indexes.

ANSWER: A, E

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>It is advantageous to get as much data spread across as many physical drives as possible in order to improve throughput through parallel data access using multiple files.

For heavily accessed tables, place these tables in one filegroup and place the table's indexes in a different filegroup on different physical disk arrays. This will improve performance, because separate threads will be created to access the tables and indexes.<br><br><b>--REF: (BOL) keyword search "Placing Tables on Filegroups" <br>--REF: (SAC) ch9, Filegroups, pg.181<br>--REF: (Sys Admin) ch8, Lesson 2,pg.233<BR>--REF: <a href="http://www.sql-server-performance.com/ac_filegroup_performance.asp" target="_blank">www.sql-server-performance.com</a></b></font>











      11. You are the administrator of a database that contains 64 lookup tables. 
      These tables store static data that should not change. However, users 
      report that some of this data is being changed. You need to prevent users 
      from modifying the data.

      You want to minimize changes to your security model and to your database 
      applications. How should you modify the database?

      a. Create a filegroup named LOOKUP.
      Move the lookup tables to this filegroup.
      Select the read only check box for the filegroup.

      b. Create a database role named DataModifier.
      Grant the SELECT permissions to the DataModifier role.
      Add all users to the role.

      c. Deny INSERT, UPDATE and DELETE permissions for all users.
      Create stored procedures that modify data in all tables except lookup 
      tables.
      Require users to modify data through these stored procedures.

      d. Create a view of the lookup tables.
      Use the view to allow users access to the lookup tables.

ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Microsoft® SQL Server™ 2000 allows filegroups to be marked as read-only. Any existing filegroup, except the primary filegroup, can be marked as read-only. A filegroup marked read-only cannot be modified in any way.

Place tables that must not be modified, such as historical data, on filegroups, and then mark the filegroup as read-only. This prevents accidental updates. The read-only filegroup can then be backed up and restored on another instance of SQL Server without concern for recovery of transaction logs.<BR><BR><B>--REF: (BOL) keyword search, "Read-Only Filegroups"</B></font>












      12. You are the administrator of a SQL Server 2000 computer. One of these 
      servers contains a 4-GB database named Marketing. You want to remove the 
      Marketing database from one server and add it to the other as quickly as 
      possible.

      What should you do?

      a. Detach the database from the original server by using the sp_detach_db 
      stored procedure.
      Copy the database and the transaction log files to the new server, and 
      attach them by using the sp_attach_db stored procedure.

      b. Use the DTS Export Wizard to transfer all database objects from the 
      original server to the new server.
      Drop the existing database from the original server.

      c. Run a full backup of the database on the original server.
      Create a new database named Marketing on the new server.
      Restore the backup in the new Marketing database.
      Drop the database from the original server.

      d. Shut down the original server.
      Copy the database and the transaction log files to the new server.
      Use the DISK INIT and DISK REFIT state


ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>If you need to move a database from one server to another, the quickest way is to detach the database using sp_detach_db, copy the database file to the new server, and then attach the database using  sp_attach_db.

Keep in mind that if you do this, that the login IDs that match the database user IDs in the moved database must exist on the new server, otherwise any current database user IDs in the moved database will not work.<BR><BR><B>--REF: <a href="http://www.sql-server-performance.com/sql_server_maintenance.asp" target="_blank">www.sql-server-performance.com</a></b></font>













      13. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Inventory. In this database, the Parts table has 
      a primary key that is used to identify each part stored in the company's 
      warehouse. Each part has an unique UPC code that your company's accounting 
      department uses to identify it. The database is configured as shown in the 
      exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-13.gif','Exhibit','height=237,width=526,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>

      You want to maintain the referential integrity between the Parts table and 
      the OrderDetails table. You want to minimize the amount of physical I/O 
      that is used within the database.

      Which two Transact-SQL statements should you execute? (Each correct answer 
      represents part of the solution. Choose two.)

      a. CREATE UNIQUE INDEX IX_UPC On Parts(UPC)

      b. CREATE UNIQUE INDEX IX_UPC On OrderDetails(UPC)

      c. CREATE TRIGGER UPCRI On OrderDetails
      FOR INSERT, UPDATE As
      If Not Exists (Select UPC From Parts
      Where Parts.UPC = inserted.UPC) BEGIN
      ROLLBACK TRAN
      END

      d. CREATE TRIGGER UPCRI On Parts
      FOR INSERT, UPDATE As
      If Not Exists (Select UPC From Parts
      Where OrderDetails.UPC = inserted.UPC) BEGIN
      ROLLBACK TRAN
      END

      e. ALTER TABLE dbo.OrderDetails ADD CONSTRAINT
      FK_OrderDetails_Parts FOREIGN KEY(UPC)
      REFERENCES dbo.Parts(UPC)

      f. ALTER TABLE dbo.Parts ADD CONSTRAINT
      FK_Parts_OrderDetails FOREIGN KEY (UPC)
      REFERENCES dbo.Parts(UPC)

ANSWER:A, E 

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>You want to maintain the referential integrity between the Parts table and the OrderDetails table.You want to minimize the amount of physical I/O that is used within the database. Because the PARTS table has the primary key that is used to identify each part stored in the company's warehouse, you would want the ORDERS table to stay consistent with the PARTS table which would make (B) AND (F) wrong.

Triggers, like constraints, can be used to maintain data integrity and business rules, but a trigger should not replace a constraint where a constraint alone is sufficient.SQL Server creates two special, temporary tables when you create a trigger.These tables are always in memory and are local to the trigger, and each trigger can access only its own temporary tables. (This uses server resources).
     
the unique constraint on the parts table UPC column is required first, in order that the Foreign Key constraint can be applied from the OrderDetails.UPC column referencing Parts.UPC. This achieves the referential integrity requirement. It also reduces I/O required during joins between Parts and OrderDetails which make use of the Foreign Key constraint defined.<BR><BR><B>--REF: (SAC) ch22, What is a Trigger,pg.541<br>--REF: Unknown Dumper</b></font>












      14. You are the administrator of a SQL Server 2000 computer named SQL1. You 
      want to perform ad hoc distributed queries against a database that is 
      stored on a SQL Server 2000 computer named SQL2. SQL2 contains several 
      databases, and each of these databases uses a different collation.

      You want to ensure that comparisons in distributed queries are evaluated 
      correctly. You also want to minimize administrative overhead.

      How should you configure SQL1?

      a. Use the ALTER DATABASE statement to change the collation of the 
      database SQL1.

      b. Add SQL2 as a remote server.

      c. Add SQL2 as a linked server.
      Select the Use Remote Collation check box, and do not specify a collation 
      name.

      d. Add SQL2 as a linked server.
      Select the Use Remote Collation check box, and specify a collation name.
      Repeat this process once for each database on SQL2.

ANSWER: C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>SQL Server 2000 can connect to linked servers. The primary use of a linked server configuration is the execution of distributed queries, joining information from multiple databases on multiple servers (such as SQL Server 2000, SQL Server 7.0, Oracle, and Access).If the linked server is defined as Microsoft® SQL Server™, remote stored procedures can be executed.

<B><U>Use Remote Collation</b></u> Determines whether the collation of a remote column or of a local server will be used. If true, the collation of remote columns is used for SQL Server data sources, and the collation specified in collation name is used for non-SQL Server data sources. 

<B><U>Collation Name</b></u> Specifies the name of the collation used by the remote data source if use remote collation is true and the data source is not a SQL Server data source. The name must be one of the collations supported by SQL Server.Use this option when accessing an OLE DB data source other than SQL Server, but whose collation matches one of the SQL Server collations. 
      <br><button onClick="window.open('./70-228/images/pic228-14.gif','Exhibit','height=386,width=406,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Entrprise Manager</button><BR><BR><B>--REF: (SYS ADMIN) ch12, Lesson2, pg389<BR>--REF: (BOL) keyword search "linked servers"<BR>--REF: (BOL) keyword search "sp_server option"</B></font>
    









      15. You are the administrator of a SQL Server 2000 computer. The server 
      contains seven databases that provide data to several company 
      client/server applications. Each database is maintained by a different 
      user.

      You need to configure server and database permissions so that each user 
      who maintains a database has full permissions on that database. What 
      should you do?

      a. Create a domain user group for all users.
      Add a login for the domain user group.
      Add the login to the sysadmin server role.

      b. Create a domain user group for all users.
      Add a login for the domain user group.
      Map the login to a database user in each database.
      Add all database users to the db_owner database role in each database.

      c. Create a login for each user's domain user account.
      Map each login to a database user in the appropriate databases.
      Add the database users to the db_owner database role in each database.

      d. Create a login for each user's domain user account.
      Add the logins to the dbcreator server role.

ANSWER: C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Each database object is owned by either a user or a role.  If the owner is a role, the object is co-owned by every user belonging to that role.<BR>Each object also has privileges associated with it. A privilege grants a particular authority to an object for either an individual user or for all users belonging to a particular role.

A <B>db_owner</B> Performs the activities of all database roles, as well as other maintenance and configuration activities in the database. The permissions of this role span all of the other fixed database roles. 

A <B>dbcreator</b> Can create, alter, and drop databases.

The <B>sysadmin</b> server role Performs any activity in SQL Server. The permissions of this role span all of the other fixed server roles.<BR><BR><B>--REF: (BOL) keyword search "database roles", Adding a member to a Predefined Role</b></font> 











      16. You are the administrator of a SQL Server 2000 computer. The server 
      contains a Data Transformation Services (DTS) package that queries 
      multiple databases and writes the results to a text file. You run this 
      package by using a Microsoft Windows batch file. The batch file uses the 
      dtsrun utility to execute the DTS package.

      You want to ensure that connection properties, such as login names and 
      passwords, cannot be read or modified by users. Which two actions should 
      you take? (Each correct answer represents part of the solution. Choose 
      two.)

      a. Save the DTS package so that it has an owner password.

      b. Save the DTS package so that it has an user password.

      c. Encrypt the DTS package details in the command line of the dtsrun utility.

      d. Store the DTS package in the Meta Data Services repository.

      e. Store the DTS package as a Microsoft Visual Basic file.

ANSWER:A, C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><br>An <i>Owner Password</i> protects any sensitive user name and server password information in the package from unauthorized users. If the package has an owner password, the data is encrypted with the standard encryption API. <U>This option is available only for packages saved to SQL Server or as a structured storage file.</U><BR><BR>Setting a package <i>User Password</i> only allows a user to execute a package. 

The " / Z " Argument with the dtsrun utility Indicates that the command line for dtsrun is encrypted using SQL Server 2000 encryption.

By saving the dts package in the Mata Data Services repository you loose the <i>Owner Password</i> option.

By saving the dts package as a Microsoft Visual Basic file you loose the <i>Owner Password</i> option, and the security options available when you save the dts package to SQL Server or Meta Data services.

<B><I><font color=teal>Saving the package to SQL Server or Meta Data Services, you have the following options:</b></i></font><BR>

<u>Server name:</u> Specify the name of the SQL Server installation storing the package.

<u>Use Windows Authentication:</u> Specify the security mode used to connect to SQL Server. The Windows Authentication used will be the Microsoft Windows® login of the user creating the package.

<u>Use SQL Server Authentication:</u> Specify the security mode used to connect to an instance of SQL Server. 

<u>User name:</u> Specify a user name for the connection to an instance of SQL Server. 

<u>Password:</u> Specify a password for the connection to an instance of SQL Server.<BR><BR><B>--REF: (BOL) key word search "dts Run Utility", "Save dts Package"</b></font>












      17. You are the administrator of a SQL Server 2000 computer. The server is 
      used to store information for your company's finance department.

      The permissions on the FinanceData table are configured as shown in the 
      Database Permissions exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-17a.gif','Exhibit','height=114,width=300,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>

      Stefan's database user account is configured as shown in the Login 
      Properties exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-17b.gif','Exhibit','height=282,width=300,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>

      Stefan reports that he is unable to delete information from the 
      FinanceData table. You need to allow him to delete information from the 
      table.

      Which Transact-SQL statement should you execute?

      a. EXEC sp_droprolemember 'Accountants', 'Stefan'

      b. EXEC sp_droprolemember 'Administrators', 'Stefan'

      c. EXEC sp_addrolemember 'db_datawriter', 'Stefan'

      d. EXEC sp_addrolemember 'db_owner', 'Stefan'


ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>The permissions applied to Stefan are the union of the permissions granted, revoked, or denied to the Accountants, Administrators, and public roles. Any DENY permission overrides any corresponding GRANT permissions.

Making Stefan a memder of the db_owner role might be giving him more permissions than you want. Furthermore, if Stefan is not logged on as the database owner, or a user that is a member of the db_owner role, Stefan will have limited privileges to the database.  The privileges you have are determined by the permissions granted to your logon ID and the privileges granted to the roles that your logon ID is a member of.<BR><BR><B>--REF: (BOL) keyword search "DENY"</b></font>










      18. You are the administrator of a SQL Server 2000 computer. Peter is an 
      employee in your company's marketing department. Peter has a SQL Server 
      login named Peter, and he has access to a database named MarketingData.

      Peter has been assigned to a research project and needs to view and edit 
      information stored in a database named ResearchData. The database is 
      contained on the same server as the MarketingData database.

      You need to configure the appropriate permissions for Peter on the 
      ResearchData database. Which Transact-SQL statement should you execute?

      a. GRANT ALL ON ResearchData TO Peter

      b. GRANT SELECT ON ResearchData TO Peter
      GRANT INSERT ON ResearchData TO Peter
      GRANT UPDATE ON ResearchData TO Peter

      c. EXEC sp_addrolemember 'db_datareader','Peter'
      EXEC sp_addrolemember 'db_datawriter','Peter'

      d. EXEC sp_grantdbaccess 'Peter',' PeterU'
      GO
      EXEC sp_addrolemember 'db_datareader',' PeterU'
      EXEC sp_addrolemember 'db_datawriter',' PeterU'

ANSWER: D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><BR><BR>
<font color=blue>GRANT </font><font color=gray>ALL </font><font color=blue>ON </font>ResearchData <font color=blue>TO </font> Peter<BR><BR> grants Peter all permissions for a table(object) named researchdata. It does not grant him access to the ResearchData database.<BR><BR>
<font color=blue>GRANT SELECT ON</font> ResearchData <font color=blue>TO</font> Peter<BR>
<font color=blue>GRANT INSERT ON</font> ResearchData <font color=blue>TO</font> Peter<BR>
<font color=blue>GRANT UPDATE ON</font> ResearchData <font color=blue>TO</font> Peter<BR><BR>
Grants Peter Insert, Select, and update permissions for a table(object) named researchdata. It does not grant him access to the ResearchData database.<BR><BR>
<font color=blue>EXEC </font><font color=maroon>sp_addrolemember </font><font color=red>'db_datareader'</font>,<font color=red>'Peter'</font><BR>
<font color=blue>EXEC </font><font color=maroon>sp_addrolemember </font><font color=red>'db_datawriter'</font>,<font color=red>'Peter'</font><BR><BR>
Does not Grant Peter access to the ResearchData database<BR><BR>
<font color=blue>EXEC </font><font color=maroon>sp_grantdbaccess 'Peter',' PeterU'</font><BR>
GO<BR>
<font color=blue>EXEC </font><font color=maroon>sp_addrolemember </font><font color=red>'db_datareader'</font>, <font color=red>PeterU'</font><BR>
<font color=blue>EXEC </font><font color=maroon>sp_addrolemember </font><font color=red>'db_datawriter'</font>, <font color=red>'PeterU'</font><BR><BR>
The Peter account must be granted access to the current database before it can use the database.<BR>
<font color=red>'db_datareader'</font> Can select <U>all data from any user table</u> in the database.<BR> 
<font color=red>'db_datawriter'</font> Can modify <u>any data in any user table</u> in the database.<BR><BR><B>--REF: (BOL) keyword search "sp_grantdbaccess", "Roles"











      19. You are the administrator of two Mircosoft Windows 2000 computers. One 
      computer is running Internet Information Services (IIS), and the other is 
      running SQL Server 2000. Company partners need to connect by means of the 
      Internet and query data stored on the SQL Server computer. Some of these 
      partners have computers that do not use Microsoft operating systems or Web 
      browsers.

      You need to configure the IIS and SQL Server 2000 computers to allow 
      access to data by means of the IIS virtual directory. IIS uses Basic 
      Authentication to allow access to the virtual directory.

      Only company partners should have access to the SQL Server computer by 
      means of the Internet. The partners should be allowed to make ad hoc 
      queries. You want to be able to audit successful and failed logins to the 
      SQL Server computer.

      You want to allow the partners access to the SQL Server computer while 
      keeping your security scheme as simple as possible. Which two actions 
      should you take? (Each correct answer represents part of the solution. 
      Choose two.)

      a. Configure the IIS virtual directory to allow URL queries.

      b. Configure the IIS virtual directory to allow template queries.

      c. Create a new Windows user account.
      Create a corresponding Windows Authenticated login on the SQL Server 
      computer. Configure the IIS virtual directory to always use this login 
      when connecting to the SQL Server computer.

      d. Create a Windows Authenticated login on the SQL Server computer for the 
      IIS Internet Guest Account.
      Configure the IIS virtual directory to always use the Internet Guest 
      Account when connecting to the SQL Server computer.

      e. Create a Windows Authenticated login for each company partner on the 
      SQL Server computer.
      Configure the IIS virtual directory to use Windows Integrated 
      Authentication when connecting to the SQL Server computer.

ANSWER: A, C
 
<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><BR><B>Key points in the scenario are:</B> Some of these partners have computers that do not use Microsoft operating systems or Web browsers.<BR>IIS uses Basic Authentication to allow access to the virtual directory.<BR>The partners should be allowed to make ad hoc queries.<BR>One computer is running Internet Information Services (IIS), and the other is running SQL Server 2000.<BR><BR><B>Use Basic Authentication (Clear Text) to SQL Server account Select to uthenticate by prompting for a SQL Server login and password.</b><BR><BR>This option differs from the Basic Authentication method of IIS Authentication security. By selecting this option, a user is prompted for a SQL Server login and password. In this authentication option, anonymous authentication is enabled in IIS. The login supplied by the user must be a valid SQL Server login. Therefore, when you attempt to access the database, the ISAPI first tries the anonymous access; and if this fails, an error message is sent to the browser. The browser then shows a dialog box requesting a user name and password for SQL Server.<BR><BR>If SQL Server is installed on a machine other than the Web server, using integrated security also limits the available authentication options. Challenge/response authentication cannot be used, and the only available options are basic authentication and anonymous authentication. Allowing anonymous authentication in an otherwise secure system on the Internet is generally not advised, and, as mentioned, using basic authentication limits the benefits of connection pooling.<BR><BR><B>Template:</b> A concept introduced in SQL Server 2000, a template is a valid XML document containing one or more SQL statements. The template files are used to specify queries (SQL and XPath queries). Instead of specifying queries in the URL, template files containing the queries are specified in the URL. A template is a valid XML document, consisting of one or more SQL queries. This option is enabled by default.<BR><BR><font color=teal><b>Ad hoc:</b> done for particular purpose: done or set up solely in response to a particular situation or problem and without considering wider issues.</font><BR>For "ad hoc template querries", you would need templates for every particular purpose.<BR><BR><a href="http://www.sql-server-performance.com/tw_sample_chapter/46721504.htm" target="_blank"><font color=teal><b>Calling Stored Procedures in URLs</font></b></a><BR><BR><B>--REF: (BOL) keyword search "IIS"<BR>--REF: (SAC) ch23, Choosing Network Liberary, pg. 572<BR>--REF: <a href="http://www.sql-server-performance.com/tw_sample_chapter/46721504.htm" target="_blank">SQL-server-performance.com</a><BR>--REF: <a href="http://localhost/iisHelp/iis/misc/default.asp" target="_blank">iisHelp</a></b></font>











      20. You are the administrator of a SQL Server 2000 computer. The server is 
      used to store information for your company's sales department.

      The permissions on the SalesFigures table are configured as below
<P ALIGN="center"><img src="./70-228/images/pic228-20.gif"></P>
      Lilly is a user in the sales department. She needs to review the data in 
      the SalesFigures table. She also needs to add new items to the table.

      You need to allow Lilly to perform these tasks without giving her 
      additional permissions to the database. What should you do? (Each correct 
      answer represents part of the solution. Choose all that apply.)

      a. Add Lilly to the Managers database role.

      b. Add Lilly to the Salespeople database role.

      c. Grant Lilly INSERT permissions on the table.

      d. Grant Lilly UPDATE permissions on the table.

      e. Revoke UPDATE permissions on the table for Lilly.

      f. Revoke DELETE permissions on the table for Lilly.

  ANSWER: B, C
 
<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Lilly needs to review (<B>SELECT</b>) and add new items to the table (<B>INSERT</B>). You could add Lilly to the Accountants database role, but that was not an option.<BR><BR>(A) is wrong because it gives Lilly more permissions then she needs.<BR>(B) is correct because it gives Lilly the <B>SELECT</B> permission.<BR>(C) is correct because it gives Lilly the <B>INSERT</B> Permission.<BR>(D) is wrong because the <B>UPDATE</b> permission permits a user to issue UPDATE statements against a table or view. It does not allow a user to add new items to a table or view.<BR>(E), (F) are wrong because even if you were to add Lilly to the Accountants or Managers role, revoking the update and delete permissions would effect other members in the roles. The Salespeople and guest role Update and Delete permissions are already revoked.<BR><BR><B>--REF: (BOL) keyword search "Permissions"</B></font>













      21. You are the administrator of a SQL Server 2000 computer. The server will 
      be used to contain data from your company's accounting, enginering, and 
      production departments.

      Each department is contained in a Microsoft Windows domain users group. 
      The groups are named Accounting, Engineering, and Production. Members of 
      each department need to read and modify their data. However, users in one 
      department should not have access to data in other departments.

      You want to configure the database so that it meets your company's 
      security requirements. You also want to minimize administration time and 
      the consumption of server resources.

      Which three actions should you take? (Each correct answer represents part 
      of the solution. Choose three.)

a. Create a database for each department.
b. Create a database for all departments.
c. Create a Windows-Authenticated login for each department.
d. Create a named instance of SQL Server 2000 for each department.
e. Map each domain users group to the processadmin role.
f. Map each domain users group to the db_datareader and db_datawriter database roles.
g. Grant each domain users group SELECT, INSERT, UPDATE, and DELETE permissions on the database objects that are used by that department.

ANSWER:A, C, F

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><BR><BR>(B) Users would share all data. Users in one department would have access to data in other departments. You would need to create views but that would not minimize administration time and add to the consumption of server resources.<BR>(D) would not minimize administration time, would increase the consumption of server resources AND require (A), (C), and (F) to work.<BR>(F) Members of the Microsoft® SQL Server™ fixed server role processadmin have permission to control executing server processes. The processadmin, role has permission to execute only the KILL Transact-SQL statement.<BR>(G) Would not minimize administration time.<BR><BR><B>--REF: (BOL) keyword search "views", "Users", "Roles"</B></font>















      22. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Employee Data. Your company's human resources 
      department uses this database, which contains several tables as shown in 
      the following table.<BR><BR>
<TABLE BORDER CELLSPACING=1 CELLPADDING=7 WIDTH=516>
<TR><TD WIDTH="22%" VALIGN="TOP" BGCOLOR="#c0c0c0" HEIGHT=13>
<B><FONT FACE="Arial" SIZE=2><P ALIGN="CENTER">Table name</B></FONT></TD>
<TD WIDTH="78%" VALIGN="TOP" BGCOLOR="#c0c0c0" HEIGHT=13>
<B><FONT FACE="Arial" SIZE=2><P ALIGN="CENTER">Used for</B></FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="TOP" HEIGHT=10>
<FONT FACE="Microsoft Sans Serif" SIZE=2><P>Employees</FONT></TD>
<TD WIDTH="78%" VALIGN="TOP" HEIGHT=10>
<FONT FACE="Microsoft Sans Serif" SIZE=2><P>Employee names, addresses, departments, and base salaries</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="TOP" HEIGHT=13>
<FONT FACE="Microsoft Sans Serif" SIZE=2><P>Bonuses</FONT></TD>
<TD WIDTH="78%" VALIGN="TOP" HEIGHT=13>
<FONT FACE="Microsoft Sans Serif" SIZE=2><P>Bonuses that have been paid to employees</FONT></TD>
</TR>
<TR><TD WIDTH="22%" VALIGN="TOP" HEIGHT=22>
<FONT FACE="Microsoft Sans Serif" SIZE=2><P>Awards</FONT></TD>
<TD WIDTH="78%" VALIGN="TOP" HEIGHT=22>
<FONT FACE="Microsoft Sans Serif" SIZE=2><P>Awards that have been presented to employees</FONT></TD>
</TR>
</TABLE><BR>
      The human resources department wants to make employee names, addresses, 
      and awards available to anyone who has permission to access the server. 
      However, the human resources department wants to allow only users in the 
      human resources department to access salary and bonus information.

      You need to allow company users to access only the appropriate employee 
      information. What should you do?

      a. Create a trigger on the Salary column of the Employees table.

      b. Create a stored procedure that retreives all of the data from the 
      Employees and Awards tables, inserts the data into a temporary table, and 
      then grants the current user SELECT permissions on the temporary table.
      Grant the Guest database user EXECUTE permissions on the stored procedure.

      c. Move the sensitive information out of the Employees table into a new 
      table.
      Grant the Guest database user SELECT permission on the Employees table.

      d. Create a view that contains the name, address, and award information.
      Grant the Guest database user SELECT permissions on the view.

ANSWER: D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>A view, like an index, exists independently of the data but is closely tied to that data. A view is used to filter, or process, data before users access it. A view is a virtual table that is defined by a query consisting of a SELECT statement. This virtual table is made up of data from one or more real tables, and to users, a view looks like an actual table. In fact, a view can be treated exactly like a regular table. Users can reference these virtual tables in Transact-SQL (T-SQL) statements in the same way tables are referenced. SELECT, INSERT, UPDATE, and DELETE operations can be performed on a view.<BR><BR>
<FONT color="teal"><B>Types of Views</B></font>
<UL>
<B><LI>Subset of table columns</B> A view can consist of one or more columns in a table. Probably the most common type of view, it can be used for data simplification or security. </LI>
<B><LI>Subset of table rows</B> A view can contain as few or as many rows as desired. This type of view is also useful for security. </LI>
<B><LI>Join of two or more tables</B> You can create a view by using a join operation. Complex join operations can be simplified when a view is used. </LI>
<B><LI>Aggregate information</B> You can create a view that contains aggregated data. This type of view is also used to simplify complex operations.</LI></UL>The advantage of using views is that views with different attributes can be created without having to duplicate the data.<BR><BR><B>--REF: (SAC) ch18, what is a view, types of views, pg.435, 436 </b></FONT>














      23. You are the administrator of a SQL Server 2000 computer. The server is 
      used to store sales and product information for your company. A 
      client/server application accesses the server by activating an application 
      role named SalesAppRole.

      Several users report that they are unable to use the client/server 
      application. You test the application and discover that it cannot log on 
      to the server.

      You examine your security audit logs, which contian the information shown 
      in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-23.gif','Exhibit','height=233,width=555,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You need to enable the application to log on to the server. What should 
      you do?

      a. Configure the database permissions to deny Maria access to the database.

      b. Reset the password on the SalesAppRole application role.

      c. Reset the permissions on the SalesAppRole application role.

      d. Add the SalesAppRole application role to the db_owner database role.

      e. Remove Bruno's database user account.

      f. Enable encryption on the password for the SalesAppRole application role.

ANSWER: B

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>The security audit logs show Bruno changed the application role Password. All other selections would not allow the application to log on to the server.<BR><BR>Application roles are different than standard roles in that:<BR><BR>Application roles contain no members.<BR><BR>Microsoft Windows NT® 4.0 or Windows® 2000 groups, users, and roles cannot be added to application roles; the permissions of the application role are gained when the application role is activated for the user's connection through a specific application or applications. A user's association with an application role is due to his ability to run an application that activates the role, rather than his being a member of the role.<BR><BR>Application roles are inactive by default and <u>require a password to be activated.</u><BR><BR>Application roles bypass standard permissions.<BR><BR><B>--REF: (BOL) keyword search "application roles"</B></font>











      24. You are the administrator of a SQL Server 2000 computer. The server is 
      used to store confidential company information. Company policy requires 
      that every action and change of permission on the server be logged. Policy 
      also requires that the server can run only when logging is enabled.

      You need to configure the server to comply with this policy. What should 
      you do?

      a. Use SQL Profiler to capture security events and audit events.
      Make sure that file rollover is enabled.

      b. On the Security tab of the Server Properties dialog box, set the Audit 
      Level to All.

      c. Configure the server to use Windows Authentication.
      Make sure the Windows security log does not overwrite events.

      d. Set the c2 audit mode option to 1.
      Restart the MSSQLServer service.

ANSWER: D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>In Microsoft® SQL Server™ 2000, use the <B>c2 audit mode</b> option to review both successful and unsuccessful attempts to access statements and objects. With this information, you can document system activity and look for security policy violations.

C2 auditing tracks C2 audit events and records them to a file in the \mssql\data directory for default instances of SQL Server 2000, or the \mssql$instancename\data directory for named instances of SQL Server 2000. If the file reaches a size limit of 200 megabytes (MB), C2 auditing will start a new file, close the old file, and write all new audit records to the new file. This process will continue until SQL Server is shut down or auditing is turned off. 

To enable C2 auditing, set the <B>c2 audit mode</B> option to 1. This setting establishes the C2 audit trace and turns on the option to fail the server should the server be unable to write to the audit file for any reason. After setting the option to 1, restart the server to begin C2 audit tracing. To stop C2 audit tracing, set <b>c2 audit mode</b> to 0.<BR><BR><B>--REF: (BOL) keyword search "c2 audit mode Option"</b></font>











      25. You are the administrator of a SQL Server 2000 computer. The server is a 
      member of a Windows NT domain and is configured for Windows Authentication.

      The server contains a database that stores contact information for public 
      officials in your region. These officials need to access the database by 
      means of the Internet by using the Guest login. However, some users report 
      that they cannot connect to the server by means of the Internet.

      You need to allow anyone access to the server by means of the Internet. 
      What should you do?

      a. Assign the Guest login a blank password.

      b. Delete the Guest login and create a new login that is mapped to the 
      Guest domain user account.

      c. Create a database user named Anonymous and assign the user the 
      appropriate database permissions.

      d. Configure the server for Mixed Mode authentication.

ANSWER: D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>When SQL Server 2000 is running in Mixed Mode, a user can connect to a SQL Server 2000 instance using either Windows authentication or SQL Server authentication. Using this mode is required for users connecting directly to SQL Server 2000 from Novell NetWare, Apple Macintosh, Banyan Vines, UNIX, and Linux clients. However, using Mixed Mode is inherently less secure than using Windows Authentication Mode, and you should only use it when absolutely necessary.
<BR><P ALIGN="CENTER"><CENTER><TABLE BORDER CELLSPACING=1 BORDERCOLOR="#000000" CELLPADDING=4 WIDTH=787>
<TR><TD WIDTH="50%" VALIGN="MIDDLE" BGCOLOR="#008080">
<B><FONT FACE="Microsoft Sans Serif" SIZE=2 COLOR="#ffffff"><P ALIGN="CENTER">Windows Authentication</B></FONT></TD>
<TD WIDTH="50%" VALIGN="MIDDLE" BGCOLOR="#008080">
<B><FONT FACE="Microsoft Sans Serif" SIZE=2 COLOR="#ffffff"><P ALIGN="CENTER">SQL Server Authentication </B></FONT></TD>
</TR>
<TR><TD WIDTH="50%" VALIGN="MIDDLE" HEIGHT=54>
<FONT FACE="Arial" SIZE=2><P>When a user logs into the Windows domain, the user name and password are encrypted before being passed to the Windows domain controller.</FONT></TD>
<TD WIDTH="50%" VALIGN="MIDDLE" HEIGHT=54>
<FONT FACE="Arial" SIZE=2><P>The Windows operating system never authenticates the user.</FONT></TD>
</TR>
<TR><TD WIDTH="50%" VALIGN="MIDDLE" HEIGHT=24>
<FONT FACE="Arial" SIZE=2><P>When an authenticated user presents authentication credentials to a SQL Server 2000 instance, the Kerberos ticket or access token submitted is encrypted.</FONT></TD>
<TD WIDTH="50%" VALIGN="MIDDLE" HEIGHT=24>
<FONT FACE="Arial" SIZE=2><P>When a user presents authentication credentials to a SQL Server 2000 instance, the user name and password submitted are not encrypted (unless SSL is enabled for the entire session).</FONT></TD>
</TR>
<TR><TD WIDTH="50%" VALIGN="MIDDLE">
<FONT FACE="Arial" SIZE=2><P>Windows 2000 and Windows NT 4.0 support password policies (such as enforcing complex passwords and password expirations).</FONT></TD>
<TD WIDTH="50%" VALIGN="MIDDLE">
<FONT FACE="Arial" SIZE=2><P>SQL Server 2000 supports no password policies (passwords can be of any length or complexity, and they never expire).</FONT></TD>
</TR>
<TR><TD WIDTH="50%" VALIGN="MIDDLE" HEIGHT=51>
<FONT FACE="Arial" SIZE=2><P>Windows 2000 and Windows NT 4.0 supports account lockout policies (such as for multiple attempts using an incorrect password).</FONT></TD>
<TD WIDTH="50%" VALIGN="MIDDLE" HEIGHT=51>
<FONT FACE="Arial" SIZE=2><P>SQL Server 2000 supports no account lockout policy (a user can try an unlimited number of times until a valid name and password allow access).</FONT></TD>
</TR></TABLE></CENTER></P><B>--REF: (SYS ADMIN) Lesson 1: Understanding the Authentication Process pg. 290-294</b></font>












      26. You are the administrator of a SQL Server 2000 computer at a doctor's 
      office. The server contains a database named Medical. The database stores 
      patient and treatment information and is configured as shown in the 
      exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-26.gif','Exhibit','height=368,width=335,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      The office accountant needs access to the total number of treatments that 
      have been performed in the office. The accountant should not have access 
      to any other patient data and should not be able to change any information 
      in the database.

      The accountnat has a SQL Server Authenticated login and database user 
      account named AccountUser.

      You need to make the appropriate information available to the accountant, 
      while protecting the other information in the database. Which batch of 
      Transact-SQL statements should you execute?

      a. CREATE VIEW TotalTreatments AS
      SELECT COUNT(PatientID) AS Total FROM dbo.Patients
      GO
      GRANT ALL ON TotalTreatments TO AccountUser

      b. CREATE VIEW TotalTreatments AS
      SELECT COUNT(*) AS Total FROM dbo.Patients
      GO
      GRANT ALL ON TotalTreatments TO AccountUser

      c. CREATE PROCEDURE TotalTreatments AS
      SELECT COUNT(*) AS Total FROM dbo.Patients
      GO
      GRANT ALL ON TotalTreatments TO AccountUser

      d. CREATE PROCEDURE TotalTreatments AS
      SELECT COUNT(PatientID) AS Total FROM dbo.Patients
      GO
      GRANT ALL ON TotalTreatments TO AccountUser

ANSWER: D

<B><FONT SIZE="3" FACE="Arial" COLOR="black">EXPLANATION:</FONT></B><FONT SIZE="2" FACE="arial" COLOR="black"><BR>
[<B> * </B>] Specifies that all rows should be counted to return the total number of rows in a table. COUNT(*) takes no parameters. COUNT(*) does not require an expression parameter because, by definition, it does not use information about any particular
column. COUNT(*) returns the number of rows in a specified table <FONT COLOR="maroon"><U>without eliminating duplicates</U></FONT>. It counts each row separately, including rows that contain null values. </FONT>
<P><FONT FACE="Wingdings" SIZE="6" COLOR="#FF0000"><B>?</B></FONT><FONT SIZE="2" FACE="arial" COLOR="#008080">The PatientID column in the patiants table contains the primary key constraint.&nbsp; A Primary Key can not have duplicate or null values. The
patiantID column will have the most accurate data for an accountant.&nbsp; Conversely, COUNT(*) would return the same value because of the Primary key constraint on the table. During testing, I would look for a primary key constraint in the exhibit if it
is there, flip a coin --both answers are correct.</FONT></P>
<P><FONT SIZE="2" FACE="arial" COLOR="#008080">Creating A view or Procedure would control data access but since the accountant has database access (no permissions?), creating a procedure would be easier for an accountant to execute.&nbsp;&nbsp; </FONT><FONT SIZE="2" FACE="arial" COLOR="black"><BR><BR>
<B>--REF: (BOL) keyword search &quot;COUNT&quot;, &quot;views&quot;</B></FONT></P>











      27. You are the administrator of a SQL Server 2000 computer. One of the 
      databases on the server contains a table named SalesData. This table 
      stores information about sales orders that is used to create sales reports 
      and to calculate commissions for sales personnel.

      The permissions on the SalesData table are configured as shown in the 
      exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-27.gif','Exhibit','height=94,width=300,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>

      Sales managers monitor the entries made by sales personnel and correct any 
      errors. Because monitoring is time-consuming, the sales department will 
      hire several assistants. The sales managers will make necessary 
      corrections on hard copy, and then the assistants will enter the changes 
      in the table. However, the assistants must not be allowed to delete any 
      data from the table.

      You need to configure permissions on the table to support these 
      requirements. You also want to reduce the amount of time needed to manage 
      these permissions.

      What should you do?

      a. Create a database user account for each assistant.
      Add each database user account to the SalesManagers database role.
      Revoke DELETE permissions for the SalesManagers database role.

      b. Create a single database user account for all assistants.
      Add the database user account to the SalesManagers database role.
      Revoke DELETE permissions for the SalesManagers database role.

      c. Create a database user account for each assistant.
      Create a database role named SalesAssistants. Grant SELECT, UPDATE, and 
      INSERT permissions to the SalesAssistants database role.
      Add each database user account to the SalesAssistants database role.

      d. Create a database user account for each assistant.
      Create a database role named SalesAssistants. Add the role to the 
      SalesManagers database role.
      Add each database user account to the SalesAssistants database role.
      Revoke DELETE permissions for the SalesAssistants database role.

ANSWER: C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Changing permissions on the Salesmanagers database role would effect other managers in that role. (D) would increase the time needed to manage the permissions.<BR><BR><B>--REF: (BOL) keyword search "permissions", "Roles"</b></font>








      28. You are the administrator of a SQL Server 2000 computer. The server 
      belongs to a Microsoft Windows NT domain named DOMAIN1. the server 
      contains a database named SalesData. Julia is a sales representative who 
      uses the database. You create a login named DOMAIN1\Julia and manually 
      configure the permissions necessary for her to perform her job.

      Julia is temporarily reassigned to the marketing department. During her 
      assignment in the marketing department Julia must not be able to access 
      the server. However, you must restore her access when she returns to the 
      sales department.

      You need to configure the appropriate database permissions for Julia. 
      Which Transact-SQL statement should you execute?

      a. REVOKE ALL TO SalesData FROM 'Julia'

      b. EXEC sp_revokedbaccess 'Julia'

      c. EXEC sp_denylogin 'Julia'

      d. EXEC sp_droplogin 'Julia'

ANSWER: C

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>You can revoke a permission that has been granted or denied previously. 
Revoking is similar to denying in that both remove a granted permission at the same level. However, although revoking a permission removes a granted permission, it does not prevent the user, group, or role from inheriting a 
granted permission from a higher level. Therefore, if you revoke permission for a user to view a table, you do not necessarily prevent the user from viewing the table because permission to view the table was granted to a role to which he belongs.<BR><BR><B>sp_revokedbaccess</b> Removes a security account from the current database. When the account is removed, the permissions and aliases that depend on the account are automatically removed as well. They would have to be recreated when Julia returns.<BR><BR><font color=green><B>sp_denylogin</B>Prevents a Microsoft® Windows NT® user or group from connecting to Microsoft SQL Server™. <B>sp_denylogin</b> can be used only with Windows NT accounts in the form Domain\User, for example <B>DOMAIN1\Julia</b>. Use <B>sp_grantlogin</b> to reverse the effects of <B>sp_denylogin</b> and allow the user to connect.</font><BR><BR><B>sp_droplogin</b> Removes a Microsoft® SQL Server™ login, preventing access to SQL Server using that login name. Jula's login was created as a windows NT account. The <B>sp_droplogin</b> is for SQL Server accounts.<BR><BR><B>--REF: (BOL) keyword search "Revoking Permissions", "sp_revokedbaccess",  "sp_denylogin", "sp_droplogin"</b></font>











      29. You are the administrator of a SQL Server 2000 computer named ProdSql1. 
      The server is a member of a Microsoft Windows NT domain named CORP. 
      ProdSql1 contains a database named Finance.

      Your company purchases a client/server application that will use a 
      database named Marketing. This database will be stored on ProdSql1.

      Maria, Bruno, and Stefan will use the new application. These users belong 
      to a domain user group named Marketers. In the future, several additional 
      users who will also use the new application will be added to the Marketers 
      group.

      The logins on ProdSql1 are configured as shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-29.gif','Exhibit','height=166,width=300,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You need to allow Maria, Bruno, and Stefan access to the Marketing 
      database as quickly as possible. Which batch of Transact-SQL statements 
      should you execute?

      a. USE Marketing
      GO
      EXEC sp_grantdbaccess 'CORP\Maria'
      EXEC sp_grantdbaccess 'CORP\Bruno'
      EXEC sp_grantdbaccess 'CORP\Stefan'

      b. EXEC sp_grantlogin 'CORP\Marketers'
      GO
      USE Marketing
      EXEC sp_grantdbaccess 'CORP\Marketers'

      c. USE Marketing
      GO
      EXEC sp_grantdbaccess 'Marketers'

      d. EXEC sp_addlogin 'CORP\Marketers'
      GO
      USE Marketing
      EXEC sp_grantdbaccess 'CORP\Marketers'

ANSWER: B

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><BR><BR><B>sp_addlogin</B> Creates a new Microsoft® SQL Server™ login that allows a user to connect to an instance of SQL Server using SQL Server Authentication.<BR><BR><font color=blue>EXEC</font> <font color=maroon>sp_addlogin</font> <font color=red>'Marketers'</font><BR><BR><B>sp_grantlogin</b>Allows a Microsoft® Windows NT® user or group account to connect to Microsoft SQL Server™ using Windows Authentication.<BR><BR><font color=blue>EXEC</font> <font color=maroon>sp_grantlogin</font> <font color=red>'CORP\Marketers'</font><BR><BR>Or<BR><BR><font color=blue>EXEC</font> <font color=maroon>sp_grantlogin</font> [Corp\Marketers]<BR><BR><B>--REF: (BOL) keyword search "sp_grantlogin", "sp_addlogin"</b></font>









      30. You are the administrator of a SQL Server 2000 computer. Your company has 
      client computers that are running Microsoft Windows 2000 Professional and 
      UNIX. All client computers require access to the server.

      Users with domain accounts will access the server by means of the company 
      LAN, and external users will access the server by means of the Internet.

      You need to configure the server so that all authorized users can connect 
      to it. What should you do? (Each correct answer presents part of the 
      solution. Choose all that apply.)

      a. Configure Windows Authentication.

      b. Configure Mixed Mode Authentication.

      c. Create a login for the Domain Users group.

      d. Create a login for the Guest domain user account.

      e. Create a login for each UNIX user, and set a password for each login.

      f. Create a login for each external user, and set a blank password for 
      each login.

      g. Create a login named Guest, and set a blank password for the login.

ANSWER: B, C, E 

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Microsoft® SQL Server™ can operate in one of two security (authentication) modes:<BR><BR><u>Windows Authentication Mode (Windows Authentication)</u><BR><BR>Windows Authentication mode allows a user to connect through a Microsoft Windows NT® 4.0 or Windows® 2000 user account.<BR><BR><u>Mixed Mode (Windows Authentication and SQL Server Authentication)</u><BR><BR>Mixed Mode allows users to connect to an instance of SQL Server using either Windows Authentication or SQL Server Authentication. Users who connect through a Windows NT 4.0 or Windows 2000 user account can make use of trusted connections in either Windows Authentication Mode or Mixed Mode.<BR><BR>UNIX users would need a login to the SQL server as they can not be a member of the NT domain.<BR><BR> <br><button onClick="window.open('./70-228/images/pic228-30.gif','Exhibit','height=389, width=338, status=no,toolbar=no, menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">SQL Server Security Tree</button><BR><BR><B>--REF: (BOL) keyword search "mixed Mode"</b></font> 










      31. You are the administrator of a SQL Server 2000 computer. One of the 
      databases on the server contains a table named CustomerInfo. This table is 
      used to store information about your company's customers.

      You want some users to be allowed to modify only the table's Address 
      column. Other users should be allowed to modify only the table's 
      CreditCard column. Neither group of users has permission on the 
      CustomerInfo table.

      You need to make sure that only authorized users make changes to the 
      Address and CreditCard columns. What should you do?

      a. Create a stored procedure and require users to enter information by 
      means of the stored procedure.

      b. Create a user-defined function and require users to enter information 
      by means of the function.

      c. Create a rule and apply it to the Address and CreditCard columns.

      d. Create a constraint and apply it to the Address and CreditCard columns.

ANSWER: A
<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Stored procedures also provide easy database access for users. Users can access the database without having to know the architectural details of the tables and without directly accessing table data—they simply execute the procedures that perform the required tasks. In this way, stored procedures help to ensure that the business rules are protected.

Users can be granted permission to execute a stored procedure even if they do not have permission to execute the procedure's statements directly.<BR><BR><B>--REF: (SAC) ch 21, What is a Stored Procedure, pg. 513<BR>--REF: (BOL) keyword search "SQL Stored Proceedures"</B></font>












      32. You are the administrator of a SQL Server 2000 computer named DataSvr. The 
      server is a member of a Microsoft Windows NT domain. DataSvr is currently 
      cofigured for Windows Authentication and contains logins for several 
      domain user groups. The server is configured to use Named Pipes 
      Net-Library.

      Your company purchases five UNIX client computers. You want to allow 
      employees who will be using these computers to access DataSvr.

      What should you do?

      a. Configure DataSvr for Mixed Mode authentication.
      Add a login for a domain user group that includes the five UNIX computers.

      b. Configure DataSvr for Mixed Mode authentication.
      Add a login for each of the five UNIX users.

      c. Install the TCP/IP Net-Library.
      Add the five UNIX users to a domain user group that has access to DataSvr.

      d. Install the TCP/IP Net-Library.
      Add a login for each of the five UNIX users.

ANSWER: B 

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>The server is currently set to Windows Authentication only. Unix can not be included in a domain user group.<BR><BR><B>--REF (BOL) keyword search, "mixed Mode"</b></font>













      33. You are the administrator of a SQL Server 2000 computer named CorpSQL. The 
      server is a member of a Microsoft Windows NT domain named CORPORATE.

      Franz maintains a local user account on CorpSQL and is a member of the 
      local Power Users group. He requests access to the SQL Server databases 
      that are stored on CorpSQL.

      You need to allow Franz to access CorpSQL. Which Transact-SQL statement 
      should you execute?

      a. EXEC sp_grantlogin Franz

      b. EXEC sp_grantlogin CORPORATE\Franz

      c. EXEC sp_grantlogin Power Users\Franz

      d. EXEC sp_grantlogin CorpSQL\Franz

ANSWER: D

<B><FONT SIZE="3" FACE="Arial" COLOR="black">EXPLANATION:</FONT></B><FONT SIZE="2" FACE="arial" COLOR="black"><BR>
<BR>
<B>sp_grantlogin</B>Allows a Microsoft® Windows NT® user or group account to connect to Microsoft SQL Server™ using Windows Authentication.<BR>
<BR>
Franz is a member of the CORPSQL Domain. (A Domain of one computer). Because Frank has a local user account tells us that CorpSQL is not A domain Controller. When Frank logs on to CorpSQL, he uses a CorpSQL ID and may not have access to the CORPORATE
domain.</FONT>
<P><FONT SIZE="2" FACE="arial" COLOR="black">The Windows NT user or group must be qualified with a Windows NT domain name in the form <B>Domain \ User <B>or</B> group</B>.<BR>
<BR>
With Windows Authentication, the operating system is responsible for authenticating the user. SQL Server then uses this operating system authentication to determine which user permissions to apply. To access SQL Server, you always have to first log on to
a Windows NT/2000 account.<BR>
<BR>
When a user logs on to Windows NT/2000, the user's account identity is validated. SQL Server verifies that the user was validated by Windows NT/2000 and allows access based on that authentication. SQL Server integrates its login security process with the
Windows login security process to provide these services. Network security attributes are validated through a sophisticated encryption process provided by Windows NT/2000. Because the SQL Server and Windows login security processes are integrated when
this mode is used, once you are authenticated by the operating system, no further authentication methods are required for you to access SQL Server. The only password you need to supply in order to log on to SQL Server is your Windows NT/2000 password.<B>--REF:
(BOL) keyword search &quot;sp_grantlogin&quot;, &quot;Windows Authentication&quot;</B></FONT></P>














      34. You are the administrator of a SQL Server 2000 computer. The server is a 
      member of a Microsoft Windows NT domain named CORPHQ. Several users need 
      access to the server. These users are members of a domain user group named 
      Receptionists.

      The Receptionists group also contains users who should not have access to 
      the server. These users are also members of a domain user group named 
      TempEmployees.

      You need to allow only the appropriate users to access the server. Which 
      Transact-SQL statement should you execute?

      a. EXEC sp_addlogin 'CORPHQ\Receptionists'
      EXEC sp_droplogin 'CORPHQ\TempEmployees'

      b. EXEC sp_addlogin 'CORPHQ\TempEmployees'
      EXEC sp_addlogin 'CORPHQ\Receptionists'
      REVOKE ALL ON Master FROM CORPHQ\TempEmployees

      c. EXEC sp_addlogin 'CORPHQ\Receptionists'
      EXEC sp_denylogin 'CORPHQ\TempEmployees'

      d. EXEC sp_addlogin 'CORPHQ\TempEmployees'
      EXEC sp_addlogin 'CORPHQ\Receptionists'
      GRANT ALL ON Master TO CORPHQ\Receptionists

ANSWER: C 

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>A user account can be a member of any number of groups and can hold permissions appropriate to each gruop. For example, a user can be a member of Receptionists group and the TempEmployees group, with each group granting different permissions. The permission granted to a member of more than group are the cumulative permissions of the groups. However, a denied permission in one group has precedence over the same permission granted in another group.<BR><BR><B>--REF: (BOL) keyword search, "Denying Permissions"</b></font>















      35. You are the administrator of a SQL Server 2000 computer. The server is 
      used to store confidential information about company employees.

      You suspect that at least one user is accessing the employee information 
      database without company approval. You believe the access is occurring 
      after business hours.

      You need to discover whether users are accessing the database without 
      approval and which users are accessing the data. You also want to minimize 
      any additional overhead on the server during business hours.

      What should you do?

a. Use SQL Profiler to capture security events and audit events.

b. On the Security tab of the Server Properties dialog box, set the Audit level option to All.

c. Configure the server to use Windows Authentication. Make sure the Windows security log does not overwrite events.

d. Set the c2 audit mode option to 1. Restart the MSSQLServer service

ANSWER: A 

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>Setting the audit level in the Security Tab only audits logins, not database/data access. The C2 audit mode would work but cause additional overhead, also one assumes running SQL Profiler is only being done out of hours and/or Is using filters to minimize server impact.<BR><BR><B>SQL Profiler</B><BR>Use SQL Server Profiler to monitor activity within SQL Server. The SQL Server log and the event log contain valuable information about SQL Server, Windows 2000, and security. You should monitor these logs closely for any signs of trouble.<BR><BR>As mentioned, you can audit your system using SQL Server Profiler. Profiles can be created that log events such as failed login attempts. In addition, you can profile events such as data definition language (DDL) statements and INSERT, UPDATE, and DELETE operations. By using SQL Server Profiler, you can monitor specific events, as well as log times, user names, and activities.<BR><BR><B>c2 audit mode Option</b>In Microsoft® SQL Server™ 2000, use the c2 audit mode option to review both successful and unsuccessful attempts to access statements and objects. With this information, you can document system activity and look for security policy violations.<BR><BR><B>--REF: (BOL) keyword search, "C2", "Choosing a monitoring tool"<BR>--REF: (SAC) ch3, System Auditing, pg. 38</b><font>











      36. You are the administrator of a SQL Server 2000 computer. The server is 
      used to store information for your company's finance department.

      The permissions on the FinanceInfo database are configured as shown in the 
      exhibit.
<P ALIGN="center"><img src="./70-228/images/pic228-36.gif"></P>
      Bruno is a member of the Accountants database role. He needs to add a new 
      view to the database.

      You need to configure the database to allow Bruno to add a new view. Which 
      two actions should you take? (Each correct answer represents part of the 
      solution. Choose two.)

      a. Add Bruno to the Managers database role.

      b. Add Bruno to the Administrators database role.

      c. Revoke the CREATE TABLE permissions for Bruno.

      d. Revoke the CREATE PROCEDURE permissions for Bruno.

      e. Revoke the CREATE VIEW permissions for Bruno.

ANSWER:A,E

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>SQL Server Enterprise Manager provides a simple graphical interface for viewing existing statement permissions and granting, denying, and revoking statement permissions. To view statement permissions within a database, right-click the database and then click Properties. On the Permissions tab in the Properties dialog box, you can view, grant, revoke, or deny permissions. See Exhibit. 

Notice that each permitted user and user-defined database role is displayed along with the specific statement permissions granted that user or role, if any. A green check means granted, a red X means denied, and a cleared check box means revoked or neutral. Remember that permissions are generally cumulative, but that a DENY permission takes precedence. For example, in the Exhibit the role public has been denied permission to create a table. Therefore, the login Lilly will not be able to create a table although she has been specifically granted that permission. Finally, the statement permissions displayed are only those statement permissions directly granted. Statement permissions inherited by a user account by virtue of membership in a server role or a fixed database role are not displayed here.<BR><BR><B>--REF: (sys Admen) ch11, Using SQL Server Enterprise Manager to Grant, Deny, or Revoke Statement Permission, pg. 335</b></font>











      37. You are the administrator of a SQL Server 2000 computer that contains 
      multiple databases. One of these databases is named CorpSales.

      Your company hires a new employee named Helene. Part of Helene's job will 
      be to create new tables in the CorpSales database. However she should not 
      have access to the other databases on the server.

      You create a SQL Server login named Helene. Helene reports that she can 
      log on to the server but is unable to access the CorpSales database.

      You need to allow Helene access to the CorpSales database. What should you 
      do?

      a. Create a new database user in the CorpSales database.
      Map the database user to Helene's login.
      Grant CREATE TABLE permissions to the database user.

      b. Create a new database role in the CorpSales database.
      Add Helene's login as a member of the role.
      Grant CREATE TABLE permissions to the database role.

      c. Change the server's authentication mode to Windows Authentication.

      d. Add Helene's login to the processadmin server role on the server.

ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><BR><BR>(B) Is incorect because you add database users to roles <i>NOT</i> server logins.<BR><BR>In addition to the SQL Server login, each database has a set of user pseudo-accounts assigned to it. These pseudoaccounts provide aliases to SQL Server login accounts. For example, in the Northwind database, you might have a user named manager that is associated with the SQL Server guest login, and the pubs database might have a user named manager that is associated with the SQL Server sa login account. By default, a SQL Server login account does not have a database user ID associated with it; thus, it has no permissions.

To obtain access to a Microsoft® SQL Server™ database, a Microsoft Windows NT® 4.0 and Windows® 2000 user or group must have a corresponding user account in each database they need to access. Additionally, permissions must be applied to this user account.<BR><BR><B>--REF: (BOL) keyword search, "Granting a Windows User or Group Access to a Database"<BR>--REF: (SAC) ch34, Login vs. Users, pg. 931














      38. You are the administrator of a new multiprocessor SQL Server 2000 
      computer. You are migrating data from other database management systems to 
      this server. You need to load data from two data files into a new table on 
      the server. The table is empty and has no indexes.

      You want to complete the data load as quickly as possible. What should you 
      do? (Each correct answer represents part of the solution. Choose all that 
      apply.)

a. Apply a bulk update lock to the table.

b. Use seperate client connections to load the files into the table simultaneously.

c. Create a clustered index on the table.

d. Specify the Full Recovery model for the database.

e. Specify the Bulk-Logged Recovery model for the database.

ANSWER: A, B, E
<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black>A Bulk Update (BU) Lock is used when bulk-copying data into a table and the TABLOCK hint is specified. In order to enable nonlogged bulk operations on a database, you must set the database to run in BULK_LOGGED recovery mode. The other recovery options are FULL and SIMPLE. Choosing the Full Recovery model ensures the best recoverability, it is not the fastest or most efficient way to perform these operations. If you want to speed these operations, you can choose the Bulk-Logged Recovery model, where these operations are minimally logged. This option still provides a good level of recoverability.
<FONT FACE="Microsoft Sans Serif" COLOR="#008080"><H5>Loading Data in Parallel from Multiple Clients</H5>
</FONT><FONT FACE="Arial" SIZE=2><P>If SQL Server is running on a computer with more than one processor and the data to be copied into the table can be partitioned into separate data files, then it is recommended that data be loaded into the same table from multiple clients in parallel, thereby improving the performance of the bulk-copy operation. For example, when copy loading from eight clients into one table, each client must have one input data file containing a portion of the partitioned data. To achieve maximum performance, the batch size specified for each client should be the same as the size of the client data file. When copying data into a table from multiple clients, consider that: </P><UL>
<LI>All indexes on the table must be dropped first, and then re-created on the table. Consider re-creating the secondary indexes in parallel by creating each secondary index from a separate client at the same time.</LI>
<LI>Using ordered data and the <B>ORDER</B> hint will not affect performance because the clustered index is not present during the load.</LI>
<LI>The data must be partitioned into multiple input files, one file per client. As with bulk-copy operations from a single client, specify: </LI>
<LI>The <B>TABLOCK</B> hint. This causes a table-level lock to be taken for the duration of the bulk-copy operation.</LI>
<LI>A large, batch size, using the <B>ROWS_PER_BATCH</B> hint. A single batch representing the size of the entire client file is recommended for each client.</LI>
<LI>Set the database option <B>select into/bulkcopy</B> to true to enable nonlogged operations. </LI></UL>
</FONT><B>--REF: (BOL) keyword search "Optimizing Bulk copy Performance"<BR>--REF: (SAC) ch32, SQL Server Logging, pg. 881, 882</b></font>















      39. You are the administrator of a SQL Server 2000 computer in your company's 
      personnel department. Employee data is stored in a SQL Server 2000 
      database. A portion of the database schema is shown in the exhibit.
<br><BR><button onClick="window.open('./70-228/images/PIC228-39.jpg','Exhibit','height=331,width=462,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>
      You want to create a text file that lists these data columns in the 
      following format: title, firstName, lastName, workPhone, positionName, 
      departmentName.

      You want to create the text file as quickly as possible. You do not expect 
      to re-create this file, and you want to avoid creating new database 
      objects if possible.

      What should you do?

      a. Use the bcp utility to export the data from each table to a seperate 
      text file.
      Use format files to select the appropriate columns.
      Merge the data from each text file into a single text file.

      b. Create a view that joins data from all three tables.
      Include only the columns you want to appear in the text file.
      Use the bcp utility to export the data from the view.

      c. Create a SELECT query that joins the data from the appropriate columns 
      in the three tables.
      Add an INTO clause to the query to create a local temporary table.
      Use the bcp utility to export the data from the local temporary table to a 
      text file.

      d. Create a SELECT query that joins the data from the appropriate columns 
      in the three tables.
      Add an INTO clause to the query to create a global temporary table.
      Use the bcp utility to export the data from the global temporary table to 
      a text file.

ANSWER: D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face= arial color=black><BR>(A) and (B) Are not the quickest ways and create new database objects. Using a Local table would drop at the end of the Select statement and are hidden from other connections. To access data across multiple steps, avoid using a (local)temp table during transformations. Instead, use a global temp table or create a permanent table in tempdb. 
<FONT FACE="Microsoft Sans Serif" COLOR="#008080"><H3>Temporary Tables</H3>
</FONT><FONT FACE="Arial" SIZE=2><P>SQL Server supports temporary tables. These tables have names that start with a number sign (#). If a temporary table is not dropped when a user disconnects, SQL Server automatically drops the temporary table. Temporary tables are not stored in the current database; they are stored in the <B>tempdb </B>system database.</P>
<P>There are two types of temporary tables: </P>
<UL>
<B><LI>Local temporary tables:</B> The names of these tables begin with one number sign (#). These tables are visible only to the connection that created them. </LI>
<B><LI>Global temporary tables: </B>The names of these tables begin with two number signs (##). These tables are visible to all connections. If the tables are not dropped explicitly before the connection that created them disconnects, they are dropped as soon as all other tasks stop referencing them. No new tasks can reference a global temporary table after the connection that created it disconnects. The association between a task and a table is always dropped when the current statement completes executing; therefore, global temporary tables are usually dropped soon after the connection that created them disconnects.</LI></UL>
</FONT><FONT FACE="Microsoft Sans Serif" COLOR="#008080"><H3>The INTO Clause</H3>
</FONT><FONT FACE="Arial" SIZE=2><P>Using the SELECT &lt;select list&gt; INTO &lt;new_tablename&gt; syntax enables you to retrieve data from a table or tables and place the resulting rows in a new table. The new table is created automatically when you run the SELECT...INTO statement and is defined according to the columns in the select list. Each column in the new table has the same data type as the original column and carries the column name specified in the select list. The user must have CREATE TABLE permission in the destination database to execute SELECT...INTO.</P>
<P>You can use SELECT...INTO to select rows into a temporary table or a permanent table. For a local temporary table (which is visible to only the current connection or user), you must include the pound symbol (#) before the table name. For a global temporary table (which is visible to any user), you must include two pound symbols (##) before the table name. A temporary table is automatically deleted after all users who are using the table have disconnected from SQL Server.</P></FONT><B>--REF: (BOL) bcp utility, Data Types and Table Structures<BR>--REF: (SAC) ch14, The Select Statement, pg. 293-304</b></font>      












      40. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database that stores financial data. You want to use Data 
      Transformation Services (DTS) packages to import numeric data from other 
      SQL Server computers. The precision and scale values of this data are not 
      defined consistently on the other servers.

      You want to prevent any loss of data during the import operations.

      What should you do?

      a. Use the ALTER COLUMN clause of the ALTER TABLE statement to change data 
      types in the source tables. Change the data types so that they will use 
      the lowest precision and scale values of the data that will be transferred.

      b. Use the ALTER COLUMN clause of the ALTER TABLE statement to change the 
      data types in the destination tables. Change the data types to reflect the 
      highest precision and scale values involved in the data transfer.

      c. Set a flag on each DTS transformation to require an exact match between 
      source and destination columns.

      d. Set the maximum error count for each DTS transformation task equal to 
      the number of rows of data you are importing.
      Use an exception file to store any rows of data that generate errors.

      e. Write a Microsoft ActiveX script for each DTS transformation.
      Use the script to recast data types to the destination's precision and 
      scale values.

ANSWER: B

<B><FONT FACE="Arial"><P>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE=2>ActiveX is a performance hog that can take upto four times as long to complete. ActiveX should only be used to add functionality to DTS, not replace existing functions. changing the length, precision, or scale of a column is allowed if the data type is not changed. Flags raise error counts and do not prevent the loss of data.</FONT><B><FONT FACE="Microsoft Sans Serif" SIZE=4 COLOR="#008080"><BR>
<BR>
Column Mappings and Transformations </FONT><FONT FACE="Arial" SIZE=2><BR>
Column Mappings tab: </B>Use this tab to specify how to treat the destination table and to specify column attributes on any newly created table.</P>
<B><P>Size:</B> Specify the length of the <B>Destination</B> column, in units corresponding to the data type. The value is only applicable for the <B>char</B>, <B>varchar</B>, <B>nchar</B>, <B>nvarchar</B>, <B>binary</B>, and <B>varbinary</B> data types. Specifying a size smaller than the length of the source can result in data truncation.<BR>
<BR>
<B>Precision:</B> Enter the maximum number of decimal digits that can be stored to the left and to the right of the decimal point. This option applies only to <B>decimal</B> and <B>numeric</B> data types.<BR>
<BR>
<B>Scale:</B> Enter the maximum number of decimal digits that are stored to the right of the decimal point. The number must be less than or equal to the number in the <B>Precision</B> column. This option applies only to <B>decimal</B> and <B>numeric</B> data types. </FONT><B><FONT FACE="Microsoft Sans Serif" SIZE=4 COLOR="#008080"><BR>
<BR>
Transform Data Task Properties (Options Tab)<BR>
</B></FONT><FONT FACE="Arial" SIZE=2>Use this tab to send rows to an exception file, determine the format of that file, and set the error count at which package execution should cease. The exception files are stored on a local or mapped drive.<BR>
<BR>
</FONT><B><FONT FACE="Microsoft Sans Serif" SIZE=4 COLOR="#008080">DTSTransformFlags </B></FONT><FONT FACE="Arial" SIZE=2><BR>
The <B>DTSTransformFlags</B> constants specify the flags controlling transformation. They are used to set the <B>TransformFlags</B> property of the <B>Transformation</B> object. These values are used during schema validation, which occurs before any rows are transformed. <B><BR>
<BR>
--REF: (BOL) keyword search, "Column mappings and Transformations", "Transform Data Task Properties, "DTS Transform Flags", "ALTER TABLE"</B> </P></FONT>













      41. You are the administrator of a SQL Server 2000 computer. You are creating 
      a database named RetailImport to use as an intermediate data store for a 
      data warehouse. Each night you must import daily data into the database 
      from SQL Server 2000 computers in 120 retail locations. After the data is 
      moved into the data warehouse, the tables are truncated. The database 
      schema is shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-41.gif','Exhibit','height=324,width=522,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You want to configure the data import process so that you minimize the 
      time needed to import the sales data and administer the database. What 
      should you do?

      a. Use the Simple Recovery model and the FOR LOAD option to create the 
      database.
      Create a Data Transformation Services (DTS) package that uses the BULK 
      INSERT statement to copy the sales data.

      b. Index the foreign key fields in the child tables.

      c. Create a Data Transformation Services (DTS) package that uses a Data 
      Driven Query task to copy the sales data.

      d. Collect the sales data by using a distributed transaction that inserts 
      the data from all 120 retail locations into the RetailImport database as a 
      single transaction.

      e. On the servers in the retail locations, create stored procedures that 
      submit the updates to the RetailImport database each night as SQL-XML 
      updategrams.

ANSWER:A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>The Database you are creating is a staging table for a data warehouse. The simple recovery model does not log transactions, reducing the size of the database. This is acceptable because the data can be recovered from the original sources.<BR>The LOAD option sets the database option "dbo use only  TRUE" (The default is False). This prevents users from accessing the database. The other options do not meet your goal.<BR><BR><B>--REF: (BOL) keyword search, "Staging Tables", "Data Warehouse", "OLTP",  "Database Options", "BULK INSERT", "LOAD", "Recovery Model"</b></font>












      42. You are the database administrator for a financial services company. 
      Employees enter data 24 hours a day into a SQL Server 2000 database. These 
      employees report slower response times when new account information is 
      gathered from branch offices and added to the database. You currently use 
      the following BULK INSERT statement to add the account information.

      <FONT FACE="Arial" SIZE=2 COLOR="#0000ff"><P>BULK INSERT</FONT><FONT FACE="Arial" SIZE=2> finance.dbo.customers<BR>
</FONT><FONT FACE="Arial" SIZE=2 COLOR="#0000ff">FROM</FONT><FONT FACE="Arial" SIZE=2> </FONT><FONT FACE="Arial" SIZE=2 COLOR="#ff0000">'d:\bulk\accts143_10142000.txt'</FONT><FONT FACE="Arial" SIZE=2 COLOR="#0000ff"><BR>
WITH</FONT><FONT FACE="Arial" SIZE=2> DATAFILETYPE = </FONT><FONT FACE="Arial" SIZE=2 COLOR="#ff0000">'char'</FONT><FONT FACE="Arial" SIZE=2>, FIELDTERMINATOR = </FONT><FONT FACE="Arial" SIZE=2 COLOR="#ff0000">' '</FONT><FONT FACE="Arial" SIZE=2>, ROWTERMINATOR = </FONT><FONT FACE="Arial" SIZE=2 COLOR="#ff0000">' '</FONT><FONT FACE="Arial" SIZE=2>, </FONT><FONT FACE="Arial" SIZE=2 COLOR="#0000ff"><BR>
TABLOCK</P></FONT>

      You want to ensure that response time does not slow when new account 
      information is added to the database. What should you do?

      a. Drop the indexes on the Customers table before the data load, and then 
      re-create the indexes after the data load is complete.

      b. Remove the TABLOCK option from the BULK INSERT statement.

      c. Add the BATCHSIZE option to the BULK INSERT statement, and then set the 
      option equal to 10 percent of the number of rows to be loaded.

      d. Add the ROWS_PER_BATCH option to the BULK INSERT statement, and then 
      set the option equal to 10 percent of the number of rows to be loaded.

ANSWER: B


<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>A <B>TABLOCK</b> Specifies that a table-level lock is acquired for the duration of the bulk copy operation. When using a table lock instead of the finer-grained row- or page-level locks. SQL Server holds the lock until the end of the operation. If TABLOCK is not specified then locks are held on individual rows.<BR><BR>
<B><font color="teal">Managing Bulk Copy Batch Sizes</b></font><BR><BR>
The primary purpose of a batch in bulk copy operations is to define the scope of a transaction. If a batch size is not set, then bulk copy functions consider an entire bulk copy to be one transaction. If a batch size is set, then each batch constitutes a transaction that is committed when the batch finishes.<BR><BR><B>--REF: (BOL) keyword search "Managing Bulk Copy Batch Sizes", "Understanding Locking in SQL Server", "BULK COPY"</b></font>














      43. You are the administrator of a SQL Server 2000 computer. You create a Data 
      Transformation Services (DTS) package. The package is stored as a local 
      package on the server. The package exports data from an online transaction 
      processing (OLTP) database system to an online analytical processing 
      (OLAP) database system that is located on a second SQL Server 2000 
      computer.

      You want the package to execute automatically each evening at 8:00 P.M. 
      What should you do?

      a. Use SQL Server Enterprise Manager to create a new job
      Create a CmdExec job step that runs the dtsrun utility
      Schedule the job to run each night at 8:00 P.M.

      b. Use SQL Server Enterprise Manager to create a new job
      Create a Transact-SQL job step to query datafrom the OLTP database
      Create a second Transact-SQL job step to launch the DTS package
      Schedule the job to run each night at 8:00 P.M.

      c. Create a batch file that runs the dtsrun utility
      Use the Microsoft Windows Task Scheduler to run the job each night at 8:00 
      P.M.
      Configure the Windows Task Scheduler to use the local system account

      d. Move the DTS package to the repository
      Configure the SQLServerAgent service on the OLAP database server to update 
      the package each night at 8:00 P.M.

ANSWER: A
      
<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black><FONT FACE="Microsoft Sans Serif" COLOR="#008080"><H4>How to schedule a DTS package using the SQLServerAgent service (Enterprise Manager)</H4>
</FONT><B><P><FONT FACE="Arial" SIZE=2>To schedule a DTS package using the SQLServerAgent service</B> </P>
<OL><LI>Expand a server, and then expand a server group. </LI>
<LI>Expand <B>Management</B>, and then expand <B>SQL Server Agent</B>.</LI>
<LI>Right-click <B>Jobs</B>, and then click <B>New Job</B>.</LI>
<LI>Complete the information on the <B>General</B> tab, and then click the <B>Steps</B> tab.</LI>
<LI>Click <B>New</B>, and then complete the information in the <B>New Job Step</B> dialog box: </LI></OL>
<UL>
<UL>
<LI>For <B>Type</B>, click <B>Operating System Command (CmdExec)</B> from the list. </LI>
<LI>For <B>Command</B>, enter the <B>dtsrun</B> command for the package. </LI>
<LI>Click the <B>Advanced</B> tab for further job customization options</FONT>. </LI></UL>
</UL>
<B><BR>
--REF: (BOL) keyword search, " How to schedule a DTS package using the SQLServerAgent service (Enterprise Manager)</B></FONT>











      44. You are a database administrator in the Los Angeles branch office of a 
      speciality foods supplier. A mainframe database at the headquaters 
      contains all company data. Each branch office contains a SQL Server 2000 
      computer that imports regional data from the mainframe database.

The server in Los Angeles contains a Data Transformation Services (DTS) package that uses OLE DB to connect to the company's mainframe database. The DTS package extracts and transforms data about buyers and products for that region. The DTS package then writes the data to the SQL Server database in Los Angeles.

      You need to configure a SQL Server computer for the new branch office in 
      Sydney. You want to copy the Los Angeles package and modify it so that it 
      writes data to the SQL Server database in Sydney.

      You use the DTS Designer to modify the DTS package so that it imports 
      regional data from the mainframe database to the server in Sydney. The 
      modified DTS package runs successfully on the server in Los Angeles. You 
      save this DTS package to the server in Sydney, but the server in Sydney 
      cannot connect to the mainframe database.

      You want to enable the server in Sydney to connect to the mainframe 
      database. What should you do?

      a. Change the connection properties in the DTS package so that the package 
      uses new login credentials to connect to the mainframe database.

      b. Modify the workflow in the DTS package so that the server in Syndey is 
      included.

      c. On the server in Sydney, install an OLE DB provider for the mainframe 
      database.

      d. On the server in Sydney, delete and then re-create the DTS package.

ANSWER: C
      
<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>Data Transformation Services (DTS) uses the ODBC drivers and OLE DB providers supplied by Microsoft® SQL Server™ 2000 to perform distributed operations against heterogeneous data sources. To successfully execute Data Transformation Services (DTS) tasks that copy and transform data, a DTS package must establish valid connections to its source and destination data and to any additional data sources.<BR><BR>
Because of its OLE DB architecture, DTS allows connections to data stored in a wide variety of OLE DB-compliant formats. In addition, DTS packages usually can connect to data in custom or nonstandard formats <U>if OLE DB providers are available for those data sources</U> and if you use Microsoft® Data Link files to configure those connections.<BR><BR>
<B><font color= "teal">DTS allows the following varieties of connections:</b></font><BR><BR>
<B>A data source connection.</B><BR>
These are connections to: standard databases such as Microsoft SQL Server™ 2000, Microsoft Access 2000, Oracle, dBase, Paradox; OLE DB connections to ODBC data sources; Microsoft Excel 2000 spreadsheet data; HTML sources; and other OLE DB providers.<BR><BR>
<B>A file connection.</b><BR> 
DTS provides additional support for text files. When specifying a text file connection, you specify the format of the file. For example:<BR><BR>
Whether a text file is in delimited or fixed field format.<BR><BR>
Whether the text file is in a Unicode or an ANSI format.<BR><BR>
The row delimiter and column delimiter if the text file is in fixed field format.<BR><BR>
The text qualifier.<BR><BR>
Whether the first row contains column names.<BR><BR> 
<B>A data link connection.</b><BR> 
These are connections in which an intermediate file outside of SQL Server stores the connection string.<BR><BR>
<B><font color="teal">Configuring a Connection</b></font><BR><BR>
When creating a package in the DTS Import/Export Wizard, in DTS Designer, or programmatically, you configure connections by selecting a connection type from a list of available OLE DB providers. The properties you configure for each connection vary depending on the individual provider for the data source.<BR><BR><B>--REF: (BOL) keyword search, "DTS Driver Support for Heterogeneous Data Types",  "DTS Connections"</b></font>












      45. You are the administrator of a SQL Server 2000 computer. The server 
      contains your company's order processing database. Two-hundred operators 
      take orders by telephone 24 hours a day. Three-hundred data entry 
      personnel enter data from orders received by mail.

      To ensure that order data will not be lost, your company's disaster 
      recovery policy requires that backups be written to tape. Copies of these 
      tapes must be stored at an off-site company location. Orders must be 
      entered into the database before they can be filled. If the server fails, 
      you must be able to recover the order data as quickly as possible.

      You need to create a backup strategy that meets the company requirements 
      and minimizes server workload. Which two actions should you take? (Each 
      correct answer represents part of the solution. Choose two.)

      a. Perform a combination of full database and filegroup backups.

      b. Perform a combination of full database and file backups.

      c. Perform a combination of full database, differential, and transaction 
      log backups.

      d. Back up the data to a local tape drive.

      e. Back up the data to a network share, and then use enterprise backup 
      software to write the disk backups to tape.

ANSWER: C, E

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>To improve backup performance, you can perform the backup as a disk backup and then copy the disk backup files to tape. This method improves performance because a disk is faster than tape, and it allows you to keep the last few backups available on disk. This technique will improve restore performance for only the backup files left on disk.<BR>Differential backups will improve the performance of each backup, but if you use them, a restoration of the entire database will take much longer. If backup times are unacceptable, this method might provide the best solution for your system. If you need to restore data only rarely, the risk might be acceptable.<BR>
Store backups off-site. If you store your backups off-site, the backups might survive a disaster such as a fire or flood. The backup data is much more important than the computer system itself.<BR><BR>The Full Recovery model uses database backups and transaction log backups to provide complete protection against media failure. If one or more data files is damaged, media recovery can restore all committed transactions. In-process transactions are rolled back.<BR><BR><B>--REF: (SAC) ch32, Enhancing Backup Performance, pg.907<BR>--REF: (BOL) keyword search, "Full Recovery"</b></font>












      46. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named CustomerManagement that tracks customer requests 
      for product information.

      The CustomerManagement database has two filegroups. The PRIMARY filegroup 
      stores current transactional data, and the SECONDARY filegroup stores 
      historical data.

      Your backup strategy includes full database and transactional log backups. 
      A portion of the header information for the current week's backups is 
      shown in the following table.


      <p><img border="0" src='./70-228/Images/Pic228-46.gif'></p>

      On June 27, 2000, at 4.18 PM, an application developer accidentally 
      deletes the current customer requests and immediately notifies you of the 
      problem. You want to recover as much data as you can as quickly as 
      possible to minimize server downtime.

      What should you do?

      a. Back up the transaction log.
      Restore the PRIMARY filegroup to a new location.
      Restore subsequent transaction logs in sequence.
      Use the STOPAT option to restore the final transaction log backup.
      Import the deleted data from the new location.

      b. Back up the transaction log.
      Restore the PRIMARY filegroup to the existing database.
      Restore subsequent transaction logs in sequence.
      Use the STOPAT option to restore the final transaction log backup.

      c. Back up the transaction log.
      Restore the entire database to a new location.
      Restore subsequent transaction logs in sequence.
      Use the STOPAT option to restore the final transaction log backup.
      Import the deleted data from the new location.

      d. Restore the PRIMARY filegroup to the existing database.
      Restore subsequent transaction logs in sequence.

ANSWER: B

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>Generally, backup of a portion of a database is chosen when backup of an entire database is not a viable option due to database size or high-frequency of transactions. However, backup of a file or filegroup can be an effective strategy even for relatively small databases when server configuration lends itself to a file-based backup operation.<BR>Partial restore operations work with database filegroups. The primary filegroup is always restored, along with the files that you specify and their corresponding filegroups. The result is a subset of the database. Filegroups that are not restored are marked as offline and are not accessible.<BR><BR><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000"><B>?</B></font><B>Note</B> Because the primary file is restored, all catalogs (except full-text catalogs) are restored, even those associated with files that are not included in the restore operation.<BR><BR>
You can recover to a point in time by recovering only the transactions that occurred before a specific point in time within a transaction log backup, rather than the entire backup. By viewing the header information of each transaction log backup or the information in the backupset table in msdb, you can quickly identify which backup contains the time to which you want to restore the database. You then need only apply transaction log backups up to that point.<BR><BR><B>--REF: (BOL) keyword search, "Backing up Selected Portions of a Database", "Partial Database Restore Operations", "Recovering to a Point In Time"</b></font>












      47. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database that has the torn page detection database option 
      enabled. Backups of the database are made daily.

      The server loses power for one minute. When power is restored, torn pages 
      are detected. You notice in SQL Server Enterprise Manager that the 
      database is marked suspect.

      You need to correct the problem. What should you do?

      a. Execute the DBCC CHECKDB statement, and then specify the PHYSICAL_ONLY 
      option.

      b. Execute the DBCC CHECKDB statement, and then specify the REPAIR_REBUILD 
      option.

      c. Execute the sp_resetstatus stored procedure.

      d. Restore the suspect database from backups.

ANSWER: D 

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>If the recovery failed because of a persistent I/O error, a torn page, or other possible hardware problem, resolve the underlying hardware problem and restore the database by using a backup. If no backups are available, consider the repair options of DBCC CHECKDB. The scenario backs up the db daily.<BR><BR><B>DBCC CHECKDB</B> validates the integrity of everything within the database. Expect it to take some time to run. Integrity checks might take several hours to run, depending on the size of your databases, so be sure to schedule them to occur when database usage is low. Checks should be run on a regular basis, perhaps weekly or monthly or before database backups.<br><br>If a torn page is detected, an I/O error(926) is raised and the connection is killed. If the torn page is detected during recovery, the database is also marked suspect. The database backup should be restored, and any transaction log backups applied, because it is physically inconsistent.<br><br><b>--ref:(BOL) KEYWORD SEARCH, "DBCC CHECKDB", "Error 926"<br>--ref: (SAC) ch30, ch32, Database Maintenance Plans, Recovery Using the Transaction Log, pg. 824, 880</b></FONT>
















      48. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. You perform full database backups every 
      two days. You also run regular database consistency checks on the server. 
      The most recent check of the Sales database returns the following message.

      CHECKDB found 0 allocation errors and 9 consistency errors in the table 
      'Orders'
      (object ID 214575782).

      You want to correct the data integrity errors while minimizing the amount 
      of data lost. What should you do?

      a. Disconnect users from the Sales database.
      Enable the single user database option.
      Execute the DBCC CHECKTABLE statement for the Orders table, and specify 
      the REPAIR_REBUILD option.

      b. Disconnect users from the Sales database.
      Enable the dbo use only database option.
      Execute the DBCC CHECKTABLE statement for the Orders table, and specify 
      the REPAIR_REBUILD option.

      c. Disconnect users from the Sales database.
      Execute the RESTORE DATABASE statement for the Sales database

      d. Execute the DBCC CLEANTABLE statement for the Orders table.

      e. Execute the sp_table_validation stored procedure for the Orders table.

ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black><br><br><b>DBCC CHECKTABLE</b> performs a physical consistency check on tables and indexed views. For the specified table, <B>DBCC CHECKTABLE</B> checks that:
<UL>
<FONT FACE="Arial"><LI>Index and data pages are correctly linked. </LI>
<LI>Indexes are in their proper sort order. </LI>
<LI>Pointers are consistent. </LI>
<LI>The data on each page is reasonable. </LI>
<LI>Page offsets are reasonable.</LI></UL>
DBCC CHECKTABLE checks the linkages and sizes of<B> text</B>,<B> ntext</B>, and <B>image </B>pages for the specified table. DBCC CHECKTABLE does not acquire a table lock by default. Instead, it acquires a schema lock that prevents meta data changes but allows changes to the data.<BR><BR><B>REPAIR_REBUILD</B> Performs minor, nontime-consuming repair actions such as repairing extra keys in nonclustered indexes. These repairs can be done quickly and performs time-consuming repairs such as rebuilding indexes. All repairs can be done without risk of data loss.<BR><BR>The correct way to run a DBCC CHECKDB or DBCC CHECKTABLE statement with valid REPAIR options is to start SQL Server normally and then explicitly set the database in single user mode. You can do this from either the Enterprise Manager or the Query Analyzer.After the database is in single user mode, you can then run the DBCC CHECKDB or DBCC CHECKTABLE statements with the valid REPAIR options.<BR><BR><B><A HREF="http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q264154&" TITLE="MSKB Article Q264154" target="blank">Microsoft Knowledge Base Article - Q264154</A><BR>--REF: (BOL) keyword search, "DBCC CHECKTABLE"</B></font>













      49. You are the administrator of two SQL Server 2000 computers for an online 
      retailer. The servers receive and utilize customer data as shown in the 
      exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-49.gif','Exhibit','height=276,width=411,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      One server contains a database that recordscustomer data. The second 
      server imports and transforms the data for analysis.

      The Data Transformation Services (DTS) package is stored in the Meta Data 
      Services repository on the second server. You want to maximize the amount 
      of lineage data that can be recovered if a data file is damaged or lost.

      Which two actions should you take? (Each correct answer represents part of 
      the solution. Choose two.)

      a. Use the Full Recovery model for the staging database.

      b. Use the Full Recovery model for the msdb database.

      c. Back up the transaction log in the staging database by using the 
      NO_TRUNCATE option.

      d. Back up the transaction log in the msdb database by using the 
      NO_TRUNCATE option.

      e. Back up the multidimensional data cube.

      f. Save the DTS package as a file.

ANSWER:B, D 

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>If you save a Data Transformation Services (DTS) package to Microsoft® SQL Server™ 2000 Meta Data Services, you can record and track two types of data lineage: Row-level data lineage and Column-level data lineage. A DTS package is saved as a DTS SQL Server package (a DTS save option where the package is saved to local SQL Server tables in the msdb database).<BR><BR>Meta Data Services is the preferred means of storing DTS packages in a data warehousing scenario because it is the only method of providing data lineage for packages.<BR><BR><B>--REF:(BOL) keyword search, "Data Warehousing", "Recording Data Lineage in DTS", "DTS Package Details"</B></font>














      50. You are the administrator of a SQL Server 2000 computer at your company's 
      warehouse. All product orders are shipped from this warehouse. Orders are 
      received at 30 sales offices. Each sales office offers a range of products 
      specific to its region.

      Each sales office contains one SQL Server 2000 computer. These servers 
      connect to the warehouse through dial-up connections as needed, typically 
      once a day. Each sales office needs data pertaining only to its region.

      You need to replicate inventory data from the server at the warehouse to 
      the servers at the sales offices. You want to minimize the amount of time 
      needed to replicate the data.

      Which three actions should you take? (Each correct answer represents part 
      of the solution. Choose three.)

      a. Create one publication for each Subscriber.

      b. Create one publication for all Subscribers.

      c. Enable horizontal filtering.

      d. Enable vertical filtering.

      e. Use pull subscriptions.

      f. Use push subscriptions.

ANSWER: B,C,D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>You have a company that sells products.All products would be (<I>vertical</I>) columns in your database. You would use <B>vertical filtering</B> so the sales office each saw only the products meant for their region You could change the regions product line to reflect seasonal sale items.<BR><BR>There are several orders being proccessed at the Warehouse. Some orders are for areas outside any one sales office region. Each order fills a (<I>horizontal</I>) row in your database. You would use <B>Horizontal filtering</B> so each sales office saw only orders for their region. You can also filter out older rows from the day before.<BR><BR><B>Snapshot replication</B> is sufficient and appropriate—for example, when source data is modified only occasionally. Information such as phone lists, price lists, and item descriptions can easily be handled by using snapshot replication. These lists can be updated once per day during off hours. In the senario, The servers connect to the warehouse through dial-up connections as needed, typically once a day. Probably at the start or end of the work day --<I>as needed</I>, pull subscribers would set their own schedule.<BR><BR><B>Transacional Replication</B> and <B>Merge replication</b> are used when multidirectional replication is needed. Our subscribers only need  data from the warehouse.<BR><BR>When a <B>push subscription</B> is used, the schedule on which the replication occurs is determined on the distributor. The push subscription is the typical subscription method for nonportable subscribers. Our subscribers are using dial-up connections.<BR><BR><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000"><B>?</B></font><FONT COLOR="teal"> From the <B>subscriber</B>, you can configure a pull subscription; from the <B>publisher</B>, you can configure a push subscription. Pull subscriptions are controlled by and configured from the subscriber.</font><BR><BR>Typically, subscribers that are not constantly connected to the network use pull subscriptions. For example, pull subscriptions are appropriate for the portable computers used by a mobile sales force that irregularly connects to the network and updates the subscription.<BR><BR>AS the administrator of a SQL Server 2000 computer at your company's warehouse who wants to minimize the amount of time needed to replicate the data, you will set up snapshot replication with both horizontal and vertical filtering for your dial-up subscribers and let them configure pull subscriptions.<BR><BR><B>--REF:(SAC) ch26, ch27, ch28, Types of Replication, pg. 635-806</B></FONT>















      51. You are the administrator of a SQL Server 2000 computer. Your company 
      purchases an accounting application from a vendor. The application stores 
      its data in a database named Accounting on the server. The tables in this 
      database contain columns that function as primary keys, but PRIMARY KEY 
      and FOREIGN KEY constraints are not used.

      You need to replicate data from this database to another SQL Server 
      computer. This server will use the replicated data to generate reports. 
      Most reports will run each month, but the accounting department needs to 
      have the ability to run reports at any time. Reports should be acurate 
      through the last full working day.

      You cannot make any changes to the database, but you need to implement 
      replication. Which two actions should you take? (Each correct answer 
      represents part of the solution. Choose two.)

      a. Implement merge replication.

      b. Implement snapshot replication.

      c. Implement transactional replication.

      d. Schedule replication to run continuously.

      e. Schedule replication to run during off-peak hours.

ANSWER: B, E

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black><BR><BR>
Snapshot Publication Creates a snapshot publication that periodically copies a snapshot of the article to the subscriber. A snapshot publication can be created from any table.<BR><BR>Snapshot publications do not allow updateable subscriptions. If an IDENTITY column is being replicated, By default, the value of the column will be replicated, but not the IDENTITY property of the column.<BR><BR>Transactional Publication Creates a transactional replication publication that updates the subscription with changes made to the publisher, based on transactions. Articles can be created only from tables with primary keys. You cannot make any changes to the database in this scenaro<BR><BR><B>--REF: (SAC) ch26, Snapshot Replication, pg. 635</B></FONT>

      52. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. The database is configured as shown in 
      the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-52a.gif','Exhibit','height=222,width=529,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      In the last six months, the database has grown by 4 GB. Users report that 
      query response time has slowed. The options set up on the database are 
      shown in the Datebase Options exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-52b.gif','Exhibit','height=386,width=406,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      You want to accelerate query response time. What should you do?

      a. Update the database statistics

      b. Add indexes to the foreign key fields

      c. Truncate the transaction log

      d. Run the Database Maintenance Plan Wizard

      e. Drop primary keys from all tables

ANSWER: B

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>Because the database has grown by 4 GB, and users report that query response time has slowed as a result, updating the statistics would seem to be a good answer. However, the exhibit shows both the auto create... and auto update statistics are set to true. That leaves adding indexes (B).<BR><BR>
Ideally, you'll select columns for indexing based on the types of queries executed against the database. Create indexes on frequently searched columns, such as:<BR><BR>
Primary keys<BR>
Foreign keys or other columns that are used frequently in joining tables<BR> 
Columns that are searched for ranges of key values<BR>
Columns that are accessed in sorted order<BR><BR>
Switching the clustered indexes to the foreign keys allowed a 20-25 percent decrease in access time.<BR><BR>
<B>--REF: <A HREF= "http://www.microsoft.com/technet/treeview/default.asp?url=/technet/prodtechnol/sql/maintain/optimize/c0618260.asp" target="blank">Planning and Creating Indexes</A>
<BR>--REF: <A HREF="http://www.microsoft.com/technet/treeview/default.asp?url=/technet/prodtechnol/sql/plan/indexing.asp" target="blank">Indexing for Performance</A><BR>--REF: (BOL) keyword search, "Statistical Information", "Setting Database Options"</B></FONT>

      53. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database that is heavily indexed and that the company users 
      query extensively. The database has grown and query response time has 
      slowed. The database is stored in a single data file.

      You want to accelerate query response time. What should you do?

      a. On a new hard disk, create a new filegroup.
      Drop the existing nonclustered indexes, and then re-create them on the new 
      filegroup.

      b. On a new hard disk, add a new file to the PRIMARY filegroup.
      Drop the existing nonclustered indexes, and then re-create them on the 
      PRIMARY filegroup.

      c. On the existing hard disk, create a new filegroup.
      Drop the existing nonclustered indexes, and then re-create them on the new 
      filegroup.

      d. On the existing hard disk, add a new file to the PRIMARY filegroup.
      Drop the existing nonclustered indexes, and then re-create them on the 
      PRIMARY filegroup.

ANSWER:A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>Most databases perform well with only a primary data file and one transaction log file. This is the recommended design for databases that are not particularly I/O intensive. If you have an I/O-intensive system that requires many disk drives, you will probably want to use user-defined filegroups to allow you to spread the data across disks or disk arrays for parallel I/O performance.<BR><BR>A nonclustered index is analogous to an index in a textbook. The data is stored in one place, the index in another, with pointers to the storage location of the data.<BR><BR>Place nonclustered indexes for heavily used tables in a separate filegroup on different physical disks from the disks containing the table data itself. This technique also allows for parallel disk I/O.<BR><BR><B>--REF: (BOL) keyword search, "Using Nonclustered Indexes"<BR>--REF: (SAC) ch9, Rules and recommendations, pg. 184</b></font>









      54. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. The database has a group of tables that 
      analysts use to examine sales trends. The database options are set to 
      their default values, and the tables are configured as shown in the 
      exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-54.gif','Exhibit','height=301,width=478,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      Analysts who use the database report that query performance has become 
      slower. You analyze the clustered primary key on the Invoices table and 
      receive the following results.

      <p><img border="0" src='./70-228/Images/pic228-54a.gif'></p>

      You want to improve performance of queries that join tables to the 
      Invoices table. What are three possible Transact-SQL statements you can 
      execute to achieve this goal? (Each correct answer represents a complete 
      solution. Choose three.)

      a. DBCC UPDATEUSEAGE ('Sales','Invoices','PK_Invoices')

      b. CREATE UNIQUE CLUSTERED INDEX PK_Invoices On Invoices(InvoiceID) WITH DROP_EXISTING

      c. DBCC INDEXDEFRAG ('Sales','Invoices','PK_Invoices')

      d. DBCC DBREINDEX (Sales.dbo.Invoices, 'PK_Invoices')

      e. UPDATE STATISTICS 'Invoices'

      f. DBCC CHECKALLOC (Sales, REPAIR_FAST)

ANSWER: B, C, D

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B><font size=2 face=arial color=black>Indexes sometimes become fragmented over a long period of time because of page splits, which physically scatter index pages in the database. As a result, performance worsens. An index can also become off balance, meaning that one portion of the tree has more full index pages than another portion of the tree. You can restore balance and continuity by rebuilding the index. Also, index statistics are re-created when the index is rebuilt.&nbsp;<BR><BR><b>DBCC UPDATEUSEAGE</b> does not
exist.</FONT>
<p><font size=2 face=arial color=#0000FF>CREATE INDEX</FONT><font size=2 face=arial color=black>…</FONT><font size=2 face=arial color=#0000FF>DROP_EXISTING</FONT>
<font size=2 face=arial color=black> is used to rebuild only one index at a time on a table.&nbsp;
</FONT>
</p>
<p>
<font size=2 face=arial color=#0000FF> DBCC DBREINDEX
</FONT>
<font size=2 face=arial color=black> is used with a database name and a table name to rebuild all of the indexes on that table, without having to execute separate commands for each index.<BR><BR>
</FONT>
<font size=2 face=arial color=#0000FF>
DBCC INDEXDEFRAG</FONT>
<font size=2 face=arial color=black> can defragment clustered and nonclustered indexes on tables and views. DBCC INDEXDEFRAG defragments the leaf level of an index so that the physical order of the pages matches the left-to-right logical order of the leaf nodes, thus improving index-scanning performance.</p>
</font><p>
<font size=2 face=arial color=#0000FF> UPDATE STATISTICS</font>
<font size=2 face=arial color=black> The database options are set to their default values which means the Auto Stats, Auto update Stats is set to true. running UPDATE STATISTICS would be redundant. is not nearly as efficient as rebuilding an index. The index is fragmented, which is more of a problem than outdated statistics.</font></p>
<p>
<font size=2 face=arial color=#0000FF> DBCC CHECKALLOC </font><font size=2 face=arial color=#000000>Would
need to be run with the REPAIR_REBUILD argument to include the
&quot;time-consuming repairs&quot; such as rebuilding indexes.</font></p>
<font size=2 face=arial color=black> 
<p><font size="2" face="arial" color="#0000FF">DBCC SHOWCONTIG</font><font size="2" face="arial" color="black"> 
(Used in the exhibit), determines whether the table is heavily fragmented. In the exhibit, the index is fragmented. The <b>Avg. Bytes free per page</b>figure should be low and the <b>Avg. Page density (full)</b> figure should be
high. <b>Logical Scan Fragmentation</b> and, to a lesser extent, <b>Extent Scan Fragmentation</b> values give the best indication of a table's fragmentation level. Both these values should be as close to zero as possible (although a
value from 0% through 10% may be acceptable). It should be noted that the <b>Extent Scan Fragmentation</b> value will be high if the index spans multiple files.&nbsp;</font></p>
<p></font><B><font face="arial" color="black" size="2">--REF: (BOL) keyword search, "DBCC
INDEXDEFRAG&quot;, &quot;DBCC SHOWCONTIG&quot;<BR>--REF: (SAC) ch17, Rebuilding Indexes, pg. 424</font></B></p>










      55. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. The Sales database is configured as shown 
      in the Database Schema exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-55a.gif','Exhibit','height=261,width=526,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      The Sales database stores point-of-sale transaction data. The data is 
      later imported into another database for analysis. Recently, users have 
      reported slow response times whenever they enter point-of-sale information.

      You examine the indexes on the Invoices table that are configured as shown 
      in the Index Description exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-55b.gif','Exhibit','height=198,width=590,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You want to accelerate database response time when users insert new 
      point-of-sale information. What should you do?

      a. Drop IX_Customers_FK and IX_SalesPerson_FK.

      b. Change IX_Customers_FK to a clustered index.

      c. Change IX_SalesPerson_FK to a clustered index.

      d. Change PK_Invoices to a nonclustered index.

ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>Only one clustered index can be created per table. If a clustered index does not already exist on the table, or a nonclustered index is not explicitly specified, a unique, clustered index is created to enforce the PRIMARY KEY constraint. A primary Key cannot be a nonclustered index.<BR><BR><B>--REF: (BOL) keyword search, "Creating an Index", "Creating and Modifying PRIMARY KEY Constraints"</B></FONT>












      56. You are the administrator of a SQL Server 2000 database. The database is 
      configured by using the default options. You drop indexes to facilitate a 
      large import of data, and rebuild them after the import is complete.

      Users report that response times from a stored procedure have become 
      slower. In the stored procedure, you examine the following code.

      <p><img border="0" src='./70-228/Images/Pic228-56.gif'></p>

      You want to improve the performance of the procedure by using the least 
      amount of administrative effort. What should you do?

      a. Recompile the stored procedure.

      b. Update the database statistics.

      c. Check the consistency of the database and repair errors.

      d. Create a view and modify the stored procedure to use the view.

ANSWER: A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>Major changes have just been made to your database. The database is configured by using the default options.<BR><BR><B>Auto create statistics and Auto update Statistic are set to on by default.</B><BR><BR>As a database is changed by such actions as adding indexes or changing data in indexed columns, the original query plans used to access its tables should be optimized again by recompiling them. This optimization happens automatically the first time a stored procedure is run after Microsoft® SQL Server™ 2000 is restarted. It also occurs if an underlying table used by the stored procedure changes. But if a new index is added from which the stored procedure might benefit, optimization does not automatically happen (until the next time the stored procedure is run after SQL Server is restarted).<BR><BR><B>--REF: (BOL) keyword search, "Recompiling a Stored Procedure", "Database Options"</B></FONT>
     











      57. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Inventory. Users report that the following query 
      responds slowly.

      <p><img border="0" src='./70-228/Images/Pic228-57b.gif'></p>

      You examine the indexes in the PartsLocations table. The indexes are 
      configured as shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-57.gif','Exhibit','height=198,width=590,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You also examine the contiguity of the table and receive the following 
      results.

      <p><img border="0" src='./70-228/Images/Pic228-57a.gif'></p>

      You need to improve the performance of the query. What should you do?

      a. Rebuild the PK_PartsLocations index.

      b. Rebuild the IX_PartsLocations_PartsID index.

      c. Rebuild the IX_PartsLocations_LocationID index.

      d. Rebuild the IX_PartsLocations_PartsID_LocationID index.

ANSWER:A

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black><BR><BR><B>DBCC SHOWCONTIG</B> determines whether the table is heavily fragmented. When an index is heavily fragmented, there are two choices for reducing fragmentation:<BR><BR><B>Drop and re-create a <u>clustered</U> index.</B><BR> Re-creating a clustered index reorganizes the data, and results in full data pages. The level of fullness can be configured using the FILLFACTOR option. The drawbacks of this method are that the index is offline during the drop/re-create cycle and that the operation is atomic. If the index creation is interrupted, the index is not re-created.<BR><BR>Use<B> DBCC INDEXDEFRAG</B> to reorder the leaf level pages of the index in a logical  order.<BR><BR><B>Logical Scan Fragmentation</B> and, to a lesser extent, <B>Extent Scan Fragmentation</B> values give the best indication of a table's fragmentation level. Both these values should be as close to zero as possible (although a value from 0% through 10% may be acceptable). It should be noted that the <B>Extent Scan Fragmentation</B> value will be high if the index spans multiple files. Both methods of reducing fragmentation can be used to reduce these values.<BR><BR>The <B>DBCC SHOWCONTIG</B> exhibit shows a 33.33% fragmintation. The PK_PartsLocations index is the clustered index. There is no choice for "INDEXDEFRAG.<BR><BR><B>--REF: (BOL) keyword search, "DBCC SHOWCONTIG"</b></font>














      58. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. The database is configured as shown in 
      the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-58a.gif','Exhibit','height=289,width=334,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      Analysts examine customer buying patterns and frequently use the following 
      query.

       <p><img border="0" src='./70-228/Images/Pic228-58c.gif'></p>

      You analyze the indexes in the Invoices table. The indexes are configured 
      as shown in the Indexes Exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-58b.gif','Exhibit','height=81,width=569,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      You want to optimize the database schema so that it responds quickly to 
      the analysts' query. Which two actions should you take? (Each correct 
      answer represents part of the solution. Choose two.)

      a. Re-create the PK_Invoices index as a nonclustered index

      b. Re-create the IX_Customers_FK index as a clustered index

      c. Re-create the IX_SalesPerson_FK index as a clustered index

      d. Create a composite index on CustomerID fields and SalesPersonID fields

      e. Create a composite index on InvoiceID fields and CustomerID fields

ANSWER: A, b

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>The query is creating a fact table out of
the dimension tables: Customers, Invoices, Orderdetails, and Products. The </font>
<font size=2 face=arial color=#0000FF> FROM</font>
<font size=2 face=arial color=black> statement
uses the Customers table as the base table. In a three-table join, only one
table can be used to bridge from one of the other tables to the third table.That table is the Invoices table. (OrderDetails is the bridge between Invoices and Products)</font><p>
<font size=2 face=arial color=black>The </font>
<font size=2 face=arial color=#0000FF>WHERE</font>
<font size=2 face=arial color=black> statement is calling on the CustomerID
column which is the primary key in the base table. By creating a <i>&quot;COMPOSITE
INDEX&quot;</i>&nbsp; query times to the Invoice ( bridge) table will be
faster. To do this, you you would have to remove the existing clustered index on
the Invoices table.</p>
</font>
<div align="center">
  <center>
  <table border="0" width="461" cellspacing="1" cellpadding="0">
    <tr>
      <td width="105" align="center" bgcolor="#008080" bordercolorlight="#FFFFFF" bordercolordark="#FFFFFF"><b>
<font size=2 face=arial color=#FFFFFF> Customers </font></b></td>
      <td width="128" align="center" bgcolor="#008080"><b>
<font size=2 face=arial color=#FFFFFF> Invoices </font></b></td>
      <td width="120" align="center" bgcolor="#008080"><b>
<font size=2 face=arial color=#FFFFFF> OrderDetail </font></b></td>
      <td width="80" align="center" bgcolor="#008080">
        <p align="center"><b>
<font size=2 face=arial color=#FFFFFF> Products </font></b></td>
    </tr>
<font size=2 face=arial color=black> 
<tr>
  <td width="105" align="right" bgcolor="#C0C0C0">&nbsp;</td>
</font>
<td width="128" bgcolor="#C0C0C0">
  <p align="right"><b>
<font size=2 face=arial color=black> InvoiceID =</font></b></td>
<td width="120" bgcolor="#C0C0C0"><b>
<font size=2 face=arial color=black> &nbsp;InvoiceID</font></b></td>
<font size=2 face=arial color=black> 
<td width="80" bgcolor="#C0C0C0">&nbsp;</td>
</tr>
    </font>
    <tr>
      <td width="105" align="right" bgcolor="#C0C0C0"><b>
<font size=2 face=arial color=black> CustomerID =</font></b></td>
      <td width="128" align="right" bgcolor="#C0C0C0">
        <p align="left"><b>
<font size=2 face=arial color=black> &nbsp;CustomerID</font></b></td>
      <td width="120" align="right" bgcolor="#C0C0C0"><b>
<font size=2 face=arial color=black> ProductID =</font></b></td>
      <td width="80" bgcolor="#C0C0C0"><b>
<font size=2 face=arial color=black> &nbsp;ProductID</font></b></td>
    </tr>
  </table>
  </center>
</div>
<p><b><font color="black" size="2" face="Arial">--REF: (BOL) keyword search,
&quot;Fact Tables&quot;, &quot;Dimension Tables&quot;, &quot;Join
Fundamentals&quot;, &quot;Composite Primary Key&quot; &quot;WHERE&quot;,
&quot;FROM&quot;</font></b></p>











      59. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named MedicalRecords. Users access medical records by 
      using the PatientID field. This field is the clustered primary key for the 
      Patients table. When users try to access medical records, the database 
      responds slowly. You examine the database options as shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-59.gif','Exhibit','height=386,width=406,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You want to accelerate query response time and minimize administrative 
      overhead. How should you reconfigure the database?

      a. Create a SQL Server Agent job to execute the UPDATE STATISTICS 
      statement, and schedule the job to run weekly.

      b. Select the Auto update statistics check box.

      c. Run the Database Maintenance Plan Wizard, and accept the default 
      settings.

      d. Rebuild the primary key as a nonclustered primary key.

      e. Clear the Auto create statistics check box.

ANSWER: B

<B><font size=3 face=Arial color=black>EXPLANATION: </font></B>
<font size=2 face=arial color=black>Auto update statistics check box sets the database option AUTO_UPDATE_STATISTICS  to TRUE. This is the default setting.<BR><BR><B>AUTO_UPDATE_STATISTICS</B><BR>When set to ON, existing statistics are automatically updated when the statistics become out-of-date because the data in the tables has changed. When set to OFF, existing statistics are not automatically updated; instead, statistics can be manually updated. For more information, see Statistical Information.<BR><BR><B>--REF: (BOL) keyword search, "AUTO_UPDATE_STATISTICS"</b></font>







      60. You are the administrator of a SQL Server 2000 database named Articles. A 
      large city newspaper uses this database to store its archived newspaper 
      articles. Journalists query the database as part of their research. You 
      have created full-text indexes so that users can query the articles 
      quickly.

      A hardware failure forces you to restore the entire database from backup. 
      After you restore the database, the journalists report that they can no 
      longer run queries without receiving errors.

      You want to ensure that the journalists can query the database. What 
      should you do?

      a. Create a new full-text catalog for the Articles database

      b. Rebuild the full-text catalog for the Articles database

      c. Create a new full-text index on the table that holds the text for the 
      articles

      d. Repopulate the full-text index on the table that holds the text for the 
      articles

ANSWER: B

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2">Full-text catalogs and indexes are not
stored in a SQL Server database. The catalogs and indexes are managed separately
by the Microsoft Search service.&nbsp; They are stored in separate files managed
by the Microsoft Search service.</font>
<p class="tl"><font size="2" face="Arial">A full-text catalog contains full-text
indexes in a database. Each catalog can serve the indexing needs of one or more
tables within a database. (<font color="#FF0000">Full-text catalogs must reside
on a local hard drive associated with the instance of SQL Server.</font>
Removable drives, floppy disks, and network drives are not supported.)</font></p>
<p><font face="Arial" size="2">The full-text catalogs and indexes are not stored
in a SQL Server database. They are stored in separate files managed by the
Microsoft Search service. The full-text catalog files are not recovered during a
SQL Server recovery. They also cannot be backed up and restored using the
Transact-SQL BACKUP and RESTORE statements. The full-text catalogs must be
resynchronized separately after a recovery or restore operation. The full-text
catalog files are accessible only to the Microsoft Search service and the
Windows NT or Windows 2000 system administrator.</font></p>
<font face="Arial" size="2">A Full rebuild rescans all rows. Completely rebuilds
the full-text index. Use a full rebuild when a large percentage of records
change or are added at once.&nbsp;</font><p><font face="Arial" size="2"><FONT COLOR="#ff0000"><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000"><B>?</B></font></font><font color="#008080">The scenario reports a hardware failure. A hardware failure which forces you to restore the entire database from
backup would be a disk failure. If our Database was on the same disk as the SQL
Server instance, The catalog&nbsp; would need to be recreated making (A) the
correct choice. since the scenario does not mention reinstalling SQL server, (B)
is probably the better choice.</font></font></p>
<p><font face="Arial" size="2"><b>--REF: (BOL) keyword search, &quot;Microsoft Search service&quot;,
&quot;Full-Text Catalogs and Indexes&quot;, &quot;Full-Text Query
Architecture&quot;,&quot;Full-Text Search Recommendations&quot;,</b></font></p>












      61. You are the administrator of a SQL Server 2000 computer. The server 
      contains your company's investment-tracking database. Each day, 100 
      operators make approximately 5,000 changes to customer investments. In 
      addition, daily and monthly reports are created from the investment data.

      Developers at your company need to optimize the database application. They 
      need a sample of database query activity to discover if they can speed up 
      the transactions. The developers also want to replay the sample on another 
      SQL Server computer.

      You need to capture the sample, but you want to minimize any increase to 
      the workload of the server. What should you do?

      a. Run SQL Profiler on a client computer.
      Configure SQL Profiler to monitor database activity, and log data to a 
      .trc file.

      b. Run SQL Profiler on the server.
      Configure SQL Profiler to monitor database activity, and log data to a 
      database table.

      c. Run System Monitor on a client computer.
      Configure System Monitor to monitor database activity, and log data to a 
      .blg file.

      d. Start SQL Server from a command prompt.
      Specify trace flag 1204 to enable verbose logging.

ANSWER: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font>SQL Profiler is a tool that captures Microsoft® SQL Server™ 2000
events from a server. The events are saved in a trace file <font face="Arial" size="2">that
can later be analyzed or used to replay a specific series of steps when trying
to diagnose a problem. SQL Profiler is used for activities such as:</font>
<ul type="disc">
  <li><font face="Arial" size="2">Stepping through problem queries to find the
    cause of the problem.</font>
  <li><font face="Arial" size="2">Finding and diagnosing slow-running queries.</font>
  <li><font face="Arial" size="2">Capturing the series of SQL statements that
    lead to a problem. The saved trace can then be used to replicate the problem
    on a test server where the problem can be diagnosed.</font>
  <li><font face="Arial" size="2">Monitoring the performance of SQL Server to
    tune workloads.</font></li>
</ul>
<p><font size="2" face="Arial">Capture the trace data to a .trc file. This is
useful for saving trace data for later review and analysis. Saving a trace to a
file also reduces the memory overhead of SQL Profiler.</font></p>
<p>&nbsp;</p>
<p style="MARGIN-LEFT: 1.5em; MARGIN-TOP: -1.1em"><font face="Arial" size="2"><b class="notes">Important</b>&nbsp;&nbsp;Capturing
trace data to a table is slower than capturing to a file. An alternative is to
capture a trace to a file, open the trace file, and then save the trace as a
trace table.</font></p>
<!--/IMPORTANT-->
<p><font face="Arial" size="2">When using a trace file, SQL Profiler saves
captured event data (not trace definitions) to a SQLProfiler (*.trc) file. The
extension is added to the end of the file automatically when the trace file is
saved, regardless of any other specified extension. For example, if you specify
a trace file called Trace.dat, the file created is called Trace.dat.trc.</font></p>
<p>
<FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000"><B>?</B></font><font face="Arial" size="2" color="#008080">Windows 2000 System Monitor provides SQL Server
counters. These counters monitor system characteristics, such as the percent of
CPU utilization or the SQL Server cache hit ratio.</font></p>
<p><b><font face="Arial" size="2">--REF: (BOL) keyword search, &quot;Saving
Traces and Templates&quot;, &quot;Viewing and Analyzing Traces&quot;,
&quot;profiler&quot;</font></b></p>












      62. You are the administrator of a SQL Server 2000 computer. You are 
      configuring a database for an inventory application. The hard disks on 
      your server are configured as shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-62.gif','Exhibit','height=240,width=273,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      The operating system files are located on drive C. Your database will 
      store a maximum of 6 GB of data and requires a maximum of 2 GB of disk 
      space for the transaction log.

      You want to optimize database performance. What should you do?

      a. Add a 2-GB transaction log to drive D, a 3-GB data file to drive E, and 
      a 3-GB data file to drive F

      b. Add a 1-GB transaction log to drive C, a 1-GB transaction log to drive 
      D, a 3-GB data file to drive E, and a 3-GB data file to drive F

      c. Add a 1-GB transaction log to drive E, a 1-GB transaction log to drive 
      F, a 3-GB data file to drive E, and a 3-GB data file to drive F

      d. Add a 2-GB transaction log to drive F, a 3-GB data file to drive D, and 
      a 3-GB data file to drive E

ANSWER: D

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font>
<font face="Arial" size="2">Create the transaction log on a physically separate
disk device. The transaction log file is written serially; therefore, using a
separate, dedicated disk allows the disk heads to stay in place for the next
write operation.</font>
<p><font face="Arial" size="2">Partitioning a database improves performance and
simplifies maintenance. By splitting a large table into smaller, individual
tables, queries accessing only a fraction of the data can run faster because
there is less data to scan. Maintenance tasks, such as rebuilding indexes or
backing up a table, can execute more quickly.</font></p>
<p><font size="2" face="Arial">Partitioning can be achieved without splitting
tables by physically placing them on individual disk drives. Placing a table on
one physical drive and related tables on a separate drive, for example, can
improve query performance because when queries involving joins between the
tables are executed, multiple disk heads read data at the same time. Microsoft®
SQL Server™ 2000 filegroups can be used to specify on which disks to place the
tables.</font></p>
<h5><font size="2" face="Arial">Factors That Affect Performance</font></h5>
<p><font face="Arial" size="2">The following areas affect the performance of SQL
Server:</font>
<ul type="disc">
  <li><font face="Arial" size="2">System resources (hardware)</font>
  <li><font face="Arial" size="2">The Microsoft Windows NT® 4.0 and Windows®
    2000 operating systems</font>
  <li><font face="Arial" size="2">Database applications</font>
  <li><font face="Arial" size="2">Client applications</font>
  <li><font face="Arial" size="2">Network</font></li>
</ul>
<p><font face="Arial" size="2">It is advantageous to get as much data spread
across as many physical drives as possible in order to improve throughput
through parallel data access using multiple files. To spread data evenly across
all disks, first set up hardware-based disk striping, and then use filegroups to
spread data across multiple hardware stripe sets if needed.</font></p>
<p>&nbsp;<B><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000">?</font><font face="Arial" color="#ff0000" size="2">
</font></B><font face="Arial" size="2" color="#008080">The best place for a
transaction log is on a <b>dedicated, separate disk.</b> Failing to be able to
do that it should be on a disk without much I/O activity. Disk 0 has the OS and presumably
the page file.&nbsp; </font><font face="Arial" size="2" color="#008080">You
should spread your data across as many physical drives as you can, not logical
drives. Placing the data on Disk 0 and Disk 1 (drive D and E) accomplishes that.
Create a&nbsp; filegroup with system tables and data that is less often accessed
as your Primary filegroup on drive E and a secondary, default&nbsp; filegroup
with heavily used tables on drive D. with the transaction file on drive F. The
answer to this question was A for the &quot;jump the gun&quot; obvious reason.</font></p>
<p><font face="Arial" size="2"><b>--REF: (BOL) Optimizing Transaction Log
Performance, Partitioning, Placing Tables on Filegroups</b></font></p>










      63. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Inventory. The Inventory database has a table 
      names StorageLocations that stores the location of parts contained in your 
      company's warehouses. the StorageLocations table is configured as shown in 
      the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-63.gif','Exhibit','height=132,width=336,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>

      The LocationDescription field is usually described with a name 10 to 25 
      characters in length. The locations never store more than 100,000 units of 
      any given part.

      You want to modify the table's schema to save space. You cannot lose any 
      existing data. You want to do this by using the minimum amount of 
      administrative time and server resources.

      Which Transact-SQL statement should you execute?

      a. ALTER TABLE [dbo].[StorageLocations]
      ALTER FIELD [UnitsStored] [int] NOT NULL

      b. ALTER TABLE [dbo].[StorageLocations]
      [LocationDescription] [char] (25) COLLATE
      SQL_Latin1_General_CP1_CI_AS NOT NULL

      c. ALTER TABLE [dbo].[StorageLocations]
      ALTER FIELD [UnitsStored] [smallint] NOT NULL

      d. ALTER TABLE [dbo].[StorageLocations]
      [LocationDescription] [nvarchar] (25) COLLATE
      SQL_Latin1_General_CP1_CI_AS NOT NULL

ANSWER: A

<font size=3 face=Arial color=black><B>EXPLANATION:</B> </font><font face="Arial" color="black" size="2">Reducing
the LocationDescription&nbsp; from varchar (50) to nvarchar (25) may truncate
date if there was an entry that was outside the usual 10 to 25 character range.
Changing it to&nbsp; char (25) has the added problem of possably increasing the
data storage.&nbsp;</font><p><B><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000">?</font></B><font face="Arial" color="#ff0000" size="2">
</font><font face="Arial" size="2" color="#008080">If the average bytes of data
in a varchar column is 15 per row, a hundred rows of varchar (50) would store
only 1,500 bytes. If the average bytes of data in a char column is 15 per row, a
hundred row char (50) would store 50,000 bytes.</font></p>
<p><font face="Arial" size="2">
<b>      bigint</b>
      Integer (whole number) data from -2^63 (-9,223,372,036,854,775,808) through 
      2^63-1 (9,223,372,036,854,775,807)</font></p>
<p><font face="Arial" size="2"><b>&nbsp;int</b>
      Integer (whole number) data from -2^31 (-2,147,483,648) through 2^31 - 1 
      (2,147,483,647). Storage size is 4 bytes. The SQL-92 synonym for int is 
      integer.&nbsp;</font></p>
<p><font face="Arial" size="2"><b>
      smallint</b>
      Integer data from -2^15 (-32,768) through 2^15 - 1 (32,767). Storage size 
      is 2 bytes.
      tinyint
      Integer data from 0 through 255. Storage size is 1 byte.</font></p>
<p><font face="Arial" size="2"><b>char </b>
      Fixed-length non-Unicode character data with a maximum length of 8,000 
      characters. Storage size is <i>n </i>bytes.</font></p>
<p><font face="Arial" size="2"><b>
      varchar</b>
      Variable-length non-Unicode data with a maximum of 8,000 characters.
Storage size is the actual length in bytes of the data entered, not <i>n </i>bytes.</font></p>
<p><font face="Arial" size="2"><b>
      nvarchar</b>
      Variable-length Unicode data with a maximum length of 4,000 characters.&nbsp;</font></p>
<font face="Arial" size="2">
<p><b>--REF: (BOL) keyword search, &quot;bigint&quot;, &quot;int&quot;, &quot;smallint&quot;,
&quot;char&quot;, &quot;varchar&quot;, &quot;nvarchar&quot;&nbsp;</b>
</p></font>












      64. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database that stores inventory data. Another database 
      administrator has created a number of scheduled jobs to maintain the 
      inventory database. Each weeknight the following jobs occur.

      A BULK INSERT job imports data at 10:00 P.M. 
      Indexes are rebuilt at 10:15 P.M. 
      Data integrity checks are performed at 10:30 P.M. 
      A differential backup is performed at 10:45 P.M. 
      A DBCC SHRINKDATABASE job runs at 11:00 P.M.

      You notice that the final job often fails and returns the following error 
      message: 

      <p><img border="0" src='./70-228/Images/Pic228-64.gif'></p>

      You need to ensure that the final job runs without errors. What should you 
      do?

      a. Create a new DBCC SHRINKFILE job to shrink the inventory_data file. 
      Schedule the new job to run at the same time as the DBCC SHRINKDATABASE 
      job.

      b. Modify the DBCC SHRINKDATABASE job so that it uses DBCC SHRINKFILE 
      statement to shrink each file individually.

      c. Increase the time between the data integrity checks and the 
      differential backup.

      d. Increase the time between the differential backup and the DBCC 
      SHRINKDATABASE job.

ANSWER: D

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2">Space Allocation and Reuse is the function of DBCC SHRINKDATABASE. Most likly cause of the problem is the differential backup has not had enough time to finish and is still holding a lock.<BR><BR><b>--REF: (BOL) keyword search, "shrink Database"</b></FONT>














      65. You are the administrator of a SQL Server computer. Users report that the 
      database times out when they attempt to modify data. You use the Current 
      Activity window to examine locks held in the database as shown in the 
      following screenshot.

      <br><button onClick="window.open('./70-228/images/pic228-65.gif','Exhibit','height=90,width=200,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      You need to discover why users cannot modify data in the database, but you 
      do not want to disrupt normal database activities. What should you do?

      a. Use the spid 52 icon in the Current Activity window to discover which 
      SQL statement is being executed

      b. Use the sp_who stored procedure to discover who is logged in as spid 52

      c. Use SQL Profiler to capture the activity of the user who is logged in 
      as spid 52

      d. Use System Monitor to log the locks that are granted in the database

ANSWER: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2">The "activity window" is a feature of Enterprise Manager. You can use the SQL Server Enterprise Manager Current Activity window to perform ad hoc monitoring of SQL Server, which allows you to determine user activity on the system. Right click the icon will give you the information you need.<BR><BR><B>--REF: (BOL) keyword search "Monitoring with SQL Server Enterprise Manager"</B></FONT>













      66. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database that stores product data for your company.

      You need to execute an existing stored procedure that examines prices for 
      your company's products and can modify them if necessary. You execute the 
      stored procedure after business hours, but it does not complete. You 
      execute the sp_lock stored procedure and receive the following output.<BR><BR>
<DIV ALIGN="center">
  <CENTER>
  <TABLE BGCOLOR="#cccccc" BORDER="0">
    <TBODY>
      <TR>
        <TD BGCOLOR="#999999" BORDERCOLORDARK="#999999" BORDERCOLORLIGHT="#999999">
          <P ALIGN="center"><FONT FACE="Arial"><B>spID</B></FONT></P>
        </TD>
        <TD BGCOLOR="#999999" BORDERCOLORDARK="#999999" BORDERCOLORLIGHT="#999999">
          <P ALIGN="center"><FONT FACE="Arial"><B>dbID</B></FONT></P>
        </TD>
        <TD BGCOLOR="#999999" BORDERCOLORDARK="#999999" BORDERCOLORLIGHT="#999999">
          <P ALIGN="center"><FONT FACE="Arial"><B>objID</B></FONT></P>
        </TD>
        <TD BGCOLOR="#999999" BORDERCOLORDARK="#999999" BORDERCOLORLIGHT="#999999">
          <P ALIGN="center"><FONT FACE="Arial"><B>indID</B></FONT></P>
        </TD>
        <TD BGCOLOR="#999999" BORDERCOLORDARK="#999999" BORDERCOLORLIGHT="#999999">
          <P ALIGN="center"><FONT FACE="Arial"><B>Type</B></FONT></P>
        </TD>
        <TD BGCOLOR="#999999" BORDERCOLORDARK="#999999" BORDERCOLORLIGHT="#999999">
          <P ALIGN="center"><FONT FACE="Arial"><B>&nbsp;Mode</B></FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">61</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">DB</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">S</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">64</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">&nbsp;7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">DB</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">S</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">72</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">DB</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">S</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">72</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">1</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">PAG</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">IS</FONT></TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">72</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">TAB&nbsp;</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">IS</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">72</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">&nbsp;2145623952</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">1</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">KEY</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">S</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">78</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">DB</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">S</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">78</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">1</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">PAG</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">IX</FONT></TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">78</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">TAB</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">IX</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">78</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">7</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">1</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">KEY</FONT></P>
        </TD>
        <TD>
          <P ALIGN="center"><FONT FACE="Arial">X</FONT></TD>
      </TR>
    </TBODY>
  </TABLE>
  </CENTER>
</DIV>
<BR><BR>
      You want the stored procedure to complete successfully. What should you do?

      a. Execute the stored procedure, and specify the WITH RECOMPILE option.

      b. Execute the DBCC FREEPROCCACHE statement.

      c. Release the locks that are held by connections 61 and 64.

      d. Release the locks that are held by connections 72 and 78.

ANSWER: D

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2">A deadlock occurs when there is a cyclic dependency between two or more threads for some set of resources. 

Deadlock is a condition that can occur on any system with multiple threads, not just on a relational database management system. A thread in a multi-threaded system may acquire one or more resources (for example, locks). If the resource being acquired is currently owned by another thread, the first thread may have to wait for the owning thread to release the target resource. The waiting thread is said to have a dependency on the owning thread for that particular resource.

If the owning thread wants to acquire another resource that is currently owned by the waiting thread, the situation becomes a deadlock: both threads cannot release the resources they own until their transactions are committed or rolled back, and their transactions cannot be committed or rolled back because they are waiting on resources the other owns. For example, thread T1 running transaction 1 has an exclusive lock on the Supplier table. Thread T2 running transaction 2 obtains an exclusive lock on the Part table, and then wants a lock on the Supplier table. Transaction 2 cannot obtain the lock because transaction 1 has it. Transaction 2 is blocked, waiting on transaction 1. Transaction 1 then wants a lock on the Part table, but cannot obtain it because transaction 2 has it locked. The transactions cannot release the locks held until the transaction is committed or rolled back. The transactions cannot commit or roll back because they require a lock held by the other transaction to continue.<BR><BR><B>--REF:(BOL) keyword search "Deadlocks" </B></FONT>














      67. You are the administrator of a Microsoft Windows 2000 Advanced Server 
      computer. The server is also running SQL Server 2000 and contains a 
      database named Sales. The server is configured as shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-67.gif','Exhibit','height=186,width=381,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      The Sales database is configured by using the default options and 
      increases by 50 MB per day. You want an operator to be notified 
      automatically before the database runs out of disk space. You also want to 
      minimize the amount of administrative overhead necessary for this database.

      What should you do?

      a. Configure System Monitor to log an alert if the hard disk contains less 
      than 600 MB of free space
      Configure SQL Server Agent to send an e-mail message notifying the 
      operator of the System Monitor alert

      b. Create a SQL Server Agent job that uses the sp_spaceused stored 
      procedure each morning
      Place the results of the stored procedure in an e-mail message and use SQL 
      Mail to send the results to the operator

      c. Set the MaxSize property of Sales_data.mdf to 7.5 GB and the MaxSize 
      property of Sales_log.ldf to 1.5 GB
      Configure SQL Server Agent to send an e-mail message to an operator when 
      the data file and the transaction log have reached these limits

      d. Use Microsoft Windows Explorer to verify the available space on the 
      hard disk each morning 
      Execute the sp_spaceused stored procedure each morning

ANSWER: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2">An alert is an action that occurs on a server in response to an event or to a performance condition. Alerts can notify operators, cause specified jobs to be executed, and forward events to another server. An event is an error or a message that is written to the Windows NT or Windows 2000 application event log (which you can view by using the Windows NT or Windows 2000 Event Viewer). SQL Server Agent monitors the Windows application log for SQL Server events. When events that you have defined for action occur, SQL Server Agent responds automatically according to your specifications. For example, if an event of severity 17 occurs, you can specify that an operator be notified immediately.<BR><BR>Automated event response is called alerting. When an event occurs, SQL Server Agent compares the event details against the alerts defined by the SQL Server administrator. If it finds a match, SQL Server Agent performs the defined response. You can define alerts to: Notify operators, Execute a job, and Forward the event to the Windows application log on another server.<BR><BR><B>--REF: (BOL) keyword search, "Responding to Events"</B></FONT>











      68. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Orders, which is used to record customer orders 
      for the products your company sells.

      Your company's order volume exceeds 1 million orders per day. Each order 
      uses approximately 100 KB of space in the database. Users report that the 
      database responds sowly when they enter new orders.

      You use SQL Profiler to monitor the activity on the database and receive 
      the data shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-68.gif','Exhibit','height=254,width=398,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      You need to modify the database to improve performance. What should you do?

      a. Double the size of the data file

      b. Configure the database to automatically grow by 10 percent

      c. Seperate the database into two physical files

      d. Increase the size of the transaction log file

ANSWER: B

<font size=3 face=Arial color=black><B>EXPLANATION:&nbsp; </B> </font><p><b><font face="Arial" size="3">
growth_increment</font><font face="Arial" size="2"> </font></b><font face="Arial" size="2">
Is the amount of space added to the file each time new space is needed. Specify a whole number; do not include a decimal. A value of 0 indicates no growth. The value can be specified in MB, KB, GB, TB, or percent
(%). If a number is <font color="#FF0000"><b> specified <u> without</u> an MB, KB, or % suffix,
the default is MB</b></font><b>.</b> <b><font color="#008000"> When % is
specified, the growth increment size is the specified percentage of the size of the file at the time the increment
occurs</font>.</b> If FILEGROWTH is not specified, the default value is 10 percent and the minimum value is 64 KB. The size specified is rounded to the nearest 64 KB.&nbsp;</font></p>
<font face="Arial" size="2"><b>In Enterprise Manager, To specify how the file
should grow, select from these options:</b></font><p><font face="Arial" size="2">
<BR>To allow the currently selected file to grow as more data space is needed, select <b>Automatically grow file.</b>
&nbsp;<BR>To specify that the file should grow by fixed increments, select <b>In megabytes</b> and specify a value.&nbsp;<br>
To specify that the file should grow by a percentage of the current file size, select <b>By percent</b> and specify a value.
&nbsp;</font></p><blockquote><p><B><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000">?</font> <font face="Arial" color="#ff0000" size="2">
  </font></B><font face="Arial" size="2" color="#008080">Doubling the size would
  not correct the problem, it will only correct the symptom until the file
  filled up again. Splitting the file will not solve the problem as both files
  would auto grow at the same rate. you might see some slight I/O improvement if
  the files were placed on separate disks. The data file was probably set for
  10MB Auto Grow. If we do the math on the clues given in the question, that
  would be approximately twenty-one, 10MB Auto Grows per min. The Exhibit
  displays 11 File growths&nbsp; within a 30 second period.</font> </p>
</blockquote><p><font face="Arial" size="2"><b>--REF: (BOL) keyword search
&quot;CREATE DATABASE&quot;,&nbsp; &quot;FILEGROWTH&quot;</b></font></p>














      69. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. Users report that the database times out 
      when they attempt to perform queries. You use System Monitor to analyze 
      the server and receive the results shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-69.gif','Exhibit','height=402,width=507,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      You need to discover why database performance is slow. What should you do?

      a. Use the current Activity window to discover who is holding locks in the 
      database

      b. Use SQL Profiler to discover who is scanning tables in the database

      c. Measure disk activity by running the diskperf /y command, restarting, 
      then using the % Disk Time counter in System Monitor

      d. Use the sp_monitor stored procedure to measure the activity of the 
      server

ANSWER: A

<font size=3 face=Arial color=black><B>EXPLANATION:&nbsp; </B></font><font face="Arial" size="2">Your first step should be (A)<BR><BR><B>Query Tuning</B><BR><BR>
It may be tempting to address a performance problem solely by system-level server performance tuning; for example, memory size, type of file system, number and type of processors, and so forth. Experience has shown that most performance problems cannot be resolved this way. They must be addressed by analyzing the application, queries, and updates that the application is submitting to the database, and how these queries and updates interact with the database schema.<p><font face="Arial" size="2"><b>--REF: (BOL) keyword search
&quot;locking&quot;, "Query Tuning"</b></font></p>














      70. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named MedicalRecords. The data processing department 
      in your company adds new business rules to the database's stored 
      procedures. After the rules are added, users report that the medical 
      records application receives time-out errors.

      You use System Monitor to analyze the server and receive the results shown 
      in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-70.gif','Exhibit','height=402,width=517,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>

      You need to tune the stored procedures to improve performance. What should 
      you do?

      a. Add indexes to the fields that are used in the joins

      b. Remove the WITH COMPILE option from the stored procedure

      c. Remove the stored procedures and alter the application so that it uses 
      ad hoc queries to obtain data

      d. Change the transaction isolation level to Repeatable Read

ANSWER: B

<font size=3 face=Arial color=black><B>EXPLANATION: </B> </font><font face="Arial" size="2"><p><font face="Arial" size="2">Suppose you have a nonclustered index on the country column. If, the first time the procedure is called, the country/region you supply as the parameter occurs only a few times in the table, the optimizer might use the index.&nbsp; After that, the saved plan for this stored procedure always tells SQL Server to use the nonclustered index on the country column. If someone executes the procedure with a country value that occurs in many rows,
the original plan is still used, even though it's not an optimal plan for this second case. The mechanisms that SQL Server uses to autoparameterize queries that aren't stored procedures are very conservative, and SQL Server doesn't
autoparameterize any query in which a parameter change could lead to a different plan. However, when writing stored procedures, you can control when a stored procedure is recompiled.</font><p><font face="Arial" size="2">If you check the syntax for the CREATE PROCEDURE statement, you'll see that you can add the option WITH RECOMPILE to the
procedure definition. This option causes SQL Server to compile and optimize the procedure every time it runs. If you know that different parameters might require vastly different plans, consider this option. Also, you can recompile
one execution of a procedure by using the WITH RECOMPILE option with the EXECUTE statement. Any time a procedure is executed with this option, SQL Server doesn't check for any existing plans in cache, and the new plan developed for this single execution is saved in cache.</font></p><B>--REF: <A HREF="http://www.microsoft.com/technet/treeview/default.asp?url=/technet/prodtechnol/sql/plan/storedpr.asp" target="blank">RECOMPILE</A></B></font> 


















      71. You are the administrator of a SQL Server 2000 computer. The 
      SQLServerAgent service on the server is configured as shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-71.gif','Exhibit','height=309,width=313,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


      You configure two SQL Server Agent jobs to perform maintenance tasks. Each 
      job copies files from the server to a file share on a corporate file 
      server. Both jobs fail when you attempt to execute them.

      You need both jobs to execute successfully. What should you do?

      a. Ensure that the file copy procedures are in an ActiveScripting job step

      b. Make a member of the serveradmin server role the owner of both jobs

      c. Configure the SQLServerAgent service to use a domain account

      d. Grant the necessary permissions in the msdb database to the job owner's 
      SQL Server login

 ANSWER: C

<font size=3 face=Arial color=black><B>EXPLANATION: </B> </font><font face="Arial" size="2"><p><font face="Arial" size="2">For Microsoft SQL Server™ and SQL Server Agentto run as services in Windows, they must be assigned a Windows user account.Typically, both SQL Server and SQL Server Agent are assigned the same user account, either the local system or domain user account. .</font></p><font face="Arial" size="2"><B>Using the Local System Account</B></font><p><font face="Arial" size="2">The local system account does not require a password, does not have network access rights in Windows NT 4.0 and Windows 2000, and restricts your SQL Server installation from interacting with other servers.</font></p>
<h5><font face="Arial" size="2">Using a Domain User Account</font></h5><p><font face="Arial" size="2">A domain user account uses Windows Authentication, that is, the same user name and password used to connect to the operating system is also used to connect to SQL Server. A domain user account is typically used because many server-to-server activities can be performed only with a domain user account, for example:</font><ul type="disc">
  <li><font face="Arial" size="2">Remote procedure calls.</font>
  <li><font face="Arial" size="2">Replication.</font>
  <li><font face="Arial" size="2">Backing up to network drives.</font>
  <li><font face="Arial" size="2">Heterogeneous joins that involve remote data
    sources.</font>
  <li><font face="Arial" size="2">SQL Server Agent mail features and SQL Mail.
    This restriction applies if using Microsoft Exchange. Most other mail
    systems also require clients (the SQL Server and SQL Server Agent services)
    to be run on accounts with network access.</font></li>
</ul>
<p><font face="Arial" size="2"><b>--REF: (BOL) keyword search &quot;Setting up
Windows Services Accounts&quot;</b></font></p>













      72. You are the administrator of a Microsoft Windows NT 4.0 computer that is 
      running SQL Server 2000. The computer contains a database named Sales.

      The data file and transaction log for the Sales database are located on a 
      9.1 GB hard disk. Both files are configured for automatic file growth. The 
      data file occupies 7 GB of disk space.

      You need to calculate when you will need to add additional disk space. 
      What should you do?

      a. Configure System Monitor to log disk space utilization

      b. Configure a database maintenance job to run the DBCC CHECKALLOC 
      statement each night and then to log the to the job history

      c. Configure a SQL Server Agent job to execute the sp_spaceused stored 
      procedure each day and then to store the results of the procedure to a 
      table in the database

      d. Configure a SQL Server Agent job to execute the chkdsk utility each 
      night at midnight and then to send the results of the utility to the 
      default operator in an e-mail message

ANSWER:A

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2"><BR><BR><B>System Monitor</B><BR>Enables you to monitor server performance and activity using predefined objects and counters or user-defined counters to monitor events. System Monitor (Performance Monitor in Microsoft Windows NT® 4.0) collects counts rather than data about the events (for example, memory usage, number of active transactions, number of blocked locks, or CPU activity). You can set thresholds on specific counters to generate alerts that notify operators. System Monitor primarily tracks resource usage, such as the number of buffer manager page requests in use.<BR><BR><B>--REF: (BOL) keyword search "System Monitor"</B></FONT>










      73. You are the administrator of a SQL Server 2000 computer. You create a job 
      to perform several database maintenance tasks. This job must run whenever 
      the server is restarted.

      You use SQL Server Enterprise Manager to create a new schedule entry for 
      the job, and specify that the job should start automatically.

      You test the job by restarting the server. You check the job's history and 
      discover that the job did not run.

      You need the job to to run automatically when the server restarts. What 
      should you do?

      a. Create a stored procedure that uses sp_start_job to start the job 
      whenever the MSSQLService service starts

      b. Add another schedule entry to the job, specifically that the job start 
      hourly, and then disable the job

      c. Change the job's category to Database Maintenance

      d. Configure the SQLServerAgent service to start automatically

ANSWER: D

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
</font><font face="Arial" size="2">SQLServerAgent is a Windows NT 4.0 or Windows 2000 service that executes jobs, monitors SQL Server, and fires alerts. SQLServerAgent is the service that allows you to automate some administrative tasks. As such, you must start the SQLServerAgent service before your local or multiserver administrative tasks can run automatically. If the SQL Server service and SQL Server Agent service are not configured to start automatically, you must start them manually.<BR><BR><B>--REF: (BOL) keyword search "Using SQLServerAgent Service"</B></FONT>













      74. You are the administrator of eight SQL Server 2000 computers. You 
      configure alerts on each server so that various problem conditions will be 
      reported if they occur.

      You create 20 operators on one of the servers. You configure these 
      operators by using the e-mail and pager contact information for the 
      employees in your department. You configure the alerts on the server to 
      send e-mail messages and pager messages to the appropriate operators.

      You need to configure the same 20 operators on the other seven servers. 
      You want to do this with a minimum amount of administrative time.

      What should you do?

      a. Detach the msdb database from the first server
      Copy the database to the other seven servers
      Attach the database on all eight servers

      b. Use SQL Server Enterprise Manager on a single client computer to create 
      the operators on each server

      c. Use SQL Server Enterprise Manager to script all of the operators
      Use SQL Query Analyzer to run the script on the other seven servers

      d. User snapshot replication to replicate the msdb database from the first 
      server to the other seven servers

ANSWER: C

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2"><p class="proclabel"><b><font face="Arial" size="2">To script operators using
Transact-SQL</font></b><ol><li><font face="Arial" size="2">Expand a server group, and then expand a server.</font>  <li><font face="Arial" size="2">Expand <b>Management</b>, and then expand <b>SQL Server Agent</b>.</font>  <li><font face="Arial" size="2">Right-click <b>Operators</b>, point to <b>All Tasks</b>, and then click<b> Generate SQL script</b>.</font>  <li><font face="Arial" size="2">In the <b>File name</b> box, type a name for the script.</font>  <li><font face="Arial" size="2">Under <b>File format</b>, do one of the following:</font><ul type="disc"><li><font face="Arial" size="2">Click<b> MS-DOS Text (OEM)</b> to save the script in OEM format.</font><li><font face="Arial" size="2">Click<b> Windows Text (ANSI)</b> to save the script in ANSI format.</font><li><font face="Arial" size="2">Click<b> International Text (Unicode)</b> to save the script in Unicode format.</font></li></ul><li><font face="Arial" size="2">Under <b>SQL generation options</b>, do one or both of the following:</font><ul type="disc"><li><font face="Arial" size="2">Select the<b> Replace operator if it exists </b>check box<b> </b>to include in the script commands to that will delete any operators with the same name as jobs generated by the script.</font><li><font face="Arial" size="2">Select the<b> Include notifications sent by alerts to the operator</b> check box<b> </b>to include in the script commands to generate alert assignments for the operators generated by the script.</font></li></ul><li><font face="Arial" size="2">Enter a Transact-SQL batch separator. </font></li></ol><h3><font face="Arial" size="2">--REF: (BOL) keyword search &quot;How to script operators using Transact-SQL (Enterprise Manager)&quot;</font></h3>
















      75. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named Sales. A company e-commerce application uses the 
      Sales database to store sales transactions. The company Web site has grown 
      in popularity, and database utilization has increased.

      You need to collect data about the utilization of server resources so that 
      you can provide capacity planning. You want to automate the collection 
      process so that information is gathered as quickly as possible.

      What should you do?

      a. Configure System Monitor to collect data and store it in a SQL Server 
      table

      b. Create a SQL Server Agent job that executes the sp_statistics stored 
      procedure daily and places the results in a text file

      c. Use SQL Profiler to trace server activity and store the results in SQL 
      Server tables

      d. Configure SQL Server alerts to store information in the Windows 
      application event log

ANSWER: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2"><h5><font face="Arial" size="2">SQL Profiler</font></h5>
<p><font face="Arial" size="2">Enables you to monitor server and database
activity (for example, number of deadlocks, fatal errors, tracing stored
procedures and Transact-SQL statements, or login activity). You can capture SQL
Profiler data to a SQL Server table or a file for later analysis, and also
replay the events captured on SQL Server, step by step, to see exactly what
happened. SQL Profiler tracks engine process events, such as the start of a
batch or a transaction.</font></p>
<h5><font face="Arial" size="2">System Monitor</font></h5>
<p><font face="Arial" size="2">Enables you to monitor server performance and
activity using predefined objects and counters or user-defined counters to
monitor events. System Monitor (Performance Monitor in Microsoft Windows NT®
4.0) collects counts rather than data about the events (for example, memory
usage, number of active transactions, number of blocked locks, or CPU activity).
You can set thresholds on specific counters to generate alerts that notify
operators. System Monitor primarily tracks resource usage, such as the number of
buffer manager page requests in use.</font></p>
<p><font face="Arial" size="2">System Monitor makes it possible to obtain
up-to-the-second SQL Server activity and performance statistics. With this
graphical tool, you can:</font>
<ul type="disc">
  <li><font face="Arial" size="2">View data simultaneously from any number of
    computers.</font>
  <li><font face="Arial" size="2">View and change charts to reflect current
    activity, and show counter values that are updated at a user-defined
    frequency.</font>
  <li><font face="Arial" size="2">Export data from charts, logs, alert logs, and
    reports to spreadsheet or database applications for further manipulation and
    printing.</font><br>
  </li>
</ul>
<h1>   <font face="Arial" size="2">--REF: (BOL) keyword search &quot;Choosing a
Monitoring Tool&quot;, &quot;Monitoring with System Monitor&quot;</font></h1></FONT>
















      76. You are the administrator of a SQL Server 2000 computer. You create 
      several jobs on the server and schedule them to run during the evening.

      You configure an operator on the server and configure the jobs to send an 
      e-mail to this operator if a job fails for any reason.

      While testing the jobs, you discover that e-mail messages are not being 
      sent to the operator when a job fails. You use SQL Server Enterprise 
      Manager to confirm that SQL Mail is started.

      You need to ensure that e-mail messages are sent to the operator whenever 
      a job fails. What should you do?

      a. Configure SQLAgentMail to use a valid MAPI profile

      b. Configure SQL Mail to use a mailbox that delegates permissions to the 
      operator

      c. Use the net send notification method to send the operator e-mail 
      messages

      d. Create a job that executes the xp_startmail stored procedure
      Configure the job to run whenever SQL Server 2000 starts

 ANSWER: A

 <font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2"><P><FONT SIZE="2" FACE="Arial">SQL Server 2000 can connect with Microsoft Exchange Server, Microsoft Windows Mail, or a Post Office Protocol 3 (POP3) server to send and receive messages using two separate services, SQL Mail and SQLAgentMail. Both services
require a MAPI client application (such as Microsoft Outlook) on the local SQL Server 2000 computer and a MAPI&nbsp; messaging profile. A MAPI&nbsp; messaging profile requires the use of a domain user account. Generally, SQL Mail and SQLAgentMail use the
same domain user account for administrative convenience.</FONT></P>
<P><FONT SIZE="2" FACE="Arial">For e-mail and pager communication, you must install a MAPI-1-compliant e-mail client&nbsp; such as Microsoft Outlook or Microsoft Exchange Client on the server, and you must create a mail profile for SQLServerAgent.</FONT></P>
<P><FONT SIZE="2" FACE="Arial">The SQL Server Agent mail features will be referred to as SQLAgentMail to distinguish it from the SQL Mail features provided by MSSQLServer. SQL Mail establishes an extended MAPI connection with a mail host, while
SQLAgentMail establishes an extended MAPI connection on its own. Both SQL Mail and SQLAgentMail can connect with Microsoft Exchange Server, Microsoft Windows NT® Mail, or a Post Office Protocol 3 (POP3) server.</FONT></P>
<P><FONT SIZE="2" FACE="Arial">The SQL Server Agent mail features will be referred to as SQLAgentMail to distinguish it from the SQL Mail features provided by MSSQLServer. SQL Mail establishes an extended MAPI connection with a mail host, while
SQLAgentMail establishes an extended MAPI connection on its own. Both SQL Mail and SQLAgentMail can connect with Microsoft Exchange Server, Microsoft Windows NT® Mail, or a Post Office Protocol 3 (POP3) server.</FONT></P>
<B><FONT SIZE="2" FACE="Arial">--REF: (SAC) ch31,&nbsp;Operators, pg. 865<BR>
<B><FONT SIZE="2" FACE="Arial">--REF: (BOL) keyword search &quot;SQL Mail&quot;<BR>--REF: (Sys Admin) ch12, Lesson 2, &quot;Setting Up SQL Mail and SQLAgentMail&quot;, pg.385</FONT></B></FONT></B>











      77. You are the administrator of a SQL Server 2000 computer named CorpSQL. You 
      configure several SQL Server Agent jobs to perform automated maintenance 
      tasks on CorpSQL. The jobs execute properly for several weeks, and then 
      stop executing. You discover that the SQLServerAgent service has stopped.

      You attempt to start the SQLServerAgent service. The service does not 
      start. In the Microsoft Windows application event log you discover the 
      following error message: 

      <p><img border="0" src='./70-228/Images/pic228-77.gif'></p>

      You verify that the MSSQLServer service is running.

      You need to start the SQLServerAgent service and execute the maintenance 
      jobs. What should you do?

      a. Restore the msdb database from a backup.
      Restart the MSSQLServer service, and start the SQLServerAgent service

      b. Restart the server.
      Start the MSSQLServer service, and start the SQLServerAgent service

      c. Configure the SQLServerAgent service to start by using the local system 
      account.

      d. Configure the SQLServerAgent service to start by using the same user 
      account as the MSSQLServer service.

ANSWER: D

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT SIZE="2" FACE="Arial">For Microsoft SQL Server™ and SQL Server Agent to run as services in Windows, they must be assigned a Windows user account. If you have difficulty starting either the MSSQLServer or SQLServerAgent service under a
particular user account, you can:</FONT></P><P><FONT SIZE="2" FACE="Arial">If you have difficulty starting the SQLServerAgent service under a particular user account, assign that account to another service (for example, the Spooler service) and verify that the service can be started successfully. If not, the account is either not configured properly or cannot be validated by the domain controller (for example, if no domain controller is available).</FONT></P>
<P CLASS="indent"><FONT SIZE="2" FACE="Arial"><!--NOTE--><B>The local system account</B> does not require a password, does not have network access rights in Windows NT 4.0 and Windows 2000, and restricts your SQL Server installation from interacting with other servers.</FONT></P><P><FONT SIZE="2" FACE="Arial"><B>A domain user account </B>uses Windows Authentication, that is, the same user name and password used to connect to the operating system is also used to connect to SQL Server. A domain user account is typically used because many server-to-server activities can be performed only with a domain user account, for example:</FONT><UL>
  <LI><FONT FACE="Arial" SIZE="2">Remote procedure calls. Replication.</FONT></LI>
  <LI><FONT SIZE="2" FACE="Arial">Backing up to network drives.</FONT></LI>
  <LI><FONT SIZE="2" FACE="Arial">Heterogeneous joins that involve remote data sources.</FONT></LI>
  <LI><FONT SIZE="2" FACE="Arial">SQL Server Agent mail features and SQL Mail. This restriction applies if using Microsoft Exchange. Most other mail systems also require clients (the SQL Server and SQL Server Agent services) to be run on accounts with
    network access.</FONT></LI>
</UL>
<P CLASS="tl"><FONT SIZE="2" FACE="Arial">If the service does not have the appropriate permissions, certain functionality cannot be accomplished. For example, to write to a mail slot, the service must have a Windows NT domain user account, not just local
system, with network write privileges. The service must be a Windows NT account with local administrator privileges to:</FONT></P>
<UL>
  <LI><FONT SIZE="2"><FONT FACE="Arial" SIZE="2">Create SQL Server Agent CmdExec and Microsoft ActiveX® Script jobs not belonging to members of the sysadmin fixed server role.</FONT></FONT></LI>
  <LI><FONT FACE="Arial" SIZE="2">Use the automatic server restart feature of SQL Server Agent.</FONT></LI>
  <LI><FONT FACE="Arial" SIZE="2">Create SQL Server Agent jobs to be run when the server is idle.</FONT></LI>
</UL>
<P><FONT SIZE="2"><!--NOTE-->
 <B><FONT FACE="Wingdings" SIZE="6" COLOR="#ff0000">?</FONT></B><B><FONT FACE="Arial" COLOR="#ff0000"> </FONT></B><FONT FACE="Arial" COLOR="#008080">Configuring the SQLServerAgent service to start by using the local system account would prevent it from
doing a lot of jobs. And since You've&nbsp; verified that the MSSQLServer service is running, the account MSSQLServer is using has no problems.</FONT></FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;Troubleshooting MSSQLServer or SQLServerAgent Services User Accounts&quot;, &quot;Setting up Windows Services Accounts&quot;</FONT></B></P>

      78. You are the administrator of a SQL Server 2000 computer. Each night you 
      need to send a copy of the server's msdb database in an e-mail message to 
      the administrator of another SQL Server computer.

      You create a job that contains the following steps:

      <p><img border="0" src='./70-228/Images/pic228-78.gif'></p>
 
      You test the job, and it fails on the first step. You need to ensure that 
      the msdb database is mailed to the administrator every night.

      What should you do?

      a. Ensure that the SQLServerAgent service is running under a user account that has database owner access to the msdb database

      b. Delete the first and last steps in the job

      c. Configure the job to back up the msdb database to a temporary file Send the file to the administrator in an e-mail message

      d. Insert a new job step before the first step Configure the new step to terminate all processes that use the msdb database
     
ANSWER:C

<font size=3 face=Arial color=black><B>EXPLANATION:<BR><BR></B></font><font face="Arial" size="2"><FONT SIZE="2" FACE="Arial"><B>ERROR 7940</B>&nbsp; System databases master, model, msdb, and tempdb cannot be detached.</FONT>
<P><B><FONT FACE="Wingdings" SIZE="6" COLOR="#ff0000">?</FONT></B><FONT COLOR="#008080"> <FONT FACE="Arial">The job would work for user Databases.</FONT></FONT></P><P><B><FONT SIZE="2" FACE="Arial">--REF (BOL) keyword search &quot;detach MSDB&quot;</FONT></B></P>








      79. You are the administrator of a SQL Server 2000 computer. The server 
      contains a database named MedicalRecords. Users query the database using 
      the following stored procedure:

      <p><img border="0" src='./70-228/Images/pic228-79a.gif'></p>
      
      Users report that queries to the database respond slowly. You use System 
      Monitor to measure the system and receive the results shown in the exhibit.

      <br><button onClick="window.open('./70-228/images/pic228-79.gif','Exhibit','height=318,width=491,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



      You need to modify the server to accellerate query response time. What 
      should you do?

      a. Execute sp_recompile on the stored procedure

      b. Replace the stored procedure with a user-defined function

      c. Convert the stored procedure into two procedures, one procedure to 
      decide if the ##ClientVisits table should be populated and one to populate 
      the ##ClientVisits table

      d. Replace the stored procedure with a temporary stored procedure created 
      by the user

ANSWER: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2">The queries used by stored procedures and triggers are optimized only when they are compiled. As indexes or other changes that affect statistics are made to the database, compiled stored procedures and triggers may lose
efficiency. By recompiling stored procedures and triggers that act on a table, you can reoptimize the queries.</FONT></P>
<P CLASS="indent"><!--NOTE-->
<B><FONT SIZE="2" FACE="Arial">--REF (BOL) keyword search &quot;detach sp_recompile&quot;</FONT></B></P>
      
80. You are the administrator of a SQL Server 2000 computer The server contains a database named Sales that has two data files and one transaction log file. Each data file is located on its own hard disk and exists in its own filegroup. You perform full database, differential, and transaction log backups on a regular basis. All backups made during a single week are striped across three disk backup devices. A portion of the header information for the current week's backups is shown in the following table<BR><BR>
<TABLE BORDER="0">
  <TR>
    <TD ALIGN="center" BGCOLOR="#CCCCCC">BackupName</TD>
    <TD ALIGN="center" BGCOLOR="#CCCCCC">&nbsp;BackupType</TD>
    <TD ALIGN="center" BGCOLOR="#CCCCCC">&nbsp;BackupFinishDate </TD>
  </TR>
  <TR>
    <TD>Sales_db_20000625</TD>
    <TD ALIGN="center">1</TD>
    <TD>2000-06-25 21 57 04.000 </TD>
  </TR>
  <TR>
    <TD>Sales_tl_20000626_1</TD>
    <TD ALIGN="center">2 </TD>
    <TD>2000-06-26 11 04 22.000 </TD>
  </TR>
  <TR>
    <TD>Sales_tl_20000626_2</TD>
    <TD ALIGN="center">2</TD>
    <TD>2000-06-26 15 06 33.000 </TD>
  </TR>
  <TR>
    <TD>Sales_df_20000626</TD>
    <TD ALIGN="center">5</TD>
    <TD>2000-06-26 21 15 48.000 </TD>
  </TR>
  <TR>
    <TD>Sales_tl_20000627_1</TD>
    <TD ALIGN="center">2</TD>
    <TD>2000-06-27 11 03 39.000 </TD>
  </TR>
  <TR>
    <TD>Sales_tl_20000627_2</TD>
    <TD ALIGN="center">2</TD>
    <TD>2000-06-27 15 04 59.000 </TD>
  </TR>
  <TR>
    <TD>Sales_df_20000627</TD>
    <TD ALIGN="center">5</TD>
    <TD>2000-06-27 21 31 13.000 </TD>
  </TR>
  <TR>
    <TD>Sales_tl_20000628_1</TD>
    <TD ALIGN="center">2</TD>
    <TD>2000-06-28 11 05 16.000 </TD>
  </TR>
</TABLE><BR><BR>
On June 28, 2000, at 1:47 P M , the hard disk that contains the PRIMARY filegroup fails. You want to recover as much data as possible. What should you do? (Each correct answer presents part of the solution, Choose all that apply) 

a. Backup the transaction log by using the NO_LOG option 

b. Backup the transaction log by using the NO_TRUNCATE option 

c. Restore the most recent full database backup 

d. Restore the most recent differential backup 

e. Restore all differential backups in sequence 

f. Restore all transaction log backups in sequence 

g. Restore all transaction logs since the most recent differential backup 

Answer: B, C, D, G

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">A differential backup creates a copy of all the pages in a database modified after the last database backup. Differential logs are used primarily in heavily used systems where a failed database must be brought back online quickly. Differential backups are smaller than full database backups; therefore, they have less of an effect on the system while they run.
<P><FONT FACE="Arial" SIZE="2">For example, a site executes a full database backup on Sunday night. A set of transaction log backups is made every four hours during the day, with the backups from one day overwriting the backups from the day before. Each
night the site makes a differential backup. If one of the data disks for the database fails at 9:12 A.M. on Thursday, the site can:</FONT>
<OL>
  <LI><FONT FACE="Arial" SIZE="2">Back up the current transaction log.</FONT></LI>
  <LI><FONT FACE="Arial" SIZE="2">Restore the database backup from Sunday night.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Restore the differential backup from Wednesday night to roll the database forward to that point.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Restore the transaction log backups from 4:00 A.M. and 8:00 A.M. to roll the database forward to 8:00 A.M.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Restore the log backup taken after the failure. This will roll the database forward to the time of the failure.</FONT></LI>
</OL>
<P><B><FONT FACE="Wingdings" SIZE="6" COLOR="#ff0000">?</FONT></B><FONT COLOR="#008080"> </FONT><FONT COLOR="#008080"><B><FONT FACE="Arial" SIZE="2">Backup type:</FONT></B> <FONT FACE="Arial" SIZE="2">1 = Database, 2 = Transaction Log, 4 = File, 5 =
Differential Database, 6 = Differential File</FONT></FONT></P>
<P CLASS="indent"><!--NOTE-->
 <B><FONT SIZE="2" FACE="Arial">--REF (BOL) keyword search &quot;</FONT></B><B><FONT FACE="Arial" SIZE="2">Differential Backup and Restore</FONT></B><B><FONT SIZE="2" FACE="Arial">&quot;</FONT></B></P>












81. You are the administrator of three SQL Server 2000 computers at Five Lakes Publishing. One server, FLPSQL01, stores order data. You want to be able to use the other two servers, FLPSQL02 and FLPSQL03, to answer queries and run reports. The planned network configuration is shown in the exhibit. 
<br><BR><button onClick="window.open('./70-228/images/PIC228-81.jpg','Exhibit','height=330,width=563,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>
You want to use the Database Maintenance Plan Wizard to configure log shipping from FLPSQL01 to FLPSQL02 and FLPSQL03. You do not want users to add any new data on FLPSQL02 or FLPSQL03, but they must be able to run queries and reports. Which two actions should you take?(Each correct answer presents part of the solution, Choose two ) 

a. Set the database load state for each destination server to No recovery mode 

b. Set the database load state for each destination server to Standby mode 

c. Enable the Allow database to assume primary role option for both destination servers 

d. Enable the Allow database to assume primary role option for one destination server, and then disable this option for the other destination server 

e. Disable the Allow database to assume primary role option for both destination servers 

Answer: B, E 

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">The Log Shipping feature of SQL Server 2000 allows for a standby system to be created and kept up to date by applying recent transaction logs to the standby
system. The standby system is kept in a permanent recovery mode, continually having transactions logs applied to it. Even though this system is in recovery mode, read-only queries are allowed, thus enabling you to use the standby database for offloading
reporting tasks.</FONT>
<P><FONT FACE="Arial" SIZE="2">Within the wizard, if you want the destination database to be viewable for read-only queries, you must select the Standby Mode option button in the Database Load State group box. The default is the No Recovery Mode option
button.</FONT></P>
<P>&nbsp;<BR>
<button onClick="window.open('./70-228/images/PIC228-81.gif','Exhibit','height=591,width=404,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button></P>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (SAC) ch33, Log Shipping, pg. 925</B></FONT></P>









82. You are the administrator of several SQL Server 2000 computers. You want to retrieve some information from an archived inventory database. You have a full tape backup of the database. The backup's header information shows that the backup uses the SQL_Latin1_General_CP437_BIN collation. However, all existing SQL Server computers in your office are configured to use the SQL_Latin1_General_CP1_CI_AS collation. You do not want to join tables in the inventory database with tables in other databases. You need to restore the inventory database to a SQL Server 2000 computer by using the least amount of administrative effort. What should you do? 

a. Use the rebuildm utility to rebuild the system databases on an existing SQL Server computer Configure all the databases on that server to use the SQL_Latin1_General_CP437_BIN collation. Restore the inventory database to the server 

b. Restore the inventory database to an existing SQL Server computer. Accept the SQL_Latin1_General_CP437_BIN collation for that database. 

c. Install a new named instance of SQL Server 2000 on an existing SQL Server 2000 computer Configure the named instance to use the SQL_Latin1_General_CP437_BIN collation. Restore the inventory database to the named instance. 

d. Install SQL Server 2000 on a new computer. Configure the new server to use the SQL_Latin1_General_CP437_BIN collation. Restore the inventory database to the new server 

Answer: B 

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION:</B></FONT>&nbsp; <FONT FACE="Arial">Compatibility issues can have an impact on organizations that use multiple collations to store their data. Most organizations use the same collation for all of
their Microsoft® SQL Server™ 2000 databases, thereby eliminating all collation compatibility issues. Other organizations, however, must store data viewed by users who speak various languages and want to do so with a minimum of collation compatibility
issues.</FONT>
<P><FONT FACE="Arial">If you restore a database, RESTORE uses the collation of the source database that was recorded in the backup file. The restored database has the same collation as the original database that was backed up. Individual objects within
the database that have different collations also retain their original collation. The database can be restored even if the instance on which you run restore has a different default collation than the instance on which BACKUP was run.</FONT></P>
<FONT FACE="Arial"><B>--REF: (BOL) keyword search &quot;Mixed Collation Environments&quot;</B></FONT>













83. You are the administrator of a SQL Server 2000 database. You import a table of geographic information from a Microsoft Access database into a SQL Server 2000 database. The table has 12,000 rows. Each row averages 5,000 bytes. The table contains lookup data that does not change. You want to minimize the size of the data file and the time required to back up the data. Which two actions should you take?(Each correct answer presents part of the solution, Choose two ) 


a. Create a 60-MB data file named Geography.ndf 

b. Create a 95-MB data file named Geography.ndf 

c. Create a 60-MB data file named Geography.mdf 

d. Create a 95-MB data file named Geography.mdf 

e. Place the table in the PRIMARY filegroup 

f. Place the table in a new filegroup named LOCATION 

Answer: A, F

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">The Primary filegroup contains the primary data file and any other files not placed into another filegroup. All pages for the system tables are allocated from the primary filegroup. A User-defined filegroup is any filegroup specified using the FILEGROUP keyword in a CREATE DATABASE or ALTER DATABASE statement, or on the Properties dialog box within SQL Server Enterprise Manager.<BR><BR>The Primary file group has the .mdf extension. The data base would only need 60-MB (12k*5k). No free space is needed for a read only file. Placing the data file in its own file group minimize the time to bake up the data.<BR><BR><B>--REF: (BOL) keyword search "Creating Filegroups"










84. You are the administrator of a SQL Server 2000 computer. Your company uses the server to store service contract information for its customers. You are also the administrator of an Oracle relational database management system (RDBMS) server. This server is used to store your company's financial information The financial information is updated frequently throughout the day. You need to create a series of reports that combine the service contract information and the financial information. These reports will be updated several times a day. You want to create these reports on the SQL Server computer by using the minimum amount of disk space. What should you do? 

a. Set up SQL Server replication to replicate the data from the Oracle server to the SQL Server computer 

b. Set up the Oracle server as a linked server. Create a view that joins the service contract information and the financial information. 

c. Set up a Data Transformation Services (DTS) package that imports and transforms the data from the Oracle server to the SQL Server computer Use SQL Server Agent to execute the DTS package throughout the day as needed 

d. Set up a Microsoft ActiveX script that connects to the Oracle server and imports the financial information into a SQL Server temporary table Create a view that joins the service contract information and the temporary table 

Answer: B

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION:</B></FONT>&nbsp; <FONT FACE="Arial" SIZE="2">To access data from an OLE DB data source, provide Microsoft® SQL Server™ 2000 with the following information:</FONT>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">The name of the OLE DB provider that exposes the data source.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Any information the OLE DB provider needs to locate the source of the data.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Either the name of an object that the OLE DB data source can expose as a rowset, or a query that can be sent to the OLE DB provider that will cause it to expose a rowset. The objects that can be exposed as rowsets are
    known as remote tables. The queries that generate rowsets are known as pass-through queries.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Optionally, you can supply SQL Server with valid login IDs for the OLE DB data source.</FONT></LI>
</UL>
<P><FONT FACE="Arial" SIZE="2">SQL Server 2000 supports these methods for referencing heterogeneous OLE DB data sources in Transact-SQL statements: the linked server name and the ad hoc computer name.</FONT></P>
<H5><FONT FACE="Arial" SIZE="2">Linked Server Names</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">A linked server is a virtual server that has been defined to Microsoft® SQL Server™ 2000 with all the information needed to access an OLE DB data source. A linked server name is defined using the <B>sp_addlinkedserver</B>
system stored procedure. The linked server definition contains all the information needed to locate the OLE DB data source. Local SQL Server logins are then mapped to logins in the linked server using <B>sp_addlinkedsrvlogin</B>. Remote tables can then be
referenced by using the linked server name:</FONT>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">As the server name in a four-part name used as a table or view reference in a Transact-SQL statement. The other three parts of the name reference an object in the linked server that is exposed as a rowset.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">As an input parameter to an OPENQUERY function. OPENQUERY sends the OLE DB provider a command to execute. The returned rowset can then be used as a table or view reference in a Transact-SQL statement.</FONT></LI>
</UL>
<H5><FONT FACE="Arial" SIZE="2">Accessing Linked Servers</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">After a linked server is created using <B>sp_addlinkedserver</B>, it can be accessed using:</FONT>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">Distributed queries. Accessing tables in the linked server through SELECT, INSERT, UPDATE, and DELETE statements using a linked server-based name.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Remote stored procedures. Stored procedures can be executed against the linked server using a four-part name.</FONT></LI>
</UL>
<P><FONT SIZE="2" FACE="Arial">Servers running an instance of SQL Server can be defined as a remote server using <B>sp_addserver</B>. The remote server then can be referenced in remote stored procedure calls. The remote server component is maintained as a
compatibility feature for existing applications.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">A linked server definition specifies an OLE DB provider and an OLE DB data source.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">An OLE DB provider is a dynamic-link library (DLL) that manages and interacts with a specific data source. An OLE DB data source identifies the specific database accessible through OLE DB. Although data sources queried
through linked server definitions are usually databases, OLE DB providers exist for a wide variety of files and file formats, including text files, spreadsheet data, and the results of full-text content searches. The following table shows examples of the
most common OLE DB providers and data sources for SQL Server.</FONT></P>
<TABLE BORDER="1" CELLPADDING="2" COLS="2" FRAME="box" RULES="all">
  <TBODY>
    <TR VALIGN="top">
      <TH CLASS="label" BGCOLOR="#999999"><FONT FACE="Arial" SIZE="2">OLE DB provider</FONT></TH>
      <TH CLASS="label" BGCOLOR="#999999"><FONT FACE="Arial" SIZE="2">OLE DB data source</FONT></TH>
    </TR>
    <TR VALIGN="top">
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Microsoft OLE DB Provider for SQL Server</FONT></TD>
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Instance of SQL Server (in the form servername\instancename) and database, such as <B>Northwind</B></FONT></TD>
    </TR>
    <TR VALIGN="top">
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Microsoft OLE DB Provider for Jet</FONT></TD>
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Path name of .mdb database file</FONT></TD>
    </TR>
    <TR VALIGN="top">
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Microsoft OLE DB Provider for ODBC</FONT></TD>
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">ODBC data source name (pointing to a particular database)</FONT></TD>
    </TR>
    <TR VALIGN="top">
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Microsoft OLE DB Provider for Oracle</FONT></TD>
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">SQL*Net alias that points to an Oracle database</FONT></TD>
    </TR>
    <TR VALIGN="top">
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Microsoft OLE DB Provider for Indexing Service</FONT></TD>
      <TD BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Content files on which property searches or full-text searches can be run</FONT></TD>
    </TR>
  </TBODY>
</TABLE>
<BR>
<B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;Accessing External Data&quot;, </FONT>&quot;<FONT FACE="Arial" SIZE="2">Configuring Linked Servers&quot;</FONT></B>













85. Your company contains a variety of client computers that will connect to the SQL Server 2000 computer by using a specific Net-Library, as shown in the following table:<BR><BR>
<TABLE BORDER="1" BORDERCOLOR="#CCCCCC">
  <TR>
    <TD ALIGN="center" BGCOLOR="#999999"><B><FONT COLOR="#000000" FACE="Arial">Client-computer</FONT></B></TD>
    <TD ALIGN="center" BGCOLOR="#999999"><B><FONT COLOR="#000000" FACE="Arial">Net-Library</FONT></B></TD>
  </TR>
  <TR>
    <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial">Microsoft Windows 98</FONT></TD>
    <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial">Named Pipes </FONT></TD>
  </TR>
  <TR>
    <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial">Novell NetWare</FONT></TD>
    <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial">&nbsp;IPX/SPX </FONT></TD>
  </TR>
  <TR>
    <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial">Apple Macintosh</FONT></TD>
    <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial">TCP/IP </FONT></TD>
  </TR>
</TABLE><BR><BR>
You need to allow the client computers to connect to the SQL Server computer. You also want to minimize the number of configuration changes required on the client computers. Which three actions should you take?(Each correct answer presents part of the solution, Choose three) 

a. Install SQL Server 2000 as a named instance 

b. Install SQL Server 2000 as the default instance 

c. Configure the new instance for Mixed Mode authentication 

d. Configure the new instance for Windows Authentication 

e. Configure the server to use the Named Pipes, IPX/SPX, and TCP/IP Net-Libraries 

f. Configure the server to use the Multiprotocol Net-Library 

Answer: B, C, E

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">The default net-librarys installed on the server is TCP/IP and Named Pipes. All you'd need to add is IPX/SPX on the server.<P><FONT FACE="Arial" SIZE="2">By default, clients running on the Microsoft® Windows NT® 4.0, Microsoft Windows® 2000, Windows 95, or Windows 98 operating system use the client TCP/IP protocol. You may need to connect using an alternate Net-Library if: You need to add a specific client configuration for communicating with a specific server.The server with which you want to communicate is configured to listen on another port. In either case, you must create a configuration entry on the client.Windows 98 and Windows 95 do support the client functions for Multiprotocol encryption, so SQL Server clients running on Windows 98 and Windows 95 computers can connect to instances of SQL Server on Windows NT or Windows 2000 computers using Multiprotocol encryption.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="3">The Multiprotocol selection has two key features:</FONT></B></P>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">Automatic selection of an available network protocol to communicate with an instance of Microsoft® SQL Server™.</FONT>
    <P CLASS="tl"><FONT FACE="Arial" SIZE="2">This is convenient when you want to connect to multiple servers running different network protocols but do not want to reconfigure the client connection for each server. If the client and server Net-Libraries
    for TCP/IP Sockets, NWLink IPX/SPX, or Named Pipes are installed on the client and server, the Multiprotocol Net-Library will automatically choose the first available network protocol to establish a connection.</FONT></P>
  <LI><FONT FACE="Arial" SIZE="2">Client encryption.</FONT>
    <P CLASS="tl"><FONT FACE="Arial" SIZE="2">You can enforce encryption over the Multiprotocol Net-Library on clients running on the Microsoft Windows NT® 4.0, Windows® 2000, Windows 95, or Windows 98 operating system to prevent others from
    intercepting and viewing sensitive data.</FONT></P>
  </LI>
</UL>
<P><FONT FACE="Arial" SIZE="2">The Multiprotocol Net-Library takes advantage of the remote procedure call (RPC) facility of Windows NT 4.0 and Windows 2000, which provides Windows Authentication. For the Multiprotocol Net-Library, clients determine the
server address using the server name.</FONT></P>
<H5><FONT FACE="Arial" SIZE="2">Usage Considerations</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">Before using the Multiprotocol Net-Library, consider the following:</FONT>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">The<FONT COLOR="#FF0000"> Multiprotocol Net-Library does not support named instances of SQL Server 2000.</FONT> You can use the Multiprotocol Net-Library to connect to the default instance of SQL Server on a computer, but
    you cannot connect to any named instances.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">The Multiprotocol Net-Library does not support server enumeration. From applications that can list servers by calling <B>dbserverenum</B>, you cannot identify servers running an instance of SQL Server and listening on the
    Multiprotocol Net-Library.</FONT></LI>
</UL>
<H5><FONT FACE="Arial" SIZE="2">Multiprotocol Name Resolution</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">Using the RPC run time, which is called by the Multiprotocol Net-Library, clients can connect to servers using a variety of other protocols. When establishing a connection, the Multiprotocol Net-Library passes the computer
name to the RPC run time, which determines the available network protocols and attempts to use each one until a connection is established. Only NWLink IPX/SPX, TCP/IP Sockets, and Named Pipes are tested and supported.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">To accomplish the computer name to node connection, the RPC run time uses a naming service compatible with the network protocol used (WINS for TCP/IP, SAP for NWLink IPX/SPX, and Net BIOS broadcasts for Named Pipes). Only
the computer name should be specified, because a local RPC database is used to resolve the names over the supported protocols.</FONT></P>
<H5><FONT FACE="Arial" SIZE="2">Client Encryption</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">You can enforce encryption over the Multiprotocol Net-Library on a per-client basis. Only this client's communications are encrypted. Other clients using the Multiprotocol Net-Library that do not have this parameter set do
not use encryption.</FONT></P>
<H5><FONT FACE="Arial" SIZE="2">Default Net-Library Settings</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">All Net-Libraries are installed by the Setup program. The table shows the default server and client Net-Library settings by operating system.</FONT></P>
<TABLE BORDER="1" CELLPADDING="2" COLS="3" FRAME="box" RULES="all">
  <TBODY>
    <TR VALIGN="top">
      <TH CLASS="label" ALIGN="center" BGCOLOR="#999999"><FONT FACE="Arial" SIZE="2">Operating system</FONT></TH>
      <TH CLASS="label" ALIGN="center" BGCOLOR="#999999"><FONT FACE="Arial" SIZE="2">Server Net-Library settings</FONT></TH>
      <TH CLASS="label" ALIGN="center" BGCOLOR="#999999"><FONT FACE="Arial" SIZE="2">Client Net-Library settings</FONT></TH>
    </TR>
    <TR VALIGN="top">
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2" COLOR="#FF0000">Windows 98</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">TCP/IP Sockets, Shared Memory</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2" COLOR="#FF0000">TCP/IP Sockets</FONT></TD>
    </TR>
    <TR VALIGN="top">
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Windows 95</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Not applicable</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">TCP/IP Sockets</FONT></TD>
    </TR>
    <TR VALIGN="top">
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Windows NT 4.0 (Server and Workstation)</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">TCP/IP Sockets, Shared Memory, Named Pipes</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">TCP/IP Sockets, Named Pipes</FONT></TD>
    </TR>
    <TR VALIGN="top">
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">Windows 2000 (all versions)</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">TCP/IP Sockets, Shared Memory, Named Pipes</FONT></TD>
      <TD ALIGN="center" BGCOLOR="#CCCCCC"><FONT FACE="Arial" SIZE="2">TCP/IP Sockets, Named Pipes</FONT></TD>
    </TR>
  </TBODY>
</TABLE>
<DIV ID="popUpWindow" STYLE="BACKGROUND-COLOR: #ffffcc; BORDER-BOTTOM: #333333 1px solid; BORDER-LEFT: #333333 1px solid; BORDER-RIGHT: #333333 1px solid; BORDER-TOP: #333333 1px solid; LEFT: 0px; PADDING-BOTTOM: 10px; PADDING-LEFT: 10px; PADDING-RIGHT: 10px; PADDING-TOP: 10px; POSITION: absolute; TOP: 0px; VISIBILITY: hidden; WIDTH: 200px; Z-INDEX: 2">
</DIV>
<DIV ID="RelpopUpWindow" STYLE="BACKGROUND-COLOR: #ffffcc; BORDER-BOTTOM: #333333 1px solid; BORDER-LEFT: #333333 1px solid; BORDER-RIGHT: #333333 1px solid; BORDER-TOP: #333333 1px solid; LEFT: 0px; PADDING-BOTTOM: 10px; PADDING-LEFT: 10px; PADDING-RIGHT: 10px; PADDING-TOP: 10px; POSITION: absolute; TOP: 0px; VISIBILITY: hidden; WIDTH: 200px; Z-INDEX: 2">
</DIV>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search, &quot;Multiprotocol Clients&quot;, &quot;Network Libraries&quot;, &quot;Configuring a Client&quot;</B></FONT></P>










86. You are the administrator of a SQL Server 2000 computer. Each evening after business hours, you perform database maintenance tasks. You create a Data Transformation Services (DTS) package to populate the data warehouse. MAPI is not installed on the server. You want to schedule the DTS package to run each night. You want to attend to other duties while the DTS package is executing. You also want to be notified if the DTS package fails. What should you do? 

a. Select the DTS package's Log package execution to SQL Server check box. Create a SQL Server event alert to notify you if the package fails 

b. Select the DTS package's Write completion status to event log check box. Create a SQL Server event alert to notify you if the package fails. 

c. Configure the DTS package to include an On Failure precedence constraint and a Send Mail task Configure the Send Mail task to notify you if the package fails. 

d. Configure the DTS package to include an On Failure precedence constraint and an Execute Process task. Configure the Execute Process task to execute a net send command that will notify you if the package fails. 

Answer: D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">With the Execute Process task, you can run an executable program or batch file as part of a Data Transformation Services (DTS) package. Although you can use
the Execute Process task to open any standard application such as Microsoft® Excel or Microsoft Word, more often you use it to run business applications or batch files that work against a data source.</FONT>
<P><FONT FACE="Arial" SIZE="2"><B>Write completion status to event log</B>:</FONT> <FONT FACE="Arial" SIZE="2">Includes a completion status of package execution in the Microsoft® Windows® application log.</FONT></P>
<P><B><FONT FACE="Wingdings" SIZE="6" COLOR="#FF0000">?</FONT><FONT FACE="Arial" COLOR="#FF0000" SIZE="2"> </FONT><FONT FACE="Arial" SIZE="2" COLOR="#008080">You can create a batch file: NET SEND ServerName 'Your DTS package has failed to complete.'</FONT></B></P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Execute Process Task&quot; </B></FONT>

87. You are the administrator of a SQL Server 2000 computer. One of the databases on the server contains a table named Complaints. This table is used to store information about customer complaints. The customer service representatives in your company add and edit the information in the Complaints table. They work with this table by using a number of client applications, including a Web-based application and a Microsoft Windows 32-bit application. The customer service manager discovers that some customer complaints are marked as closed before they are resolved to the customer's satisfaction. You need to notify the customer service manager whenever a complaint is marked as closed. You do not want to make any changes to the client applications. What should you do? 

a. Create an UPDATE trigger that sends an e-mail message 

b. Create a stored procedure that sends an e-mail message Use the stored procedure to make changes to the data 

c. Create a user-defined function that sends an e-mail message Use the function to make changes to the data 

d. Create a rule that validates data entry 

e. Bind the rule to the ComplaintClosed column 

Answer: A

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT>
<P><FONT FACE="Arial" SIZE="2">This example sends an e-mail message to a specified person (MaryM) when the <B>Complaints</B> table changes.</FONT></P>
<PRE><CODE><FONT FACE="Arial" SIZE="2"><FONT COLOR="#0000FF">CREATE TRIGGER</FONT> reminder
<FONT COLOR="#0000FF">ON</FONT> complaints
<FONT COLOR="#0000FF">FOR UPDATE
AS
        IF UPDATE</FONT> (ComplaintClosed)
 <FONT COLOR="#0000FF">  EXEC</FONT> master..<FONT COLOR="#800000">xp_sendmail</FONT> <FONT COLOR="#FF0000">'MaryM'</FONT>, 
     <FONT COLOR="#FF0000"> 'A complaint has been marked as closed on the complaints table.'</FONT>
GO</FONT></CODE></PRE>
<FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Create trigger&quot;</B></FONT>

88. You are the administrator of a SQL Server 2000 computer The server is configured for Windows Authentication You add an integrated login for the Domain Users group However, 20 of the users in the Domain Users group should not have access to the server. You need to prevent the unauthorized users from accessing the server You need to accomplish this goal by making the least number of changes to the server. What should you do? 

a. Add a single SQL Server login for the unauthorized users, and then deny access to the login 

b. Add the unauthorized users to a domain user group, add a login for the group, and then deny access to the login 

c. Add a login for each unauthorized user, and then deny access to each login 

d. Remove each unauthorized user from the Domain Users group 

Answer: B

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT>
<P><B><FONT FACE="Arial" COLOR="black" SIZE="2">DENY</FONT></B><FONT SIZE="3" FACE="Arial" COLOR="black"><B> </B></FONT><FONT COLOR="black" SIZE="2" FACE="Arial">Creates an entry in the security system that denies a permission from a security account in
the current database and prevents the security account from inheriting the permission through its group or role memberships.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">When a permission is denied from a SQL Server user or Windows NT user account, the specified <I>security_account</I> is the only account affected by the permission. If a permission is denied from a SQL Server role or a
Windows NT group, the permission affects all users in the current database who are members of the group or role, regardless of the permissions that have been granted to the members of the group or role. If there are permission conflicts between a group or
role and its members, the most restrictive permission (DENY) takes precedence.<BR><BR>Next, grant login access to the Windows users that will need access to SQL Server 2000. Consider creating and granting login access to one Windows 2000 group that will contain all Windows 2000 users requiring access to SQL Server 2000. Also consider creating a second Windows 2000 group that will contain all users that are specifically denied access to SQL Server 2000. Create a login for this Windows 2000 group and specifically deny login access to any members of this group. Using only these two groups will allow you to quickly grant or deny any Windows user access to SQL Server 2000. </FONT></P>
<P><FONT FACE="Arial" COLOR="black"><B>--REF: (BOL) keyword search &quot;DENY&quot;<BR>--REF: (Sys Admin) ch11, Lesson 3: Designing an Access and Permissions Strategy, pg. 355</B></FONT></P>












89. You are the administrator of a SQL Server 2000 computer. Your company has 150 client computers that are running UNIX. These client computers require access to the server to use a database named Techlnfo. The server is configured with the TCP/IP and Named Pipes Net-Libraries. You need to configure the server to allow the client computers to use the Techlnfo database. You also want to minimize the amount of time it takes to configure the server and allow for the tracking of individual user actions. Which two actions should you take?(Each correct answer presents part of the solution. Choose two ) 

a. Configure Windows Authentication 

b. Configure Mixed Mode authentication 

c. Create a SQL Server login for each user 

d. Create a domain user group login for all of the users 

e. Create a single SQL Server login for all of the users 

f. Enable the Multiprotocol Net-Library 

g. Disable the Named Pipes Net-Library 

Answer: B, C

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION:</B></FONT> <FONT FACE="Arial" SIZE="2">When SQL Server 2000 is running in Mixed Mode, a user can connect to a SQL Server 2000 instance using either Windows authentication or SQL Server
authentication. Using this mode is required for users connecting directly to SQL Server 2000 from Novell NetWare, Apple Macintosh, Banyan Vines, UNIX, and Linux clients. However, using Mixed Mode is inherently less secure than using Windows Authentication Mode, and you should only use it when absolutely necessary.</FONT> <P>&nbsp;<B><FONT FACE="Wingdings" SIZE="6" COLOR="#ff0000">?</FONT></B><FONT FACE="Arial" COLOR="#ff0000" SIZE="2"> </FONT><FONT FACE="Arial" SIZE="2" COLOR="#008080">letting 150 clients log on to SQL server with one user account would be like adding them to the guest account. Security audits would see all as one user.</FONT></P> <P><FONT FACE="Arial" SIZE="2"><B>--REF: (Sys Admen) ch10, <A ID="uid-B8944C0C-DB06-DC5F-D0F5-8C09749A44DD">Lesson 1: Understanding the Authentication Process</A>, pg. 290</B> </FONT></P>













90. You are the administrator of a SQL Server 2000 computer. The server contains a database named FinanceData that is used by a client/server application. Each employee has a SQL Server login that the application uses to access the server. Your company hires a new employee named Andrew. You create a SQL Server login named Andrew. You also create a database user named Andrew in the database and grant the database user full permissions in the database. Whenever Andrew runs the client/server application, he receives the following error message "Invalid object name " Andrew also reports that he cannot access the database by using the application. You need to ensure that Andrew can use the application. Which Transact-SQL statement should you execute? 

a. EXEC sp_grantdbaccess 'FinanceData','Andrew' 
GO 
sp_addrolemember 'db_datareader', 'Andrew' 

b. GRANT ALL ON FinanceData TO Andrew 

c. EXEC sp_defaultdb 'Andrew','FinanceData' 

d. EXEC sp_addlogin 'Andrew' 

Answer: C

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION:</B></FONT>&nbsp; <FONT SIZE="2" FACE="Arial">When a client connects with SQL Server, the default database defined for its login becomes the current database without an explicit USE statement. The
default database can be defined when the login is added with <B>sp_addlogin</B>. When executing <B>sp_addlogin </B>the <B>master</B> database is the default database if a database is not specified.</FONT>
<P><FONT FACE="Arial" SIZE="2">It is recommended that <B>sp_defaultdb</B> be used to change the default database for all logins other than members of the <B>sysadmin</B> fixed server role. This prevents users from inadvertently trying to use or create
objects in the <B>master</B> database.</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot; sp_defaultdb &quot;</B></FONT></P>











91. You are the administrator of a SQL Server 2000 computer named CorpSql. The server is a member of a Microsoft Windows NT domain named CORPDOMAIN. CorpSql is configured for Windows Authentication and contains three databases named Sales, Finance, and Research. Sophie is an administrative assistant in your company. She uses a suite of client/server applications to access all three databases on CorpSql. Sophie transfers to a different department within the company and requires access only to the Research database. Her former manager requests that you remove Sophie's access to the Sales and Finance databases. You need to configure the appropriate permissions for Sophie. Which batch of Transact-SQL statements should you execute? 

a. USE Finance<BR>GO<BR>EXEC sp_revokedbaccess Sophie<BR>USE Sales<BR>GO<BR>EXEC sp_revokedbaccess Sophie 

b.USE Finance<BR>GO<BR>EXEC sp_addrolemember ' db_denydatareader ', 'Sophie'<BR>USE Sales<BR>GO<BR>EXEC sp_addrolemember ' db_denydatareader ', 'Sophie' 

c.USE Master<BR>GO<BR>EXEC sp_droplogin 'CORPDOMAIN' 'Sophie'<BR>GO 

d.USE Finance<BR>GO<BR>EXEC sp_denylogin 'Sophie'<BR>USE Sales<BR>GO<BR>EXEC sp grantlogin 'Sophie' 

Answer: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">When the account is removed, the permissions and aliases that depend on the account are automatically removed. You can only remove accounts in the current database using sp_revokedbaccess.<BR><BR><B>--REF: (BOL) "sp_revokedbaccess"</B></FONT>











92. You are the administrator of a SQL Server 2000 computer. You configure a set of alerts on the server to notify you whenever certain operations fail or encounter errors The notifications are sent to your Microsoft Windows 2000 Professional computer by using the net send command. You successfully test the alerts. After several days, however, you stop receiving notifications when operations fail or encounter an error. You verify that the service is started. You need to make sure that you continue to receive alert notifications. What should you do? 

a. Stop and restart the SQLServerAgent service 

b. Clear the application log on the SQL Server computer 

c. Clear the system log on your Windows 2000 Professional computer 

d. Install the SQL Server 2000 administrative tools on your Windows 2000 Professional computer 

Answer: B

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION:</B></FONT>&nbsp; 
<H5><FONT FACE="Arial" SIZE="2">This error appears in the SQLServerAgent error log on Windows 95 or Windows 98 servers: &quot;The common event system is being restarted after function ProduceEventsFromSS returned error 44, 'Unable To Connect'&quot;</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">This may indicate incorrect registered server information. Ensure that the registered server information for the local server is correct and that the registered login name is a member of the <B>sysadmin </B>fixed server
role.</FONT></P>
<H5><FONT FACE="Arial" SIZE="2">The Windows 2000 or Windows NT application log fills rapidly with the same error.</FONT></H5>
<P><FONT FACE="Arial" SIZE="2">Because SQL Server Agent both depends on and monitors SQL Server, SQL Server Agent can become caught in an endless loop of firing the same alert. This generally occurs when SQL Server runs out of an essential global resource
and an alert has been defined on this event.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">When the number of alerts raised exceeds the SQL Server Agent alert processing rate, a backlog is created.</FONT> <FONT FACE="Arial" SIZE="2">Clear the Windows NT application log if: the backlog is not clearing, you do not
want to wait for SQL Server Agent to clear the backlog, or you want an empty, unpopulated Windows NT application log.</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Troubleshooting Alerts &quot;</B></FONT></P>










93. You are the administrator of a SQL Server 2000 computer. You create a job that performs several maintenance tasks on the server's databases. You want the job to run whenever the server's processor utilization falls below 5 percent. You create a new schedule for the job and specify the Start whenever the CPU(s) become idle option. After several days, you notice that the job has never executed although the server's processor utilization has fallen below 5 percent several times. What should you do? 

a. Modify SQL Server Agent properties and specify a smaller idle time 

b. Modify SQL Server Agent properties and specify a larger idle time 

c. Write a stored procedure that executes the job whenever the @@IDLE system variable is less than 5 

d. Write a stored procedure that executes the job whenever the @@IDLE system variable is greater than 1 

Answer: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">
<P><B><FONT FACE="Arial" SIZE="3" COLOR="#008080">SQL Server Agent Properties (Advanced Tab)</FONT></B></P>
<P><FONT FACE="Arial" SIZE="2">Use this tab to view or specify the following options.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">Average CPU usage falls below</FONT></B></P>
<P CLASS="indent"><FONT FACE="Arial" SIZE="2">Specify the idle CPU condition by percentage. Idle is when the average CPU usage remains below the selected percent for the specified number of seconds.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">And remains below this level for</FONT></B></P>
<P CLASS="indent"><FONT FACE="Arial" SIZE="2">Specify the idle CPU condition by seconds. Idle is when the average CPU usage remains below the selected percentage for the specified number of seconds.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;</FONT></B><FONT FACE="Arial" SIZE="2"><B>SQL Server Agent Properties (Advanced Tab)</B></FONT><B><FONT FACE="Arial" SIZE="2"> &quot;</FONT></B></P>












94. You are the administrator of a Microsoft Windows NT Server 4 0 computer The server is the PDC in your domain and also runs SQL Server 2000. The server has four processors and 1 GB of RAM. Your network consists of 500 client computers that are running Microsoft Windows Millennium Edition. Users report that when they log on in the morning their computers respond slowly and occasionally return error messages. You use System Monitor to monitor processor performance and RAM utilization You discover that the % Total Time and % User Time counters average 90 percent and the % Privileged Time counter averages 20 percent. The Available Mbytes counter averages 800 MB. You need to improve server performance for user logons. What should you do? 

a. Increase the physical RAM on the computer to 2 GB 

b. Increase the virtual RAM on the computer to 4 GB 

c. Configure SQL Server to use only processors 1,2, and 3 

d. Configure SQL Server to use only processors 0, 1, and 2 

Answer: C

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><B><FONT FACE="Arial" SIZE="3" COLOR="#008080">SQL Server Properties (Processor Tab)</FONT></B></P>
<P><FONT SIZE="2" FACE="Arial">Use this tab to view or specify the following options.</FONT></P>
<P><B><FONT SIZE="2" FACE="Arial">Processor</FONT></B></P>
<P CLASS="indent"><FONT SIZE="2" FACE="Arial">Specify the processor you want the instance of Microsoft® SQL Server™ to use.</FONT></P>
<P CLASS="indent"><B><FONT FACE="Wingdings" SIZE="6" COLOR="#FF0000">?</FONT><FONT FACE="Arial" COLOR="#FF0000" SIZE="2"> </FONT><FONT FACE="Arial" SIZE="2" COLOR="#008080">The OS would be using processor 0</FONT></B></P>
<P><B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;</FONT></B><B><FONT SIZE="2" FACE="Arial">SQL Server Properties (Processor Tab)</FONT></B><B><FONT FACE="Arial" SIZE="2">&quot;</FONT></B></P>












95. You have been hired as an administrator of an SQL Server 2000 computer. The server contains a database named sales. You have been assigned the task of changing the way customer IDs appear in the Customers table. The database is organized as follows: 
<P ALIGN="center"><img src="./70-228/images/PIC228-95.jpg"></P>
You need to automate the process of updating the primary key tools. You also want to minimize record locks and administration within the database during the update process. What should you do? 

a. Add an ON UPDATE CASCADE constraint to the CustomerID field in the Customers table. Modify the values in the CustomerID field in the Customers table. 

b. Create a duplicate record that has a new CustomerID value. Update the foreign key fields in the invoices, contacts, and quotes tables with the new value. 

c. Disable the FOREIGN KEY constraints. Within a transaction, modify the values in the CustomerID field in the Customers table and all related foreign key values in the invoices, contacts, and quotes tables. Re-enable the FOREIGN KEY constraints after the keys are changed. 

d. Create a data transformation services package. Use the package to transform the CustomerID value and the values of the related foreign keys in the invoices, contacts, and quotes tables. 

Answer: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2">Cascading referential integrity constraints allow you to define the actions Microsoft® SQL Server™ 2000 takes when a user attempts to delete or update a key to which existing foreign keys point.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">The REFERENCES clauses of the CREATE TABLE and ALTER TABLE statements support ON DELETE and ON UPDATE clauses:</FONT>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">[ ON DELETE { CASCADE | NO ACTION } ]<BR>
    <BR>
    </FONT>
  <LI><FONT FACE="Arial" SIZE="2">[ ON UPDATE { CASCADE | NO ACTION } ]</FONT></LI>
</UL>
<P><FONT FACE="Arial" SIZE="2">CASCADE allows deletions or updates of key values to cascade through the tables defined to have foreign key relationships that can be traced back to the table on which the modification is performed. CASCADE cannot be
specified for any foreign keys or primary keys that have a <B>timestamp</B> column.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">ON UPDATE CASCADE</FONT></P>
<P CLASS="indent"><FONT FACE="Arial" SIZE="2">Specifies that if an attempt is made to update a key value in a row, where the key value is referenced by foreign keys in existing rows in other tables, all of the foreign key values are also updated to the
new value specified for the key. If cascading referential actions have also been defined on the target tables, the specified cascading actions are also taken for the key values updated in those tables.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">Examples of cascading referential actions can be based on the <B>FK_Products_Suppliers</B> constraint on the <B>Products</B> table in <B>Northwind</B>. This constraint establishes a foreign key relationship from the <B>SupplierID</B>
column in the <B>Products</B> table to the <B>SupplierID</B> primary key column in the <B>Suppliers</B> table. If ON DELETE CASCADE is specified for the constraint, deleting the row in <B>Suppliers</B> where <B>SupplierID</B> equals 1 also deletes the
three rows in <B>Products</B> where <B>SupplierID</B> equals 1. If ON UPDATE CASCADE is specified for the constraint, updating the <B>SupplierID</B> value in the <B>Suppliers</B> table from 1 through 55 also updates the <B>SupplierID</B> values in the
three rows in <B>Products</B> whose <B>SupplierID</B> values currently equal 1.</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Cascading referential integrity constraints&quot;</B></FONT></P>










96. You have been hired as an administrator of an SQL Server 2000 computer that contains a database named Finances. The database contains 2GB of data and is stored on a 10GB hard drive. You need to import data into the database without adversely affecting database performance. The data will require an additional 2GB of storage space. What should you do? 

a. Add another data file on drive E, and then add the file to the PRIMARY filegroup. 

b. Move the transaction log file to drive E, and set the file growth of Acc_Data.mdf by selecting the Unrestricted file growth option. 

c. Rebuild all clustered indexes so that they have a fill factor of 100. 

d. Compress drive d. 

Answer: A

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><FONT FACE="Arial" SIZE="2"><P><FONT FACE="Arial" SIZE="2">When using SQL Server Enterprise Manager for database creation, database data files are created so that file growth occurs in fixed size chunks. By default, a database file created using SQL-DMO exhibits percentage growth
behavior. Databases do not need secondary data files if the primary file is large enough to hold all the data in the database.</FONT>
<P><FONT FACE="Arial" SIZE="2">After database creation, additional data files can be created and added to either the PRIMARY filegroup or to filegroups added to the database.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">Filegroups use a proportional fill strategy across all the files within each filegroup. As data is written to the filegroup, Microsoft® SQL Server™ 2000 writes an amount proportional to the free space in the file to each
file within the filegroup, rather than writing all the data to the first file until full, and then writing to the next file. For example, if file <B>f1</B> has 100 megabytes (MB) free and file <B>f2</B> has 200 MB free, one extent is allocated from file <B>f1</B>,
two extents from file <B>f2</B>, and so on. This way both files become full at about the same time, and simple striping is achieved.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">As soon as all the files in a filegroup are full, SQL Server automatically expands one file at a time in a round-robin fashion to accommodate more data (provided that the database is set to grow automatically). For example,
a filegroup comprises three files, all set to automatically grow. When space in all files in the filegroup is exhausted, only the first file is expanded. When the first file is full, and no more data can be written to the filegroup, the second file is
expanded. When the second file is full, and no more data can be written to the filegroup, the third file is expanded. If the third file becomes full, and no more data can be written to the filegroup, the first file is expanded again, and so on.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">Using files and filegroups improves database performance by allowing a database to be created across multiple disks. For example, if your computer has four disks, you can create a database that comprises three data files and
one log file, with one file on each disk. As data is accessed, four read/write heads can simultaneously access the data in parallel, which speeds up database operations.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">To maximize performance, create files or filegroups on as many different available local physical disks as possible, and place objects that compete heavily for space in different filegroups.<BR>
</FONT></P>
<P><B><FONT SIZE="2" FACE="Arial">--REF: (BOL) keyword search &quot;Creating a Database&quot;, &quot;Using Files and Filegroups&quot;</FONT></B></P>













97. You have been hired as an administrator of an SQL Server 2000 computer. The server belongs to a Microsoft Windows NT domain named AdSales1. The server contains a database named SalesData. A user named Sandra is a sales representative who uses the database. You have created a login named AdSales1\Sandra and manually configure the permissions necessary for her to perform her job. Sandra has been temporarily reassigned to the marketing department. Sandra must not be able to access the server while working in the marketing department. You must restore her access when she returns to the sales department. You need to configure the appropriate database permissions for Sandra. Which Transact-SQL statement should you execute? 

a. REVOKE ALL TO SalesData FROM 'Sandra' 

b. EXEC sp_revokeaccess 'Sandra' 

c. EXEC sp_denylogin 'Sandra' 

d. EXEC sp_droplogin 'Sandra' 

Answer: C

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">When a Microsoft® Windows NT® 4.0 or Windows® 2000 user belongs to a Windows NT 4.0 or Windows 2000 group that has a login account in Microsoft SQL Server™, the user is allowed to connect through the group login. However, there may be times when such users or groups need to be prevented from connecting to an instance of SQL Server. You can deny login access to any Windows NT 4.0 or Windows 2000 user or group. Users cannot connect to an instance of SQL Server if their user account, or any group in which they are a member, has been denied login access.<BR><BR><B>--REF: (BOL) keyword search "Denying Login Access to Windows Accounts"</B></FONT>















99. You are the administrator of several SQL Server 2000 computers. A data Transformation Services (DTS) package uses native OLE DB providers to transfer data between the servers. Connection details for the servers are specified in .udl files. The .udl files are frequently updated as connection details change. 

You want to distribute the DTS package as a file to developers in your company. You want to make sure connection details are available to developers who receive the DTS package. Which two tasks should you perform? (Each correct answer presents part of the solution. Choose two) 

a. Enable the Always read properties from UDL file option in the Connection Properties dialog box. 

b. Disable the Always read properties from UDL file option in the Connection Properties dialog box. 

c. Delete the .udl files and store connection details in the registry by using system data source names. 

d. Delete the .udl files, and store connection details in the registry by using user data source names. 

e. Make the .udl files available on a network share. 

Answer: A, E 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2">&nbsp;A <B>Data link connection </B>is an intermediate file (.UDL file) that stores a connection string to create an OLE DB connection that is resolved at run time. The data link connection allows you to encapsulate the
connection properties into a separate .UDL data link file. You can then edit the connection string in the data link file (from one data source to another) without changing the SQL Server 2000 DTS package</FONT></P>
<P><B><FONT COLOR="#008080" FACE="Arial" SIZE="3">Connection Properties</FONT></B></P>
<B><FONT FACE="Arial" SIZE="2">Always read properties from UDL file</FONT></B>
<P CLASS="indent"><FONT FACE="Arial" SIZE="2">Specify that the package search for and read the connection string from the specified data link (.udl) file each time the package is executed. Changes made to the data link file between different executions of
the package will be incorporated on the next run. If you select this check box, the .udl file must be deployed with the package so the package can find it and read from it. If you do not select this check box, the connection string is copied from the .udl
into the package, and the file is not referenced again. Connection changes then can be modified only by editing the DTS package directly.</FONT></P>
<P CLASS="indent"><B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;data link connection&quot;</FONT></B></P>











100. On the server, you create a new database named EmployeeData. The EmployeeData database will store confidential information about company employees. You need to allow only authenticated users to access the EmployeeData database. Which Transact SQL statement should you execute? 

a. EXEC sp_revokelogin guest 

b. EXEC sp_droplogin guest 

c. EXEC sp_revokedbaccess guest 

d. EXEC sp_addrolereader db_denydatareader, guest 

Answer: C

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">The security model uses DENY in addition to GRANT and REVOKE. REVOKE has changed to remove a previously granted or denied permission. DENY creates an entry in the security system that denies a permission from a security account and prevents the user, group, or role from inheriting the permission through its group and role memberships. The REVOKE statement can no longer be used to deny permission to a user whose group has permission. Use the DENY statement to deny permissions explicitly to a specific user or group.</FONT> <P><FONT FACE="Arial" SIZE="2">When the account is removed, the permissions and aliases that depend on the account are automatically removed.</FONT></P><P><FONT FACE="Arial" SIZE="2">You can only remove accounts in the current database using <B>sp_revokedbaccess</B>. To add an account in the database, use <B>sp_grantdbaccess</B>. To remove a SQL Server role, use <B>sp_droprole</B>. When removing an account that owns objects in the current database, you must either remove the object, or change the owner of the object using <B>sp_changeobjectowner</B>, before executing<B> sp_revokedbaccess</B>.</FONT></P><P><FONT FACE="Arial" SIZE="2"><BR><B>--REF: (BOL) keyword search &quot;Security (Level 2)&quot;, &quot;</B></FONT><FONT FACE="Arial" SIZE="2"><B>sp_revokedbaccess&quot;</B></FONT></P>















101. You are the administrator of a SQL Server 2000 computer. You configure SQL Server to perform auditing. Audit logs are saved in the C:\MSSQL\Audit folder. The server functions normally for several days, but then the MSSQL Server Service shuts down without warning. 

You cannot restart the service. You need to restart the MSSQL Server service. What should you do? 

a. Set the SQLServerAgent services startup method to disabled. 
Start the MSSQLServer service. 

b. Start the MSSQLServer service manually by using the s startup option. 

c. Start the MSSQLServer service manually by using the m startup option. 

d. Delete the audit logs from the C:\MSSQL\Audit folder. 
Start the MSSQLServer service. 

Answer: D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">When the audit log file reaches 200 MB, a new file will be created and the old file handle will be closed. If the directory fills up (for example, if the disk quota for the user of the service account has filled up or the disk is full), then the instance of Microsoft® SQL Server™ is stopped. The system administrator needs to either free up disk space for the audit log before restarting the instance of SQL Server or restart the instance of SQL Server (if auditing is not configured to start automatically). <BR><BR><B>-s </B>Allows you to start a named instance of SQL Server 2000.<BR><BR><B>-m </B>Starts an instance of SQL Server in single-user mode.<BR><BR><B>--REF: (BOL) keyword search "Using Startup Options", "Using Audit Logs"</B></FONT>

102. You are the administrator of a SQL Server 2000 computer that contains a database. Users report that the database responds slowly when they insert data. You use System Monitor to examine the servers performance and receive the results shown below: 

<p><DIV ALIGN="center">
  <CENTER>
  <TABLE BORDER="0" WIDTH="311" HEIGHT="131" BORDERCOLOR="#C0C0C0" CELLSPACING="0" CELLPADDING="0" BORDERCOLORLIGHT="#C0C0C0" BORDERCOLORDARK="#C0C0C0" BGCOLOR="#C0C0C0">
    <TR>
      <TD WIDTH="90" HEIGHT="18"><B><FONT SIZE="2" FACE="MS Sans Serif">Memory</FONT></B></TD>
      <TD WIDTH="73" HEIGHT="18">&nbsp;</TD>
      <TD WIDTH="22" HEIGHT="18">&nbsp;</TD>
    </TR>
    <TR>
      <TD WIDTH="163" COLSPAN="2" HEIGHT="11" VALIGN="top"><B><FONT SIZE="2" FACE="MS Sans Serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Pages/sec</FONT></B></TD>
      <TD WIDTH="22" HEIGHT="11"><FONT SIZE="2" FACE="MS Sans Serif">244.443</FONT></TD>
    </TR>
    <TR>
      <TD WIDTH="90" HEIGHT="18">&nbsp;</TD>
      <TD WIDTH="73" HEIGHT="18">&nbsp;</TD>
      <TD WIDTH="22" HEIGHT="18">&nbsp;</TD>
    </TR>
    <TR>
      <TD WIDTH="90" HEIGHT="18"><B><FONT SIZE="2" FACE="MS Sans Serif">PhysicalDisk</FONT></B></TD>
      <TD WIDTH="73" HEIGHT="18">&nbsp;</TD>
      <TD WIDTH="22" HEIGHT="18"><B><FONT SIZE="2" FACE="MS Sans Serif">_Total</FONT></B></TD>
    </TR>
    <TR>
      <TD WIDTH="163" HEIGHT="8" BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" BORDERCOLORLIGHT="#C0C0C0" BORDERCOLORDARK="#C0C0C0" VALIGN="top"><B><FONT SIZE="2" FACE="MS Sans Serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %Disk Time</FONT></B></TD>
      <TD WIDTH="22" HEIGHT="8">&nbsp;</TD>
      <TD WIDTH="78" HEIGHT="8"><FONT SIZE="2" FACE="MS Sans Serif">240.198</FONT></TD>
    </TR>
    <TR>
      <TD WIDTH="90" HEIGHT="7">&nbsp;</TD>
      <TD WIDTH="73" HEIGHT="7">&nbsp;</TD>
      <TD WIDTH="22" HEIGHT="7">&nbsp;</TD>
    </TR>
    <TR>
      <TD WIDTH="90" HEIGHT="1"><B><FONT SIZE="2" FACE="MS Sans Serif">Processor</FONT></B></TD>
      <TD WIDTH="73" HEIGHT="1">&nbsp;</TD>
      <TD WIDTH="22" HEIGHT="1"><B><FONT SIZE="2" FACE="MS Sans Serif">_Total</FONT></B></TD>
    </TR>
    <TR>
      <TD WIDTH="163" COLSPAN="2" HEIGHT="18" VALIGN="top"><B><FONT SIZE="2" FACE="MS Sans Serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %Processor Time</FONT></B></TD>
      <TD WIDTH="22" HEIGHT="18" ALIGN="center">
        <P ALIGN="center"><FONT SIZE="2" FACE="MS Sans Serif">2,000</FONT></TD>
    </TR>
  </TABLE>
  </CENTER>
</DIV></P>

You need to modify the server to improve its performance. What should you do? 

a. Install a larger hard disk. 

b. Increase the amount of RAM. 

c. Increase the size of the virtual memory paging file. 

d. Add an additional processor. 

Answer: B

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">Abnormal network counter values often indicate problems with a server's memory, processor, or disks. For that reason, the best approach to monitoring a server is to watch network counters in conjunction with Processor\ % Processor Time, PhysicalDisk\ % Disk Time, and Memory\ Pages/sec.

For example, if a dramatic increase in Pages/sec is accompanied by a decrease in Bytes Total/sec handled by a server, the computer is probably running short of physical memory for network operations.<BR><BR><B>--REF: (W2k HELP) keyword search "Monitoring network activity"</B></FONT>

103. You are the administrator of a SQL Server 2000 computer. You configure the SQLServerAgent service as shown in the exhibit: 

      <br><button onClick="window.open('./70-228/images/pic228-103.jpg','Exhibit','height=446,width=402,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



You configure several SQL Server Agent jobs to perform maintenance tasks. These jobs delete old database records and copy files from the server to file servers on your network. You discover that none of the jobs will execute. You use SQL Server Enterprise Manager to check the jobs and discover that the SQLServerAgent service will not start. You need to allow the SQL Server Agent service to start and execute the jobs. What should you do? 

a. Configure the SQL Server Agent service to start by using the local system account. 

b. Grant the SQLAgent domain user account Log on as a service rights. 

c. Add the SQLAgent domain user account as a Microsoft Windows login account on the server. 

d. Configure permissions on the master database to allow full access to the SQLAgent user account. 

Answer: B

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><P CLASS="tl"><B><FONT COLOR="#008080" FACE="Arial" SIZE="3">Requirements for Domain User Account</FONT></B></P>
<P><B><FONT SIZE="2" FACE="Arial">All domain user accounts must have permission to:</FONT></B>
<UL TYPE="disc">
  <LI><FONT SIZE="2" FACE="Arial">Access and change the SQL Server directory (\Program Files\Microsoft SQL Server\Mssql).<BR>
    </FONT>
  <LI><FONT SIZE="2" FACE="Arial">Access and change the .mdf, .ndf, and .ldf database files.<BR>
    </FONT>
  <LI><FONT SIZE="2" FACE="Arial">Log on as a service.<BR>
    </FONT>
  <LI><FONT SIZE="2" FACE="Arial">Read and write registry keys at and under:</FONT>
    <UL TYPE="disc">
      <LI><FONT SIZE="2" FACE="Arial">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer.<BR>
        -or- for any named instance: HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft SQL Server.<BR>
        </FONT>
      <LI><FONT SIZE="2" FACE="Arial">HKEY_LOCAL_MACHINE\System\CurrentControlset\Services\MSSQLServer.<BR>
        -or- for any named instance: HKEY_LOCAL_MACHINE\System\CurrentControlset\Services\MSSQL$Instancename.</FONT>
        <P CLASS="tl"><FONT SIZE="2" FACE="Arial">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Perflib.</FONT></P>
      </LI>
    </UL>
  </LI>
</UL>
<P CLASS="tl"><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Setting up Windows Services Accounts&quot;</B></FONT></P>

104. You are the administrator of a SQL server 2000 computer. The server contains a database named SalesTransactions. The database handles sales transactions for a network of retail outlets. The primary table is shown below: 


      <br><button onClick="window.open('./70-228/images/pic228-104.jpg','Exhibit','height=446,width=402,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>


Users report that when they add new sales, their inserts often time out. You examine the indexes on the table. The indexes are shown below: 


      <br><button onClick="window.open('./70-228/images/pic228-104a.jpg','Exhibit','height=446,width=402,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button>



You want to decrease the time required to store purchases made at the retail outlets. What are two possible ways to achieve this goal? 

a. Normalize the data structure of the table. 

b. Drop the nonclustered indexes of the table. 

c. Drop the primary key. 

d. Add nonclustered indexes to the item 1SKU, item2SKU, and item3SKU fields in the table. 

e. Re-create the PK_Sales Transactions index as a clustered index. 

Answer: A, E

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">The logical design of the database, including the tables and the relationships between them, is the core of an optimized relational database. A good logical database design can lay the foundation for optimal database and application performance. A poor logical database design can impair the performance of the entire system.<BR><BR>Normalizing a logical database design involves using formal methods to separate the data into multiple, related tables. A greater number of narrow tables (with fewer columns) is characteristic of a normalized database. A few wide tables (with more columns) is characteristic of an nonnomalized database.<BR><BR>Reasonable normalization often improves performance. When useful indexes are available, the Microsoft® SQL Server™ 2000 query optimizer is efficient at selecting rapid, efficient joins between tables.<BR><BR><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000"><B>?</B></font> <FONT color="TEAL"> Some answers are (A) and (B), however, all the indexes are nonclustered! (B) and (E) would give you one clustered index but is not the best Answer. After normalizing the data structure, some indexes will then be on other tables --In effect executing (B).</FONT><BR><BR><B>--REF: (BOL) keyword search "Normalization"</B></FONT>

105. You are the administrator of several SQL Server 2000 computers. You configure these servers to send e-mail messages to SQL Server operators whenever a SQL server agent job fails or encounters an error. 

Your company's software developers create a set of stored procedures that send query results in e-mail messages about stored procedures that have not been successful. 
By using a MAP1 profile named MS Exchange Settings, you verify that SQLAgentMail is correctly configured and working properly. You need to configure the servers so that the stored procedures function correctly. Which two actions should you take? 

a. Set the security permissions on your e-mail server to permit multiple connections to the SQL Server mailbox. 

b. Set the security permissions on your e-mail sever to permit connections from the MSSQLServer service account. 

c. Configure the MSSQLServer service to use the same service account as the SQLServerAgent service. 

d. Configure the SQLServerAgent service to use the same service account as the MSSQLServer service. 

e. Configure SQL Mail to use the MS Exchange Settings MAPI profile. 

f. Configure SQL Mail to use the Default Settings MAPI profile. 

Answer: C, E

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">To run SQL Mail with Exchange Server, the MSSQLServer service must be run under the same user account that logged on.If you plan to use mail stored procedures you must:
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">Have a mail server that is extended MAPI-compliant.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Configure a mail profile for MSSQLServer to use to connect to your mail server.</FONT></LI>
</UL>
<B>--REF: (BOL) keyword search &quot;Setting up Windows Services Accounts&quot;<BR>--REF: (BOL) keyword search "Troubleshooting SQL Mail with Exchange Server", "Configuring Mail Profiles"</B></FONT>
















106. You are the administrator of a new Microsoft Windows 2000 server computer named HQSQL5. HQSQL5 is a member server in your company's Windows NT 4.0 domain, which is named HQMAIN. After installing SQL Server 2000 on HQSQL5, you configure the MSSQLServer service account to use the HQMAIN\sqladmin user account, which is a member of the local administrators group on HQSQL5. 

You can use the HQMAIN\sqladmin user account to log on the HQSQL5. However, the MSSQLServer service fails to start. You need to start the service. What should you do? 

a. Revoke log on interactivity rights for the HQMAIN\sqladmin user account. 

b. Add the HQMAIN\sqladmin user account to the HQMAIN\Domain Admins group. 

c. Select the Password Never Expires check box for the HQMAIN\sqladmin user account. 

d. Grant log on as a service rights to the HQMAIN\sqladmin user account. 

Answer: D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><P CLASS="tl"><B><FONT COLOR="#008080" FACE="Arial" SIZE="3">Requirements for Domain User Account</FONT></B></P>
<P><B><FONT SIZE="2" FACE="Arial">All domain user accounts must have permission to:</FONT></B>
<UL TYPE="disc">
  <LI><FONT SIZE="2" FACE="Arial">Access and change the SQL Server directory (\Program Files\Microsoft SQL Server\Mssql).<BR>
    </FONT>
  <LI><FONT SIZE="2" FACE="Arial">Access and change the .mdf, .ndf, and .ldf database files.<BR>
    </FONT>
  <LI><FONT SIZE="2" FACE="Arial">Log on as a service.<BR>
    </FONT>
  <LI><FONT SIZE="2" FACE="Arial">Read and write registry keys at and under:</FONT>
    <UL TYPE="disc">
      <LI><FONT SIZE="2" FACE="Arial">HKEY_LOCAL_MACHINE\Software\Microsoft\MSSQLServer.<BR>
        -or- for any named instance: HKEY_LOCAL_MACHINE\Software\Microsoft\Microsoft SQL Server.<BR>
        </FONT>
      <LI><FONT SIZE="2" FACE="Arial">HKEY_LOCAL_MACHINE\System\CurrentControlset\Services\MSSQLServer.<BR>
        -or- for any named instance: HKEY_LOCAL_MACHINE\System\CurrentControlset\Services\MSSQL$Instancename.</FONT>
        <P CLASS="tl"><FONT SIZE="2" FACE="Arial">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Perflib.</FONT></P>
      </LI>
    </UL>
  </LI>
</UL>
<P CLASS="tl"><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Setting up Windows Services Accounts&quot;</B></FONT></P>

107. You are the database administrator for an accounting company. You are installing SQL Server 2000 on a new Microsoft Windows 2000 Server computer. The computer will run two client/server database applications that your company has purchased. Each application uses a separate database. 

During the installation, you specify SQL_Latin1_General_CP1_CI_AI as the default collation for the SQL server computer. After completing the installation, you discover that one of the new applications, named Financials, is sorting information incorrectly. 

You contact the application vendor and discover that the Financials application requires the SQL_Latin1_CP437_BIN collation. You need to configure the correct collation for the applications without diminishing the performance of the SQL Server computer. 

What should you do? 

a. Rerun the SQL Server Setup and specify the SQL_Latin1_General_CP437_BIN collation. 

b. Run the rebuildm utility and specify the SQL_Latin1_General_CP437_BIN collation. 

c. Use the ALTER DATABASE statement to specify the SQL_Latin1_General_CP437_BIN collation for the Financials database. 

d. Use the ALTER DATABASE statement to specify the SQL_Latin1_General_CP437_BIN collation for each table in the Financials database. 

Answer: C

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><P><FONT FACE="Arial" SIZE="2"><B>COLLATE &lt; <I>collation_name</I> &gt;</B></FONT></P><P CLASS="indent"><FONT FACE="Arial" SIZE="2">Specifies the collation for the database. Collation name can be either a Windows collation name or a SQL collation name. If not specified, the database is assigned the default collation of the<B> </B>SQL Server instance.</FONT></P>
<P CLASS="indent"><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;ALTER DATABASE&quot;, &quot;COLLATE&quot;</B></FONT></P>








109. You are the administrator of a SQL Server 2000 computer. The server contains a database named Sales. Your company uses the database to store the sales departments responses to requests for price quotations. 

Developers in your company create an application used for saving quotations. The application executes the following transact-SQL statement:<BR><BR><FONT color="BLUE">UPDATE</FONT> QuotationSummary<BR><FONT color="BLUE">SET</FONT> CustomerName = <FONT color="RED">'Jean-Paul Deloria'</FONT><BR><FONT color="BLUE">WHERE</FONT> QuotationID = 12<BR><BR>
When the application executes the statement, the developers receives the following error:<BR><BR><FONT color="RED">Server: Mrh4402, Level 16, Stats 1, Line 1</FONT><BR>View or function Quotation/Summary is not updateable because it contains aggregates:<BR><BR>
You want developers to be able to use this UPDATE statement without generating errors. What should you do? 

a. Create an INSTEAD OF trigger on the view to update the composite tables. 

b. Grant the developers UPDATE permissions on each base table. 

c. Add a cascading update trigger on each base table. 

d. Create a QuotationSummary table and populate the table with data from the base tables. 

Answer: A

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><P><FONT FACE="Arial" SIZE="2">INSTEAD OF triggers are executed instead of the triggering action. INSTEAD OF triggers can also be defined on views, in which case they extend the types of updates a view can support. Each table or view can have one INSTEAD
OF trigger for each triggering action (UPDATE, DELETE, and INSERT).</FONT></P>
<P CLASS="indent"><FONT FACE="Arial" SIZE="2"><!--NOTE-->
SQL Server 2000 supports more complex types of INSERT, UPDATE, and DELETE statements that reference views. INSTEAD OF triggers can be defined on a view to specify the individual updates that must be performed against the base tables to support the INSERT,UPDATE, or DELETE statement. Also, partitioned views support INSERT, UDPATE, and DELETE statements that modify multiple member tables referenced by the view.</FONT></P><P><FONT FACE="Arial" SIZE="2">Indexed views and indexes on computed columns involve storing results in the database for later reference. These stored results are valid only if all connections referring to the results can generate the same result set asthe connection that created the stored result set.</FONT></P><H5><FONT FACE="Arial" SIZE="2">Indexed Views</FONT></H5><P><FONT FACE="Arial" SIZE="2">Indexed views store the result set returned by a view by creating a clustered index on the view. For complex views, the stored result set greatly speeds data retrieval. An indexed view is useful only as long as alloperations referencing the view use exactly the same algorithms when building their results. Like indexes for computed columns, this includes:</FONT><UL TYPE="disc">
<LI><FONT FACE="Arial" SIZE="2">The CREATE INDEX statement that first builds the result set.</FONT><LI><FONT FACE="Arial" SIZE="2">Any subsequent INSERT, UPDATE, or DELETE statements that affect the base data used to build the view result set.</FONT><LI><FONT FACE="Arial" SIZE="2">All queries for which the optimizer must determine if the indexed view will be useful.</FONT></LI></UL><P CLASS="indent"><B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;SQL views</FONT><FONT FACE="Arial" SIZE="2"> Instead Of Trigger Property&quot;, &quot;SET Options That Affect Results&quot;</FONT></B></P>




110. You are the administrator of a SQL Server 2000 computer that contains a database. Users report that queries to this database respond slowly. You use System Monitor to examine the subsystems on your server and receive the results shown in the exhibit.
<br><BR><button onClick="window.open('./70-228/images/PIC228-110.jpg','Exhibit','height=332,width=411,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>
You need to modify the server to accelerate query response time. What should you do? 

a. Increase the amount of RAM. 

b. Upgrade to a faster disk subsystem. 

c. Add a faster network adapter. 

d. Add an additional processor. 

Answer: D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">high processor values could mean either that the system is efficiently handling a heavy workload or that it is struggling to keep up. For example, if you are monitoring a user's computer, and that computer is used for computation, the computational program might easily use 100 percent of the processor's time. Even if this causes the performance of other applications on that computer to suffer, this can be addressed by changing workload.<BR><BR>On the other hand, values around 100 percent on a server computer that processes many client requests indicate that processes are queuing up, waiting for processor time, and causing a bottleneck. Such a sustained high level of processor usage is unacceptable for a server.<BR><BR><B>--REF: (W2k HELP) keyword search "Monitoring processor activity"</B></FONT>











111. You are the administrator of a SQL Server 2000 computer. Your company modifies a sales application it uses so that it can access data from a SQL Server database rather than a Microsoft Access database. You configure the new SQL server database. The tables are configured as shown in the table schema exhibit.<BR>
<br><button onClick="window.open('./70-228/images/PIC228-111.gif','Exhibit','height=245,width=522,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>
 
Users report that queries to this database respond slowly. You use System Monitor to analyze database activity and receive the results shown in the exhibit below.<BR><BR>

<DIV ALIGN="center">
  <CENTER>
  <TABLE BORDER="1" BORDERCOLOR="#C0C0C0" CELLSPACING="0" BORDERCOLORDARK="#C0C0C0" BORDERCOLORLIGHT="#C0C0C0" WIDTH="313">
    <TR>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="193"><B><FONT SIZE="2" FACE="MS Sans Serif">SQLServer:Access Methods</FONT></B></TD>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="62">&nbsp;</TD>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="44">&nbsp;</TD>
    </TR>
    <TR>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="193">
        <P ALIGN="center"><B><FONT SIZE="2" FACE="MS Sans Serif">Full Scans / sec</FONT></B></TD>
      <TD ALIGN="center" BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="62">&nbsp;</TD>
      <TD ALIGN="center" BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="44"><FONT FACE="MS Sans Serif" SIZE="2">78.678</FONT></TD>
    </TR>
    <TR>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="193">&nbsp;</TD>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="62">&nbsp;</TD>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="44">&nbsp;</TD>
    </TR>
    <TR>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="193"><B><FONT SIZE="2" FACE="MS Sans Serif">SQLServer: Cache Manager</FONT></B></TD>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="62">&nbsp;</TD>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="44"><FONT FACE="MS Sans Serif" SIZE="2"><B>_Total</B></FONT></TD>
    </TR>
    <TR>
      <TD BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="193">
        <P ALIGN="center"><B><FONT SIZE="2" FACE="MS Sans Serif">Cache Hit Ratio</FONT></B></TD>
      <TD ALIGN="center" BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="62">&nbsp;</TD>
      <TD ALIGN="center" BGCOLOR="#C0C0C0" BORDERCOLOR="#C0C0C0" WIDTH="44"><FONT FACE="MS Sans Serif" SIZE="2">67.399</FONT></TD>
    </TR>
  </TABLE>
  </CENTER>
</DIV>

You need to modify the database to accelerate query response time. What should you do? 

a. Place primary keys and foreign key indexes on the table. 

b. Remove all indexes from the tables. 

c. Replace the table joins with correlated subqueries. 

d. Use a server-side cursor to retrieve data. 

Answer: A 

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">When SQL Server executes a statement to find data in the <B>PARTS</B> table based on a specified <B>Part_id</B> value, it recognizes the index for the <B>Part_id</B> column and uses the index to find the data. If the index is not present, it performs a full table scan starting at the beginning of the table and stepping through each row, searching for the specified <B>Part_id</B> value.<BR><BR><FONT FACE="Wingdings" SIZE=6 COLOR="#ff0000"><B>? </B></font><font color="TEAL">The exhibits were missing on this question. But guessing on the clues, you'd be looking for indexes and high table scans (Full scans).</FONT><BR><BR><B>--REF: (BOL) keyword search "Indexes"</B></FONT>









114. You are the administrator of an SQL Server 2000 computer. The server contains a database named ResearchRecords. This database contains research records and administrative records. The database consumes about 30GB of disk space. The data files are configured as shown below:<BR><BR>
<DIV ALIGN="center">
  <CENTER>
  <TABLE BORDER="1" HEIGHT="47" BGCOLOR="#808080" WIDTH="654">
    <TR>
      <TD HEIGHT="1" VALIGN="top" ALIGN="left" BGCOLOR="#C0C0C0" BORDERCOLORLIGHT="#C0C0C0" BORDERCOLORDARK="#000000" BORDERCOLOR="#C0C0C0" NOWRAP WIDTH="134"><FONT FACE="Arial" SIZE="2">File Name</FONT></TD>
      <TD HEIGHT="1" VALIGN="top" ALIGN="left" BGCOLOR="#C0C0C0" BORDERCOLORLIGHT="#C0C0C0" BORDERCOLORDARK="#000000" BORDERCOLOR="#C0C0C0" NOWRAP WIDTH="218"><FONT FACE="Arial" SIZE="2">Location</FONT></TD>
      <TD HEIGHT="1" VALIGN="top" ALIGN="left" BGCOLOR="#C0C0C0" BORDERCOLORLIGHT="#C0C0C0" BORDERCOLORDARK="#000000" BORDERCOLOR="#C0C0C0" NOWRAP WIDTH="135"><FONT FACE="Arial" SIZE="2">Space Allocated (MB)&nbsp;&nbsp;</FONT></TD>
      <TD HEIGHT="1" VALIGN="top" ALIGN="left" BGCOLOR="#C0C0C0" BORDERCOLORLIGHT="#C0C0C0" BORDERCOLORDARK="#000000" BORDERCOLOR="#C0C0C0" NOWRAP WIDTH="59"><FONT FACE="Arial" SIZE="2">Filegroup&nbsp;</FONT></TD>
    </TR>
    <TR>
      <TD HEIGHT="18" NOWRAP BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="134"><FONT FACE="Arial" SIZE="2">MedicalRecords_data.</FONT></TD>
      <TD HEIGHT="18" NOWRAP BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="218"><FONT SIZE="2" FACE="Arial">E:\Program Files\Microsoft\MSSQL...</FONT></TD>
      <TD HEIGHT="18" NOWRAP BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="135"><FONT SIZE="2" FACE="Arial">10000</FONT></TD>
      <TD HEIGHT="18" NOWRAP BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="59"><FONT SIZE="2" FACE="Arial">PRIMARY</FONT></TD>
    </TR>
    <TR>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="134"><FONT FACE="Arial" SIZE="2">MedicalRecords_data1</FONT></TD>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="218"><FONT FACE="Arial" SIZE="2">F:\data\MedicalRecords</FONT></TD>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="135"><FONT SIZE="2" FACE="Arial">10000</FONT></TD>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="59"><FONT SIZE="2" FACE="Arial">PRIMARY</FONT></TD>
    </TR>
    <TR>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="134"><FONT FACE="Arial" SIZE="2">MedicalRecords_data2</FONT></TD>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="218"><FONT SIZE="2" FACE="Arial">G:\Program Files\Microsoft\MSSQL...</FONT></TD>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="135"><FONT SIZE="2" FACE="Arial">20000</FONT></TD>
      <TD HEIGHT="18" BGCOLOR="#FFFFFF" BORDERCOLORLIGHT="#FFFFFF" BORDERCOLORDARK="#FFFFFF" WIDTH="59"><FONT SIZE="2" FACE="Arial">PRIMARY</FONT></TD>
    </TR>
  </TABLE>
  </CENTER>
</DIV><BR><BR>
You run full database backups each night after business hours. You notice that the backup is not complete by the time the morning shift begins to use the database. You need to minimize the time needed to restore data in the event of a system failure. You also want to reconfigure the database to allow the backups to complete during the evening hours. Which two actions should you take? (Each correct answer presents part of the solution. Choose two) 

a. Reorganize the data files into two filegroups. 
Place the system tables in the PRIMARY filegroup and the user-defined tables in the other filegroup. 

b. Reorganize the data files into three filegroups. 
Place the system tables and shared objects in the PRIMARY filegroup, the clinical records in a filegroup, and the administrative records in a filegroup. 

c. Reorganize the data files into three filegroups. 
Place the system tables in the PRIMARY filegroup, the indexes in a filegroup, and the tables in the other filegroup. 

d. Back up the transaction log each night. 
Run a filegroup backup on a different filegroup each night. 

e. Back up the transaction log each night. 
Run a filegroup backup on the database each weekend. 

f. Back up the transaction log each night. 
Run a differential backup each Sunday, and run a full backup the first day of each month. 

Answer: B, D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><FONT FACE="Arial" SIZE="2">You need to minimize the time needed to restore data in the event of a system failure. You also want to reconfigure the database to allow the backups to complete during the evening hours.</FONT></FONT><P><FONT FACE="Arial" SIZE="2">To minimize the time needed to restore data you would want to spread the data files out evenly. The Primary file group has to contain the system files - relatively small by themselves. Adding files (from MedicalRecords_data2??) would balance things out. By adding the shared objects to this file group,&nbsp; if File group1 goes, File group2 does not loose the objects and vise versa.</FONT></P><P><FONT FACE="Arial" SIZE="2">If the indexes of a table span multiple filegroups, all filegroups containing the table and its indexes must be backed up together, after which a transaction log backup must be created. Otherwise, only some of the indexes may be backed up, preventing the index from being recovered if the backup is restored later.&nbsp; If there is a clustered index on a table, the data and the clustered index always reside in the same filegroup.</FONT></P> <P><FONT FACE="Arial" SIZE="2">If a disk holding database files or filegroups fails, the site can restore just the lost files or filegroups. The site must also be making transaction log backups, and must restore all transaction log backups made after the file or filegroup backup.</FONT></P> <FONT FACE="Arial" SIZE="2"><P><B>--REF: (BOL) keyword search &quot;PRIMARY FILE&quot;, &quot;FILEGROUPS&quot;, &quot;File and Filegroup Backup and Restore&quot;, &quot;Placing Indexes on Filegroups&quot;</B></P>








116. You are the administrator of a SQL server 2000 computer. The server 
contains a database named inventory. Developers at your company upgrade an 
inventory tracking application. Users report that when they insert new 
information in the Locations table, the upgrade application returns the 
following error message:<BR><BR>
<FONT FACE="MS SANS Serif"><B>'String or binary data would be truncated. The statement has been terminated.'</B></FONT><BR><BR>
When you use SQL Profiler to trace the activity of the application, you 
receive the results as shown below:
<P ALIGN="center"><img src="./70-228/images/PIC228-116a.jpg"></P>
You examine the design of the locations table as shown in the Exhibit.
<BR><br><button onClick="window.open('./70-228/Images/PIC228-116.jpg','Locations','height=448,width=404,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>
You need to configure the database to support both versions of the 
application without affecting server performance. What should you do? 

a. Alter the data type of the Description field to varchar(50). 

b. Alter the data type of the Special field to varchar(50). 

c. Alter the data type of the CubicFeet field to float. 

d. In the locations table, create an INSTEAD OF trigger that truncates the 
description field at 10 characters when the record is updated. 

e. In the locations table, create an INSTEAD OF trigger that truncates the 
Special field at 10 characters when the record is updated. 

Answer: A

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION:</B></FONT><FONT FACE="Arial" SIZE="2"> Sometimes you might receive error messages with your application. For example, the following 8152 error message might occur in Microsoft SQL Server :</FONT>
<P><FONT FACE="Arial" SIZE="2"><FONT COLOR="#FF0000">Msg 8152, Level 16, State 9</FONT><BR>
String or binary data would be truncated. The statement has been terminated.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">To work around this problem, either define the column in the table to accept the values or you can trim or convert the values before you insert them. This is a change in behavior from Microsoft SQL Server 6.0 to SQL Server
6.5, which is described in the following Microsoft Knowledge Base article:</FONT></P><P><FONT FACE="Arial" SIZE="2"><B>--REF: http:/support.microsoft.com/default.aspx?scid=kb;en-us;Q255765
</FONT></B></P>











117. You are the administrator of a SQL Server 2000 computer. The server 
contains two databases. A client/server application accesses one of the 
databases. A different client/server application accesses the other 
database. Each application uses several stored procedures to query and 
update its database. Users report that both applications respond slowly. You use SQL Profiler to monitor activity on the server. You receive results of the trace as shown below:<P><B><U><FONT FACE="MS SANS Serif">
EventClass______________________TestData </b></U><BR>

SQL:BatchCompleted              If @@TRANCOUNT > 0 COMMIT TRAN <BR>

SQL:BatchCompleted              Update Customer Set CustomerZip =  <BR>

SQL:BatchCompleted              Update Products Set SKU = '23456.. <BR>

SQL:BatchCompleted              If @@TRANCOUNT > 0 COMMIT TRAN <BR>

SQL:BatchCompleted              Update Customers Set CustomerZip=</LI></P></FONT>

You need to improve the performance of the applications. What should you 
do? 

a. Modify the applications so that they use views to query data. 

b. Modify the stored procedures so that they select data into temporary tables. 

c. Re-create the stored procedures so that they do not contain the WITH RECOMPILE option. 

d. Disable the 'Autoupdate statistics' option in both databases. 

Answer: A

<P><FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"> <B><FONT FACE="Arial" SIZE="2">COMMIT TRANSACTION</FONT></B> <FONT FACE="Arial" SIZE="2">When used in nested transactions, commits of the inner transactions do not free resources or make their modifications permanent. The data modifications are made
permanent and resources freed only when the outer transaction is committed. Each COMMIT TRANSACTION issued when @@TRANCOUNT is greater than 1 simply decrements @@TRANCOUNT by 1. When @@TRANCOUNT is finally decremented to 0, the entire outer transaction is
committed. Because <I>transaction_name</I> is ignored by SQL Server, issuing a COMMIT TRANSACTION referencing the name of an outer transaction when there are outstanding inner transactions only decrements @@TRANCOUNT by 1.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">Explicit Transactions</FONT></B> <FONT FACE="Arial" SIZE="2">An explicit transaction is one in which you explicitly define both the start and end of the transaction. Explicit transactions were also called user-defined or
user-specified transactions in earlier versions of Microsoft® SQL Server™.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">DB-Library applications and Transact-SQL scripts use the BEGIN TRANSACTION, COMMIT TRANSACTION, COMMIT WORK, ROLLBACK TRANSACTION, or ROLLBACK WORK Transact-SQL statements to define explicit transactions.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">COMMIT TRANSACTION&nbsp; Used to end a transaction successfully if no errors were encountered. All data modifications made in the transaction become a permanent part of the database. Resources held by the transaction are
freed.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">Transact-SQL Tips</FONT></B> <FONT FACE="Arial" SIZE="2" COLOR="#FF0000">Minimize the use of temporary tables as places to store intermediate results in a series of Transact-SQL statements. Creating and maintaining the
temporary tables requires overhead; if possible, consider coding the operation as a single, more complex Transact-SQL statement. </FONT><FONT FACE="Arial" SIZE="2" COLOR="#008080">(ANSWER B)</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><FONT COLOR="#FF0000">In SQL Server 2000, use of temporary tables in stored procedures and triggers may cause the stored procedure or trigger to be recompiled every time it is used. </FONT><FONT COLOR="#008080">(ANSWER C) </FONT>To
avoid such recompilation, stored procedures or triggers that use temporary tables must meet the certain requirements.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">Scenarios for Using Views</FONT></B> <FONT FACE="Arial" SIZE="2">Views are generally used to focus, simplify, and customize the perception each user has of the database. Views can be used as security mechanisms by
allowing users to access data through the view, without granting the users permissions to directly access the underlying base tables of the view. Views can also be used, when copying data to and from Microsoft® SQL Server™ 2000, to improve performance
and to partition data.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">Views can simplify how users manipulate data. You can define frequently used <!--GLOSSARY-->joins , projections , <!--GLOSSARY--> UNION queries, and <!--GLOSSARY-->
 <FONT COLOR="#000000">SELECT queries </FONT>as views so that users do not have to specify all the conditions and qualifications each time an additional operation is performed on that data. For example, a complex query that is used for reporting purposes
and performs sub queries, outer joins, and aggregation to retrieve data from a group of tables can be created as a view. The view simplifies access to the data because the underlying query does not have to be written or submitted each time the report is
generated; the view is queried instead. </FONT></P>
<P><FONT FACE="Arial" SIZE="2">The Transact-SQL UNION set operator can be used within a view to combine the results of two or more queries from separate tables into a single result set. This appears to the user as a single table called a partitioned view.
For example, if one table contains sales data for Washington, and another table contains sales data for California, a view could be created from the UNION of those tables. The view represents the sales data for both regions.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">To use partitioned views, you create several identical tables, specifying a constraint to determine the range of data that can be added to each table. The view is then created using these base tables. When the view is
queried, SQL Server automatically determines which tables are affected by the query and references only those tables. For example, if a query specifies that only sales data for the state of Washington is required, SQL Server reads only the table
containing the Washington sales data; no other tables are accessed.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">Partitioned views can be based on data from multiple heterogeneous sources, such as remote servers, not just tables in the same database. For example, to combine data from different remote servers each of which stores data
for a different region of your organization, you can create distributed queries that retrieve data from each data source, and then create a view based on those distributed queries. Any queries read only data from the tables on the remote servers that
contains the data requested by the query; the other servers referenced by the distributed queries in the view are not accessed.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">When you partition data across multiple tables or multiple servers, queries accessing only a fraction of the data can run faster because there is less data to scan. If the tables are located on different servers, or on a
computer with multiple processors, each table involved in the query can also be scanned in parallel, thereby improving query performance. Additionally, maintenance tasks, such as rebuilding indexes or backing up a table, can execute more quickly.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">By using a partitioned view, the data still appears as a single table and can be queried as such without having to reference the correct underlying table manually.</FONT></P>
<P>&nbsp;<B><FONT FACE="Wingdings" SIZE="6" COLOR="#ff0000">?</FONT></B>&nbsp; <FONT FACE="Arial" SIZE="2" COLOR="#008080">Other answers have been (B) and (C). The reason why those answers are probably wrong are highlighted in red above. The &quot;trace
shows two tables constantly being queried between commits; <B>Customer</B> and <B>Products</B>. Create a view for a table join <B>CustomerProducts.</B></FONT></P>
<P><FONT FACE="Arial" SIZE="2" COLOR="#000000"><B>--REF: (BOL) keyword search &quot;</B></FONT><B><FONT FACE="Arial" SIZE="2">Scenarios for Using Views</FONT></B>&quot;, &quot;<B><FONT FACE="Arial" SIZE="2">Transact-SQL Tips&quot;, &quot;Explicit
Transactions&quot;, &quot;COMMIT TRANSACTION&quot;</FONT></B></P>









118. You are the administrator of a SQL Server 2000 computer named 
FABSQL2K01. You create a data transformation services package that 
contains definitions for two transform data tasks. The tasks get data from 
two text files named customers and sales. The DTS package is configured as 
shown in exhibit: 
<P ALIGN="center"><img src="./70-228/images/PIC228-118.jpg"></P>
You do not want the DTS package to add any data to the server unless both 
transform data tasks complete successfully. You select the 'Use 
transactions' check box and the 'Join transaction of present' check box of 
both transform data tasks. You them select the 'Fail package on step 
failure' check box of both transform data tasks. You want to use the DTS 
package to import data from the text files to the server. You want to 
ensure that changes are committed if all imported data is successfully 
transformed. What should you do? 

a. Select the 'Commit on successful completion' check box of the DTS package. 

b. Select the 'Commit transaction on successful completion of this step' check box of the customers transform data task. 
c. Select the 'Commit transaction on successful completion of this step' check box of the sales transform data task. 

d. Select the 'Commit transaction on successful completion of this step' check box of both transform data tasks. 

Answer: A

<P><FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">&nbsp;</P>
</FONT><B><FONT COLOR="#008080" FACE="Arial" SIZE="3">Commit on successful package completion</FONT></B><FONT COLOR="#008080" FACE="Arial" SIZE="3">.</FONT>
<P><FONT FACE="Arial" SIZE="2">If this check box is selected, updates pending in an open package transaction are committed when a package finishes executing and one or both of the following is true:</P>
<UL TYPE="disc">
  <LI>No steps failed.
  <LI>The <B>Fail package on first error</B> check box is cleared.</LI>
</UL>
<P CLASS="tl">If the <B>Commit on successful package completion</B> check box is cleared, an open transaction is rolled back on package completion and pending updates are lost.</P>
</FONT><B><FONT COLOR="#008080" FACE="Arial" SIZE="3">Commit transaction on successful completion of this step</FONT></B><FONT COLOR="#008080" FACE="Arial" SIZE="3">.</FONT><FONT FACE="Arial" SIZE="2">
<P CLASS="tl">If this check box is selected, successful step completion triggers a transaction commit. Pending updates are made permanent. If cleared, any updates remain in the transaction until a later commit or rollback.</P>
<P><FONT FACE="Arial" SIZE="2" COLOR="#000000"><B>--REF: (BOL) keyword search &quot;</B></FONT><B>Configuring Properties for DTS Transactions&quot;</B></P>











119. You are the administrator of a SQL Server 2000 computer. The server is 
used to store sales information for your company. Your company hires a new 
sales manager named Paulo. You create a user account named Paulo in your 
company's Microsoft Windows NT domain, which is named CORPORATE. You 
create a Windows authenticated login for Paulo on the server. The 
permissions on the sales table are configured as shown in exhibit: <BR><BR>
<DIV ALIGN="center">
  <CENTER>
  <TABLE BORDER="1" CELLPADDING="0" CELLSPACING="0">
    <TBODY>
      <TR>
        <TD ALIGN="middle" BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2"><B>User/Role</B></FONT></TD>
        <TD ALIGN="middle" BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2"><B>&nbsp;Select&nbsp; </B></FONT></TD>
        <TD ALIGN="middle" BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2"><B>&nbsp;Insert&nbsp; </B></FONT></TD>
        <TD ALIGN="middle" BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2"><B>&nbsp;Createview&nbsp; </B></FONT></TD>
        <TD ALIGN="middle" BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2"><B>&nbsp;CreateSP&nbsp; </B></FONT></TD>
      </TR>
      <TR>
        <TD BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2">&nbsp;Accountants</FONT></TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></P>
        </TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></P>
        </TD>
        <TD ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#ff0000" FACE="Wingdings" SIZE="5">ý</FONT></TD>
      </TR>
      <TR>
        <TD BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2">&nbsp;Administrators</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#c0c0c0" FACE="Wingdings" SIZE="5">¨</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#c0c0c0" FACE="Wingdings" SIZE="5">¨</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#c0c0c0" FACE="Wingdings" SIZE="5">¨</FONT></TD>
      </TR>
      <TR>
        <TD BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2">&nbsp;Reporters</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#ff0000" FACE="Wingdings" SIZE="5">ý</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#ff0000" FACE="Wingdings" SIZE="5">ý</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#ff0000" FACE="Wingdings" SIZE="5">ý</FONT></TD>
      </TR>
      <TR>
        <TD BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2">&nbsp;SalesPeople</FONT></TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></P>
        </TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></P>
        </TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#ff0000" FACE="Wingdings" SIZE="5">ý</FONT></P>
        </TD>
        <TD ALIGN="center"><FONT COLOR="#ff0000" FACE="Wingdings" SIZE="5">ý</FONT></TD>
      </TR>
      <TR>
        <TD BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2">&nbsp;Guest</FONT></TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#c0c0c0" FACE="Wingdings" SIZE="5">¨</FONT></P>
        </TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#c0c0c0" FACE="Wingdings" SIZE="5">¨</FONT></P>
        </TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#c0c0c0" FACE="Wingdings" SIZE="5">¨</FONT></P>
        </TD>
        <TD ALIGN="center">
          <P ALIGN="center"><FONT COLOR="#c0c0c0" FACE="Wingdings" SIZE="5">¨</FONT></P>
        </TD>
      </TR>
      <TR>
        <TD BGCOLOR="#c0c0c0"><FONT FACE="Arial" SIZE="2">&nbsp;Sales Managers </FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></TD>
        <TD ALIGN="center"><FONT COLOR="#008000" FACE="Wingdings" SIZE="5">þ</FONT></TD>
      </TR></TBODY></TABLE></CENTER></DIV><BR><BR>
Paulo needs permission to view, add, edit, and remove information in the 
database tables. Which transact-SQL statement should you execute? 

a. EXEC sp_addrolemember 'SalesManagers', 'Corporate\Paulo' 

b. GRANT ALL ON sales TO 'Corporate\Paulo' 

c. EXEC sp_addrolemember 'SalesManagers', 'Paulo' 

d. EXEC sp_grantdbaccess 'Corporate\Paulo', 'Paulo' 
EXEC sp_addrolemember 'SalesManagers', 'Paulo' 

Answer: D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">Paulo needs database access as well as a login.<BR><BR><B>--REF: (BOL) keyword search "sp_grantdbaccess"</B></FONT>















120. You are the administrator of two SQL Server 2000 computers. Each server 
contains data for one of your company's two regional divisions. Company 
employees currently use a single data entry application on client 
computers. After the new application is installed, query response times 
slow. You want to monitor server traffic during business hours to help 
diagnose this problem. What should you do? 

a. Run SQL Profiler, and create one trace to monitor both servers. 
Configure the trace to include data from the new data entry application 
only. 

b. Run two instances of SQL Profiler, and create a trace to monitor each 
server. Configure the trace to include data from both data entry 
applications. 

c. Run the sqldrag utility from a command prompt. 
Write diagnostic data to a text file. 

d. Execute the sp_monitor stored procedure. 
Save the output to a text file. 

Answer: D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">
<P><FONT SIZE="2" FACE="Arial"><B>sp_monitor</B> Displays statistics about Microsoft® SQL Server™. Displays statistics, including CPU usage, I/O usage, and the amount of time idle since <B>sp_monitor</B> was last executed.</FONT></P>
<H5><FONT SIZE="2" FACE="Arial">Result Sets</FONT></H5>
<TABLE WIDTH="641">
  <TR VALIGN="top">
    <TD WIDTH="165"><B><FONT SIZE="2" FACE="Arial">packets_received</FONT></B></TD>
    <TD WIDTH="462"><FONT SIZE="2" FACE="Arial">Number of input packets read by SQL Server.</FONT></TD>
  </TR>
  <TR VALIGN="top">
    <TD WIDTH="165"><B><FONT SIZE="2" FACE="Arial">packets_sent</FONT></B></TD>
    <TD WIDTH="462"><FONT SIZE="2" FACE="Arial">Number of output packets written by SQL Server.</FONT></TD>
  </TR>
  <TR VALIGN="top">
    <TD WIDTH="165"><B><FONT SIZE="2" FACE="Arial">packet_errors</FONT></B></TD>
    <TD WIDTH="462"><FONT SIZE="2" FACE="Arial">Number of errors encountered by SQL Server while reading and writing packets.</FONT></TD>
  </TR>
</TABLE>
<BR>
<TABLE BORDER="1" CELLPADDING="2" COLS="3" FRAME="box" RULES="all" WIDTH="587">
  <TBODY>
    <TR VALIGN="top">
      <TD WIDTH="36%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">packets_received</FONT></CODE></TD>
      <TD WIDTH="36%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">packets_sent</FONT></CODE></TD>
      <TD WIDTH="28%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">packet_errors</FONT></CODE></TD>
    </TR>
    <TR VALIGN="top">
      <TD WIDTH="36%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">-----------------</FONT></CODE></TD>
      <TD WIDTH="36%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">-----------------</FONT></CODE></TD>
      <TD WIDTH="28%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">-------------</FONT></CODE></TD>
    </TR>
    <TR VALIGN="top">
      <TD WIDTH="36%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">16(1)</FONT></CODE></TD>
      <TD WIDTH="36%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">20(2)</FONT></CODE></TD>
      <TD WIDTH="28%" BGCOLOR="#E6E3DF" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#CCCCCC"><CODE><FONT FACE="Times New Roman" SIZE="2">0(0)</FONT></CODE></TD>
    </TR>
  </TBODY>
</TABLE>













121. Backup strategy involves making full backup on every Saturday night, differential backup every day and transaction log backup every hour. The database crashes. How do you restore? (Choose all that apply) 

a. Restore the latest full backup. 

b. Restore the latest differential backup. 

c. Restore all differential backups in sequence. 

d. Restore all differential backups after the full backup in sequence. 

e. Restore all transaction log backups 

f. Restore all transaction log backups in sequence. 

g. Restore only the transaction log backups on the day of the crash. 

h. Restore all transaction log backups on the day of the crash in sequence. 

i. Restore all transaction log backups on the day of the crash in sequence with no_truncate. 

Answer: A, B, H

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B><P><FONT FACE="Arial" SIZE="2">Using database, differential database, and transaction log backups together can reduce the amount of time it takes to restore a database back to any point in time after the database backup was created. Additionally, creating
both differential database and transaction log backups can increase the robustness of a backup in the event that either a transaction log backup or differential database backup becomes unavailable, for example, due to media failure.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">Typical backup procedures using database, differential database, and transaction log backups create database backups at longer intervals, differential database backups at medium intervals, and transaction log backups at
shorter intervals. For example, create database backups weekly, differential database backups one or more times per day, and transaction log backups every ten minutes.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">If a database needs to be recovered to the point of failure, for example, due to a system failure:</FONT>
<OL>
  <LI><FONT FACE="Arial" SIZE="2">Back up the currently active transaction log. This operation will fail if the transaction log has been damaged.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Restore the last database backup created.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Restore the last differential backup created since the database backup was created.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Apply all transaction log backups, in sequence, created after the last differential backup was created, finishing with the transaction log backup created in Step 1.</FONT></LI>
</OL>
<P>&nbsp;</P>
<P STYLE="MARGIN-LEFT: 1.5em; MARGIN-TOP: -1.1em"><FONT FACE="Arial" SIZE="2"><B>Note</B>&nbsp;&nbsp;If the active transaction log cannot be backed up, it is possible to restore the database only to the point when the last transaction log backup was
created. Changes made to the database since the last transaction log backup are lost and must be redone manually.</FONT></P>
<!--/NOTE-->
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Reducing Recovery Time&quot;</B></FONT></P>













122.You are the administrator of a new SQL Server 2000 computer. Your company has client computers that are running Microsoft Windows 2000 Professional. All client computers require access to the server.
According to company policy, passwords must be at least eight characters long and change every 30 days. You need to implement these policies and allow client computers to connect. What should you do? (Each correct answer presents part of the solution. Choose all that apply.

a. Configure Mixed Mode authentication 

b. Configure Windows authentication. 

c. Create a SQL Server login for each user who will access the server.

d. Create a login for the Domain Users group.

e. Set the Windows 2000 domain policy for password expiration to 30 days. 

f. Set the Windows 2000 domain policy to require a password length of at least 8 characters.

Answer: B, D, E, F

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">When a user connects through a Windows NT 4.0 or Windows 2000 user account, SQL Server revalidates the account name and password by calling back to Windows NT 4.0 or Windows 2000 for the information.<BR><BR>Account Policies: These policies apply to user accounts. This security area contains attributes for:<BR>Password policy: for domain or local user accounts, determines settings for passwords such as enforcement, and lifetimes.<BR><BR><B>--REF:(BOL) keyword search "Authentication Modes"<BR>--REF: (W2k HELP) keyword search "Account Policies"</B></FONT>












124. You are the administrator of a SQL Server 2000 computer. You want to set up snapshot replication on the server. The server will serve as Publisher and Distributor for a minimum of 40/50 Subscribers. Currently, you want to publish 3GB/4GB of data, but the data is expected to grow over time. Subscribers will receive a new snapshot each month. You want to minimize the workload on the Publisher/Distributor. Which two actions should you take to configure snapshot replication? (Each correct answer presents part of the solution. Choose two) 

a. Store the snapshot in the default folder on the Publisher/Distributor. 

b. Store the snapshot in an alternative folder on the Publisher/Distributor. 

c. Store the snapshot in a shared folder on a file server. 

d. Create pull subscriptions. 

e. Create push subscriptions. 

Answer: C, E

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><P><FONT FACE="Arial" SIZE="2"><B>Alternate Snapshot Locations: </B>Alternate snapshot locations enable you to store snapshot files in a location other than, or in addition to, the default location, which is often located on the Distributor. Alternate locations can be on another server, on a network drive, or on removable media such as CD-ROMs or removable disks.</FONT></P><P><FONT FACE="Arial" SIZE="2"><B>Push Subscriptions: </B><FONT COLOR="#FF0000">Push subscriptions are created at the Publisher,</FONT> and the replication agents propagate data and updates to a Subscriber without a request from the Subscriber. Changes can also be pushed to Subscribers on a scheduled basis</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>Pull Subscriptions</B></FONT><B>:</B> <FONT FACE="Arial" SIZE="2"><FONT COLOR="#FF0000">Pull subscriptions are created at the Subscriber,</FONT> and<B> </B>the Subscriber requests data and updates made at the Publisher. Pull subscriptions allow the user at the Subscriber to determine when the data changes are synchronized, which can be on demand or scheduled.</FONT></P><P><B><FONT SIZE="2" FACE="Arial">--REF: (BOL) keyword search &quot;Alternate Snapshot Locations&quot;, &quot;Push Subscriptions&quot;, &quot;Pull Subscriptions&quot;</FONT></B></P>












125. You are the administrator of a SQL Server 2000 computer named DataSvr. The server is a member of a Microsoft Windows NT domain named RESEARCH. Several users need access to the database stored on the server. These users all belong to a domain user group named domain scientists. They also belong to a local user group named Local Techs on the DataSvr computer. 

Your company will be hiring 30 new employees who will be added to the domain scientists group by domain administrators. These employees will also need access to DataSvr. You need to allow all of the appropriate users to access DataSvr. You also want to minimize the amount of time you have spend maintaining security on DataSvr. Which Transact-SQL statement would you execute? 

a. EXEC sp_grantlogin BUILTIN\Local Techs 

b. EXEC sp_grantlogin 'Local Techs' 

c. EXEC sp_grantlogin [Datasvr\Domain Scientists] 

d. EXEC sp_grantlogin [Research\Domain scientists] 

Answer: D

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">
<P><FONT FACE="Arial" SIZE="2"><B>sp_grantlogin </B>Allows a Microsoft® Windows NT® user or group account to connect to Microsoft SQL Server™ using Windows Authentication.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2" COLOR="#008080">Syntax</FONT></B></P>
<P><FONT FACE="Arial" SIZE="2"><B>sp_grantlogin</B> [<B>@loginame</B> <B>=</B>] <B>'</B><I>login</I><B>'</B></FONT></P>
<P><FONT FACE="Arial" SIZE="2" COLOR="#008080">Arguments</FONT></P>
<P><FONT FACE="Arial" SIZE="2">[<B>@loginame</B> <B>=</B>] <B>'</B><I>login</I><B>'</B></FONT></P>
<P><FONT FACE="Arial" SIZE="2">Is the name of the Windows NT user or group to be added. The Windows NT user or group must be qualified with a Windows NT domain name in the form Domain\User or group</FONT></P>
<P><B><FONT SIZE="2" FACE="Arial">--REF: (BOL) keyword search &quot;</FONT></B><FONT FACE="Arial" SIZE="2"><B>sp_grantlogin</B></FONT><B><FONT SIZE="2" FACE="Arial">&quot;</FONT></B></P>













126. You are the administrator of a SQL Server 2000 computer. The server contains a database named MedicalRecords. The database tables are configured as shown below:<BR><BR><CENTER><img src="./70-228/images/PIC228-126.jpg"></CENTER><BR><BR>
The existing PatientID field is an identity field. A new healthcare policy mandates that patient IDs must include a three-character prefix before the numeric portion of the ID. The patient's home address defines the prefix. You want to comply with the regulation while minimizing changes to the database. Which two actions should you take? (Each correct answer presents part of the solution. Choose Two) 

a. Drop the FOREIGN KEY constraints. In each table, change the data type of the PatientID field to char. 

b. Add an on update constraint to the patients table, and link it to the PatientID field. Update the field in the Patients table. 

c. In the Patients table, add a new field named StatePatientID that has a data type of char. Populate the field with the prefix and the existing PatientID. 

d. In each table, update the PatientID field. 
Re-create the FOREIGN KEY constraints. 

e. In the Patients table, update the PatientID field. 

f. Create a trigger that populates the StatePatientID field when a new patient is created. 

Answer: A, D 

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT>
<P><B><FONT FACE="Arial" COLOR="#008080" SIZE="3">Creating and Modifying FOREIGN KEY Constraints</FONT></B></P>
<P><FONT FACE="Arial" SIZE="2"><B>FOREIGN KEY constraints can be: </B>Modified or deleted if FOREIGN KEY constraints already exist. For example, you may want the table's FOREIGN KEY constraint to reference other columns. It is not possible to change the
length of a column defined with a FOREIGN KEY constraint.<BR>
</FONT>
<P STYLE="MARGIN-LEFT: 1.5em; MARGIN-TOP: -1.1em">&nbsp;</P>
<P STYLE="MARGIN-LEFT: 1.5em; MARGIN-TOP: -1.1em"><FONT FACE="Arial" SIZE="2"><B>Note</B>&nbsp;&nbsp;To modify a FOREIGN KEY constraint using Transact-SQL or SQL-DMO, you must first delete the existing FOREIGN KEY constraint and then re-create it with the
new definition.</FONT></P>
<!--/NOTE-->
<P><B><FONT FACE="Arial" COLOR="#008080" SIZE="3">Disabling FOREIGN KEY Constraints</FONT></B></P>
<P><FONT FACE="Arial" SIZE="2"><B>Existing FOREIGN KEY constraints can be disabled for: </B>INSERT and UPDATE statements. This allows data in the table to be modified without being validated by the constraints. Disable a FOREIGN KEY constraint during
INSERT and UPDATE statements if new data will violate the constraint or if the constraint should apply only to the data already in the database.</FONT>
<P><FONT FACE="Arial" SIZE="2">Delete a FOREIGN KEY constraint, thus removing the requirement, to enforce referential integrity between the foreign key columns and the related primary key (or UNIQUE constraint) columns in another table.</FONT></P>
<P><B><FONT FACE="Arial" SIZE="3" COLOR="#008080">Constraints</FONT></B></P>
<FONT FACE="Arial" SIZE="2"><B>FOREIGN KEY constraints identify the relationships between tables.</B></FONT>
<P><FONT FACE="Arial" SIZE="2">The ON UPDATE clause defines the actions that are taken if you attempt to update a candidate key value to which existing foreign keys point. It also supports the NO ACTION and CASCADE options.</FONT></P>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">NO ACTION specifies that the deletion fails with an error.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">CASCADE specifies that all the rows with foreign keys pointing to the deleted row are also deleted.</FONT></LI>
</UL>
<P><B><FONT FACE="Arial" SIZE="3" COLOR="#008080">Cascading Referential Integrity Constraints</FONT></B></P>
<P><B><FONT COLOR="#000000"><FONT FACE="Arial" SIZE="2">ON UPDATE CASCADE</FONT></FONT></B></P>
<P><FONT FACE="Arial" SIZE="2">Specifies that if an attempt is made to update a key value in a row, where the key value is referenced by foreign keys in existing rows in other tables, all of the foreign key values are also updated to the new value
specified for the key. If cascading referential actions have also been defined on the target tables, the specified cascading actions are also taken for the key values updated in those tables.</FONT></P>
<P><FONT FACE="Arial" COLOR="#FF0000">Identity columns cannot be updated.</FONT></P>
<P><FONT FACE="Wingdings" SIZE="6" COLOR="#FF0000"><B>?</B></FONT><FONT FACE="Arial" SIZE="2"> <FONT COLOR="#008080">Some other answers were (C, F). </FONT></FONT></P>
<UL>
  <LI><FONT COLOR="#008080" FACE="Arial" SIZE="2">The answer (C, F) would require a StatePatientID field to be created on all the tables for the trigger that populates the StatePatientID field to work. </FONT></LI>
  <LI><FONT COLOR="#008080" FACE="Arial" SIZE="2">The Identity column is the PatientID column. The Identity constraint would need to be removed for the UPDATE constraint to work ( answer (B) ).</FONT></LI>
  <LI><FONT COLOR="#008080" FACE="Arial" SIZE="2">&nbsp;Answer (E) works only with (A) but does not address the other tables.</FONT></LI>
  <LI><FONT COLOR="#008080" FACE="Arial" SIZE="2">Answer (A) is required for the required changes to the PatientID column. And (D) is our only unfortunate partner for (A).</FONT></LI></UL>
<P><B><FONT SIZE="2" FACE="Arial">--REF: (BOL) keyword search &quot;Creating and Modifying FOREIGN KEY Constraints&quot;, &quot;Disabling FOREIGN KEY Constraints&quot;, &quot;Cascading Referential Integrity Constraints&quot;, &quot;UPDATE&quot;</FONT></B></P>













127. You are the administrator of a SQL Server 2000 computer. The server contains a database named Accounting. The data files are configured as shown below:<BR><BR>
<TABLE BORDER="1" WIDTH="395" HEIGHT="45" CELLSPACING="0"><TR>
<TD WIDTH="96" BGCOLOR="#C0C0C0" HEIGHT="16" ALIGN="left"><FONT FACE="MS Sans Serif" SIZE="2"><B>File Name</B></FONT></TD>
<TD WIDTH="107" BGCOLOR="#C0C0C0" HEIGHT="16" ALIGN="left"><FONT FACE="MS Sans Serif" SIZE="2"><B>Location</B></FONT></TD>
<TD WIDTH="87" BGCOLOR="#C0C0C0" HEIGHT="16" ALIGN="left"><FONT FACE="MS Sans Serif" SIZE="2"><B>Space (MB)</B></FONT></TD>
<TD WIDTH="77" BGCOLOR="#C0C0C0" HEIGHT="16" ALIGN="left"><FONT FACE="MS Sans Serif" SIZE="2"><B>Filegroup</B></FONT></TD></TR><TR>
<TD WIDTH="96" HEIGHT="17" ALIGN="left" VALIGN="top"><FONT FACE="MS Sans Serif" SIZE="2">Account_data</FONT></TD>
<TD WIDTH="107" HEIGHT="17" ALIGN="left" VALIGN="top"><FONT FACE="MS Sans Serif" SIZE="2">E:\Program Files\</FONT></TD>
<TD WIDTH="87" HEIGHT="17" ALIGN="left" VALIGN="top"><FONT FACE="MS Sans Serif" SIZE="2">8000</FONT></TD>
<TD WIDTH="77" HEIGHT="17" ALIGN="left" VALIGN="top"><FONT FACE="MS Sans Serif" SIZE="2">Primary</FONT></TD></TR></TABLE><BR><BR>
The database has grown to 7 GB. The server has no more available disk space. You need to make more disk space available in the accounting database without affecting system performance. What should you do? 

a. Compress drive E. 

b. Add a new hard disk to the server. 
Create a new file on the new hard disk as part of the PRIMARY filegroup. 

c. Add a new hard disk to the server. 
Create a new file on the new hard disk as part of a new filegroup. 

d. Map a network drive to the server. 
Create a new data file on the network drive as part of the PRIMARY filegroup. 

e. Map a network drive on the server. 
Create a new data file on the network drive as part of a new filegroup. 

Answer: B

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><P><FONT FACE="Arial" SIZE="2">Microsoft® SQL Server™ 2000 maps a database using a set of operating-system files. All data and objects in the database, such as tables, stored procedures, triggers, and views, are stored within these operating-system files:</FONT>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2"><B>Primary: </B>This file contains the startup information for the database and is used to store data. Every database has one primary data file.</FONT>
  <LI><FONT FACE="Arial" SIZE="2"><B>Secondary: </B>These files hold all of the data that does not fit in the primary data file. If the primary file can hold all of the data in the database, databases do not need to have secondary data files. Some
    databases may be large enough to need multiple secondary data files or to use secondary files on separate disk drives to spread data across multiple disks.</FONT>
  <LI><B><FONT FACE="Arial" SIZE="2">Transaction Log:</FONT></B> <FONT FACE="Arial" SIZE="2">These files hold the log information used to recover the database. There must be at least one log file for each database.</FONT>
</UL>
<P><FONT FACE="Arial" SIZE="2">For example, a simple database, <B>sales</B>, can be created with one primary file that contains all data and objects and a log file that contains the transaction log information. Alternatively, a more complex database, <B>orders</B>,
can be created with one primary file and five secondary files; the data and objects within the database spread across all six files, and four additional log files contain the transaction log information.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">If the initial data file size is exceeded and the file starts to grow automatically, reevaluate the expected maximum database size and plan accordingly by adding more disk space (if necessary) and creating and adding more
files or filegroups to the database.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">SQL Server 2000 can work quite effectively without filegroups, so many systems will not need to specify user-defined filegroups. In this case, all files are included in the primary filegroup and SQL Server 2000 can allocate
data anywhere in the database. Filegroups are not the only method that can be used to distribute I/O across multiple drives.</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Files and Filegroups&quot;, &quot;Using Files and Filegroups to Manage Database Growth&quot;, &quot;Physical Database Files and Filegroups&quot;</B></FONT></P>












128. You are the administrator of an SQL Server 2000 computer. The server contains a database named Sales. The database stored information that employees use to analyze sales data. You configure the database by using the default options. You create the database tables as shown below:
<br><BR><button onClick="window.open('./70-228/images/128.jpg','Exhibit','height=322,width=408,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>
You want to improve the performance of this query. What should you do? 

a. Create indexes on the foreign key fields. 

b. Create a view to provide the data that the query will use. 

c. Create a stored procedure that executes the query. 

d. Create cascading UPDATE and DELET triggers to the table. 

Answer: A

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2"><P><FONT FACE="Arial" SIZE="2">Indexes play an important role in data warehouse performance, as they do in any relational database. Every dimension table must be indexed on its primary key. Indexes on other columns such as those that identify levels in
the hierarchical structure can also be useful in the performance of some specialized queries.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">The fact table must be indexed on the composite primary key made up of the foreign keys of the dimension tables.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">These are the primary indexes needed for most data warehouse applications because of the simplicity of star and snowflake schemas. Special query and reporting requirements may indicate the need for additional indexes.</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Indexes&quot;</B></FONT></P>










130. You are the administrator of a SQL Server 2000 computer at a bank's headquarters. Customers can access their accounts from headquarters or from branch offices. The server at headquarters maintains a master copy of all account data for all customers. When a customer deposits or withdraws funds at a branch office, the customer's new balance must be reflected on the computers at that office and at headquarters. You want to minimize latency between the headquarters and branch offices. You want to copy account data between the server at headquarters and the servers at the branch offices. What should you do? 

a. Implement merge replication. Use the DATETIME (Later Wins) conflict resolver. Schedule replication for off-peak hours. 

b. Implement transactional replication. Allow immediate-updating subscribers. Schedule replication to run continuously. 

c. Create a data transformation services package on the server at headquarters. Configure the DTS package to import new account data from each of the servers at the branch offices and write it to all other servers. Schedule the DTS package to run during off-peak hours. 

d. Add all branch office servers to the headquarters server as linked servers. Create a job on the headquarters server. Configure the job to query each linked server for new account data and write this data to the other servers. Schedule the job to run every three minutes. 

e. Configure log shipping between the headquarters server and the branch office servers. Configure the headquarters server as the primary server and the branch office servers as secondary servers. Schedule log backups and log shipping to run every 10 minutes. 

Answer: B

<FONT SIZE="3" FACE="Arial" COLOR="black"><B>EXPLANATION: </B></FONT><FONT FACE="Arial" SIZE="2">
<FONT FACE="Arial" SIZE="2"><B>Immediate Updating</B> Enables immediate-updating subscriptions. This means that the replication agents will use Microsoft Distributed Transaction Coordinator (MS DTC) to perform two-phase commits on the transactions that
update subscribers so that changes can be made on the subscriber and immediately replicated on the publisher. The default is to not allow immediate-updating subscriptions.</FONT>
<P><FONT FACE="Arial" SIZE="2"><B>Immediate updating: </B>Enables immediate updating. Immediate updating allows data modifications to replicate data at the Subscriber. Those changes are then sent back to the Publisher and to other Subscribers. Immediate
updating ensures that there are no conflicts. Data modifications are propagated from the Subscriber to the Publisher using two-phase commit protocol (2PC).</FONT></P>
<P><B><FONT FACE="Arial" SIZE="2">--REF: (SAC) ch27, Figure 27-5<BR>
--REF: (BOL) keyword search &quot;Updatable Subscriptions, Create Publication Wizard&quot;&nbsp; <A HREF="mk:@MSITStore:C:/Program%20Files/Microsoft%20SQL%20Server/80">Updatable Subscriptions</A></FONT></B></P>

131. You are the administrator of a SQL Server 2000 computer. You are creating a data transformation services package. As the first step in this process, you need to load data from text files into a database table. These text files contain data on new stores that join your franchise. The text files list the data columns in the following format:<BR><BR>
<FONT FACE="times new roman" size="2">StoreID/BranchID, StoreName/BranchNAME, address, City, State, PostalCode, ManagerID, BranchTypeID, FacilityId.</FONT><BR><BR>
The destination table is configured as shown. You want to load the data into the table as quickly as possible. What should you do?<BR><BR><img src="./70-228/images/Pic228-131.jpg"><BR><BR>

a. Use a Bulk Insert Task to read the data into a temporary table. Use an Execute SQL task to import the appropriate data into the destination table. 

b. Create and edit a format file to select the columns you want to import. Use a bulk insert task, and then specify the format file to import the appropriate data into the destination table. 

c. Use a transform data task to import the data. Use Microsoft ActiveX transformation scripts to write the appropriate data to the appropriate columns in the destination table. 

d. Create and edit a format file to select the columns you want to import. Use a transform data task, and then specify the format file to import the appropriate data into the destination table. 

Answer: B 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">The Bulk Insert task provides the quickest way to copy large amounts of data into a Microsoft® SQL Server™ table or view. To ensure high-speed data movement, transformations cannot be performed on the data while it is moved from the source file to the table or view.<BR><BR><B>--REF: (BOL) keyword search "bulk insert"</B></FONT>













132. You are the administrator of an SQL Server computer. The server is running SQL Server 6.5 and SQL server 7.0. You install a named instance of SQL Server 2000, and then run the SQL Server Upgrade Wizard. On the database selection screen, some of the SQL server 6.5 databases are not listed. You cancel the SQL Server Upgrade Wizard. You need to ensure that the SQL Server 6.5 databases are listed in the wizard. What should you do? 

a. Uninstall SQL Server 7.0, and then rerun the SQL Server Upgrade Wizard. 

b. Run the Microsoft SQL Server-switch application, and then rerun the SQL Server Upgrade Wizard. 

c. Create a data transformation services package that imports the databases from SQL server 6.5 to SQL server 2000, and then execute the package. 

d. Uninstall SQL Server 2000, and then reinstall SQL Server 2000 as the default instance. 

Answer: B

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2">SQL Server version 6.5 or SQL Server version 7.0 servers can operate as default instances. However, a computer can have only one version functioning as the default instance at a time.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">You cannot install a default instance of SQL Server 2000 on a computer that is also running SQL Server 7.0. You must either upgrade the SQL Server 7.0 installation to a default instance of SQL Server 2000, or keep the default instance of SQL Server 7.0 and install a named instance of SQL Server 2000.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">You can install a default instance of SQL Server 2000 on a computer running SQL Server 6.5, but the SQL Server 6.5 installation and the default instance of SQL Server 2000 cannot be running at the same time. You must switch between the two using the SQL Server 2000 <B>vswitch</B> command prompt utility.</FONT></P><P><FONT FACE="Arial" SIZE="2">You cannot version switch between an installation of SQL Server version 7.0 and a default instance of SQL Server 2000.</FONT></P><P><FONT FACE="Arial" SIZE="2">You can have any number of named instances of SQL Server 2000 in addition to the default instance. SQL Server version 6.5 and SQL Server 7.0 cannot operate as named instances, only as default instances.</FONT></P><P><FONT FACE="Arial" SIZE="2">If you run SQL Server version 6.5 as a default instance and run one or more named instances of SQL Server 2000 on a single computer, the computer has two SQL Server program groups instead of one SQL Server program group:</FONT>
<UL TYPE="disc"><LI><FONT FACE="Arial" SIZE="2">A SQL Server 2000 program group executes the SQL Server 2000 tools.</FONT><LI><FONT FACE="Arial" SIZE="2">A SQL Server version 6.5 program group runs the SQL Server 6.5 tools.</FONT></LI></UL><P><FONT FACE="Arial" SIZE="2">If you are running SQL Server version 7.0 with SQL Server 2000, the icons in the SQL Server 7.0 program group will execute the SQL Server 2000 tools.</FONT></P>
<P><FONT FACE="Arial" SIZE="2" COLOR="#008080"><B>Using Version Switching</B></FONT></P>
<P><FONT FACE="Arial" SIZE="2">To use version switching with SQL Server 6.5 and SQL Server 7.0, while at the same time running multiple instances of SQL Server 2000:</FONT><UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">Keep the SQL Server 6.5 configuration intact.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Keep the SQL Server 7.0 configuration intact, with no version upgrade to SQL Server 2000.</FONT><LI><FONT FACE="Arial" SIZE="2">Install one or more named instances of SQL Server 2000.</FONT></LI></UL><P><B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;How to perform a SQL Server version 6.5 to SQL Server 2000 upgrade (SQL Server Upgrade Wizard)&quot;, </FONT>&quot;<FONT FACE="Arial" SIZE="2">How to perform a SQL Server version 7.0 to SQL Server 2000 upgrade (SQL Server Upgrade Wizard)&quot;, </FONT>&quot;<FONT FACE="Arial" SIZE="2">How to upgrade a SQL Server 7.0 installation to SQL Server 2000 (Setup)&quot;, </FONT>&quot;<FONT FACE="Arial" SIZE="2">Working with Three Versions of SQL Server&quot;, &quot;Multiple Instances of SQL Server&quot;, &quot;Working with Named and Multiple Instances of SQL Server 2000&quot;</FONT></B></P>











133. You are the administrator of a new Microsoft Windows 2000 Server computer named CPSRV1. CPSRV1 is a member server in your company's Windows NT 4.0 domain, which is named CPDOMAIN. A separate Windows NT domain named CPUSERS contains all of your company's user accounts. A trust relationship exists between the CPDOMAIN domain and the CPUSERS domain. You are installing SQL Server 2000 on CPSRV1. You specify a service account for each SQL Server service as shown in the following table: <BR><BR>
<DIV ALIGN="center">
  <CENTER>
  <TABLE BORDER="1" CELLSPACING="0">
    <TR>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2"><B>Service </B></FONT></TD>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2"><B>&nbsp;Service Account </B></FONT></TD>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2"><B>Account Type</B></FONT></TD>
    </TR>
    <TR>
      <TD BGCOLOR="#CCCCCC" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2">MSSQLServer</FONT></TD>
      <TD BGCOLOR="#CCCCCC" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2">CPUSERS\sqlsvr</FONT></TD>
      <TD BGCOLOR="#CCCCCC" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2">Domain administrator</FONT></TD>
    </TR>
    <TR>
      <TD BGCOLOR="#CCCCCC" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2">SQLServerAgent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></TD>
      <TD BGCOLOR="#CCCCCC" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2">CPUSERS\sqlagent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></TD>
      <TD BGCOLOR="#CCCCCC" BORDERCOLORLIGHT="#CCCCCC" BORDERCOLORDARK="#999999"><FONT FACE="Arial" SIZE="2">Domain administrator &nbsp;&nbsp;&nbsp;&nbsp; </FONT></TD>
    </TR>  </TABLE>  </CENTER></DIV><BR><BR>
After the installation is complete, the MSSQLServer service and the SQLServerAgent service do not start. You need to configure the services to start without changing any security settings in either domain. 
What should you do? 

a. Configure the services to run under the local system account 

b. Add CPSRV1 to the CPUSERS domain 

c. Add CPUSERS\sqlsvr and CPUSERS\sqlagent to the local administrators group on CPSRV1 

d. Add CPUSERS\sqlsvr and CPUSERS\sqlagent to the CPUSERS\Domain Admins groups. 

e. Add CPUSERS\sqlsvr and CPUSERS\sqlagent to the CPUSERS\Domain users groups. 

Answer: C 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2">For Microsoft SQL Server™ and SQL Server Agent to run as services in Windows, they must be assigned a Windows user account. Typically, both SQL Server and SQL Server Agent are assigned the same user account, either the
local system or domain user account.</FONT></P>
<P><FONT FACE="Arial" SIZE="2">All domain user accounts must have permission to:</FONT>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">Access and change the SQL Server directory (\Program Files\Microsoft SQL Server\Mssql).</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Access and change the .mdf, .ndf, and .ldf database files.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Log on as a service.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">Read and write registry keys </FONT></LI>
</UL>
<P><FONT FACE="Arial" SIZE="2">additional permissions required for certain functionality.</FONT></P>
<UL>
  <LI><FONT FACE="Arial" SIZE="2"><B>SQL Server Agent: </B>Member of the Administrators local group</FONT></LI>
  <LI><FONT FACE="Arial" SIZE="2"><B>SQL Server: </B> Member of local Power Users or local Administrators group</FONT></LI>
</UL>
<P><B><FONT FACE="Arial" SIZE="2">--REF: (BOL) keyword search &quot;Setting up Windows Services Accounts&quot;</FONT></B></P>











134. You are the administrator of 12 SQL Server 2000 computers. These servers are located in company offices throughout the world. You configure a multiserver job on the server in your company's New York City office. You configure this server as a master server, and designate the remaining 11 servers as target servers. 

After the job completes successfully, you decide to set up a new SQL Server 2000 computer as the master server. The new server will be named JobMaster and the other 12 servers will be target servers. You need to make the New York City server a target server instead of a master server. What should you do? 

a. On the New York City server, defect all 11 target servers. 
On the JobMaster server, enlist the 12 servers as target servers. 

b. On the JobMaster server, enlist all other servers as target servers. 

c. On the New York City server enlist the JobMaster server as a target server. 
Transfer the multiserver jobs from the New York City server to the JobMaster server. 

d. On the JobMaster server, enlist the New York City server as a target server. 
On the JobMaster server, enlist the other 11 servers as target servers. 
On the JobMaster server, defect the New York City server. 

Answer: A 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2">With multiserver administration, you must have at least one master server and at least one target server. A master server distributes jobs to and receives events from target servers. A master server stores the central copy
of job definitions for jobs run on target servers. Target servers connect periodically to their master server to update their list of jobs to perform.</FONT>
<P><FONT FACE="Arial" SIZE="2">When creating a multiserver environment, consider the following:</FONT></P>
<UL TYPE="disc">
  <LI><FONT FACE="Arial" SIZE="2">Each target server reports to only one master server. You must defect a target server from one master before you can enlist it into a different one.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">The master and target servers must be running on the Windows NT 4.0 or Windows 2000 operating system.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">When changing the name of a target server, you must defect it before changing the name and reenlist it after the change.</FONT>
  <LI><FONT FACE="Arial" SIZE="2">If you want to dismantle a multiserver configuration, you must defect all the target servers from the master server.</FONT></LI>
</UL>
<P><B><FONT SIZE="2" FACE="Arial">--REF: (BOL) keyword search &quot;Multiserver Administration&quot;</FONT></B></P>









135. You are the administrator of 20 SQL Server 2000 computers. The servers are located in 10 company offices around the world. You work in the New York City. You need to configure several dozen alert responses on each server. In the future, you will need to modify these alert responses periodically. You want to reduce the amount of time you spend managing alert responses. You also want to manage the alert responses from the New York City. What should you do? 

a. Use SQL Enterprise Manager to manage the alert responses on all company servers. 

b. Configure alert forwarding on the remote servers. 

c. Write Transact-SQL scripts that can be used to set up alert responses on the remote servers. 

d. Write stored procedures that can be used to set up alert responses on the remote servers. 

Answer: B 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">Multiserver administration is the process of automating administration across multiple instances of Microsoft® SQL Server™. A master server distributes jobs to and receives events from target servers. A master server stores the central copy of job definitions for jobs run on target servers. Target servers connect periodically to their master server to update their list of jobs to perform. If a new job exists, the target server downloads the job and disconnects from the master server. After the target server completes the job, it reconnects to the master server and reports the status of the job.<BR><BR><B>--REF: (BOL) keyword search "Multiserver Administration"</B></FONT>















136. You are the administrator of a SQL Server 2000 computer. The server contains a database named Customers, which is used by a custom client/server application. The database contains more than 1 million rows. Users report that the database responds slowly when they search for customers by using the application. Users search for customers by scrolling through an alphabetical list of customer names. You use SQL profiles to capture information about how the application uses the database. You receive results as shown below: 


Event Class Text Data 

SQL: Batch completed Select* from customers 


You need to improve the application¡¦s performance. What should you do? 

a. Create additional non-clustered indexes on the CustomerInformation table. 

b. Rewrite the application so that it uses a user-defined function to return the customer list. 

c. Rewrite the application so that it uses a query with a WHERE clause to search for customer names. 

d. Rewrite the application so that is uses a stored procedure to return the customer list. 

Answer: C

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">The WHERE and HAVING clauses in a SELECT statement control the rows from the source tables that are used to build the result set. WHERE and HAVING are filters. They specify a series of search conditions, and only those rows that meet the terms of the search conditions are used to build the result set. Those rows meeting the search conditions are said to be qualified to participate in the result set.<BR><BR><B>--REF: (BOL) keyword search "Filtering Rows with WHERE and HAVING"</B></FONT>











137. You are the administrator of a Microsoft Windows 2000 computer. The computer is also running SQL Server 2000 and contains a database named Sales. The sales department of your company uses a custom application that has just been upgraded. A user at your company named Pedro reports that when he attempts to run the weekly analysis report, he receives the following error message:<BR><BR><FONT FACE="times new roman">
Server.Msg3704, Level 16, State 1 , Line 1<BR>User dos not have permission to perform this operation on table Report</FONT><BR><BR>You log on to Pedro's computer, run the program, and receive no error message. You use SQL Profiler to trace database activity while you run the report. You receive the results shown below:<BR><BR>
<img src="./70-228/images/PIc228-137.jpg"><BR><BR>
You want to allow Pedro to run the report. You also want to minimize administrative overhead. What should you do? 

a. Add Pedro's login to the db_ddladmin role in the Sales database. 

b. Create an application role for the sales department's application. Grant the role database owner rights. 

c. Add Pedro to the db_datawriter role in the Sales database. 

d. Add Pedro to the local administrators group on the server. 

Answer: A 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2">The SQL language has two main divisions: Data Definition Language (DDL), which is used to define and manage all the objects in an SQL database, and Data Manipulation Language (DML), which is used to select, insert, update,
and delete data in the objects defined using DDL. The Transact-SQL DDL used to manage objects such as databases, tables, and views is based on SQL-92 DDL statements, with extensions. For each object class, there are usually CREATE, ALTER, and DROP statements, such as CREATE TABLE, ALTER TABLE, and DROP TABLE. Permissions are controlled using the SQL-92 GRANT and REVOKE statements, and the Transact-SQL DENY statement.</FONT></P><P><FONT FACE="Arial" SIZE="2">The<B> db_ddladmin&nbsp; </B>Adds, modifies, or drops objects in the database (runs all DLs). </FONT></P><P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Adding a Member to a Predefined Role&quot;, &quot; DDL and Stored Procedures&quot;</B></FONT></P>








138. You are the administrator of a SQL Server 2000 computer. The server contains a database named Sales. Your company deploys an upgraded version of a customer relationship management application, which accesses the sales database. 

The sales database contains a table named Customer, which stores information about your company's customers. Users report that they cannot delete information in the CustomerAddress2 column. The Customer table is configured in the exhibit:<BR>
<br><button onClick="window.open('./70-228/images/PIC228-138.jpg','Exhibit','height=424,width=383,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>
You use SQL Profiler to capture the activity of the application and receive the results shown below:
<P ALIGN="center"><img src="./70-228/images/PIC228-138a.jpg"></P>
You want to configure the Customer table to support the upgraded application. What should you do? 

a. Alter the table to allow null values in the CustomerAddress2 column. 

b. Alter the data type of the CustomerAddress2 column to sql_variant. 

c. Create an UPDATE trigger that changes a null value in the CustomerAddress2 column to an empty string. 

d. Use an INSTEAD OF trigger to change the value of the CustomerAddress2 column to an empty string whenever the column¡¦s value is null. 

Answer: A 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">A value of NULL indicates the value is unknown. A value of NULL is different from an empty or zero value. No two null values are equal. Comparisons between two null values, or between a NULL and any other value, return unknown because the value of each NULL is unknown. SQL Server 2000 supports five classes of constraints. The NOT NULL constraint specifies that the column does not accept NULL values.<BR><BR><B>--REF: (BOL) keyword search "Null Values", "Constraints"</B></FONT>








139. You are the administrator of a SQL Server 2000 computer. You import a large amount of data into the contracts database. After the import, you perform a full database backup. You examine the hard disk and discover that the log file has grown from 200MB to 800MB. You want to recover disk space as quickly as possible without losing backup information. Which two Transact-SQL statements should you execute? (Each correct answer presents part of the solution. Choose two) 

a. BACKUP LOG Contracts WITH no_log 

b. BACKUP LOG Contracts WITH truncate_only 

c. BACKUP LOG Contracts TO disk= E: \SQLBackup\Contracts_Log.bkp 

d. ALTER DATABASE Contracts 
(Name= Contract_Log.ldf, 
FILENAME= E: \Data\Contracts_ldf, 
SIZE= 200) 

e. DBCC ShrinkDatabase (Contracts, 200) 

f. DBCC ShrinkFile (Contracts_Log, 200) 

Answer: C, F 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2"><FONT COLOR="#FF0000">When SQL Server finishes backing up the transaction log, it automatically truncates the inactive portion of the transaction log.</FONT> This inactive portion contains completed transactions and so is no
longer used during the recovery process. Conversely, the active portion of the transaction log contains transactions that are still running and have not yet completed. <FONT COLOR="#FF0000">SQL Server reuses this truncated, inactive space in the
transaction log instead of allowing the transaction log to continue to grow and use more space.</FONT></FONT></P>
<P><FONT FACE="Arial" SIZE="2">The NO_LOG and TRUNCATE_ONLY are synonyms. Both clauses of BACKUP remove the inactive part of the log without making a backup copy of it and truncate the log.</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><FONT COLOR="#FF0000">Log truncation does not reduce the size of a physical log file</FONT>, it reduces the size of the logical log and marks as inactive the virtual logs that do not hold any part of the logical log.<FONT COLOR="#800000">
</FONT><FONT COLOR="#FF0000">A log shrink operation removes enough inactive virtual logs to reduce the log file to the requested size.</FONT></FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>--REF: (BOL) keyword search &quot;Backup and Restore (Level 2)&quot;, &quot;Transaction Log Backups&quot;, &quot;DBCC SHRINKFILE&quot;</B></FONT></P>








140. You are the administrator of two Microsoft Windows 2000 Advanced Server computers. On these servers, you are configuring a database that will store accounting information for your company. The data must be available at all times. Interruptions in data connectivity should not last longer than five minutes. Any changes to the database should not require you to reconfigure the client computers. How should you configure the database? 

a. Configure the database on the two servers as a SQL Server 2000 cluster. 

b. Configure the database on one server, and then configure a standby database on the second server. 

c. Configure the database on each server. 
Use Microsoft Distributed Transaction Coordinator to keep the two servers perfectly synchronized. 

d. Configure the database as a federated database, and then partition half the data on each server. 

Answer: A 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">Microsoft® SQL Server™ 2000 failover clustering increases server availability by allowing a system to automatically switch the processing for an instance of SQL Server from a failed server to a working server. For example, an instance of SQL Server can quickly restore database services to a Web site or enterprise network even if the server running the instance fails. SQL Server 2000 implements failover clustering based on the failover clustering features of the Microsoft Clustering Service (MSCS) in Windows NT® 4.0 and Windows® 2000.<BR><BR><B>--REF: (BOL) keyword search "Failover Clustering Architecture"</B></FONT>








141. You are the administrator of a SQL Server 2000 computer. The server contains a database named Contracts. The server is configured as shown in the server configuration exhibit.<br>
<BR><button onClick="window.open('./70-228/images/PIC228-141.jpg','Exhibit','height=342,width=292,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Server configuration</button>
<BR><BR>
The database files are configured as shown in the database properties exhibit.<br><BR><button onClick="window.open('./70-228/images/PIC228-141a.jpg','Exhibit','height=455,width=480,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Database properties</button><BR><BR>
The database developers have been creating new tables and indexes without specifying a filegroup. The primary filegroup is reaching its maximum capacity. You want the developers to continue adding new objects, but you do not want then to change the way they create objects. You do not want to run out of disk space. You also want to minimize the time it takes to administer the database. What should you do? 

a. Back up the existing objects on the PRIMARY filegroup. Drop them from the database. Re-create them on the SECONDARY filegroup. 

b. Set the file growth on the PRIMARY filegroup to UNLIMITED. 

c. Set the PRIMARY filegroup so that it is read-only. 

d. Set the SECONDARY filegroup as the default filegroup. 

Answer: D 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">At any time, exactly one filegroup is designated as the DEFAULT filegroup. When objects are created in the database without specifying to which filegroup they belong, they are assigned to the default filegroup. The default filegroup must be large enough to hold any objects not allocated to a user-defined filegroup. Initially, the primary filegroup is the default filegroup.<BR><BR><B>--REF: (BOL) keyword search "Default Filegroups"</B></FONT>








142. You have been hired as an administrator of an SQL Server 2000 computer. The SQL Server 2000 computer is located within a Windows NT domain named Online. The server has been configured to use Windows Authentication. Several users on the network attempt to connect to the server through the use of the SQL Query Analyzer but are unable to. These users are members of a domain user group named DBUsers. The server contains a login for Online\DBUsers. A new client/server application is being used on the network that uses its own security. The new application will access the server by using a login named ClientServApp1. You create a domain user account named ClientServApp1 and add it to the DBUsers domain user group. However, when you try to run the client/server application, you receive the error message, "The required SQL Server database cannot be accessed." You need to ensure that the application runs properly. What should you do? 

a. Remove the ClientServApp1 domain user account from the DBUsers domain user group. Create a login for Online\ClientServApp1. 

b. Configure the server for Mixed Mode authentication. Create a login named ClientServApp1, and configure it to access the application's database. 

c. Create a local user account on the server, and name it ClientServApp1. Add a login for BUILTIN\C sapp1. 

d. Configure an application role in the application's database, and name the role ClientServApp1. Set the application role password so that it is the same as the ClientServApp1 user account password. 

Answer: B 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2"><P><FONT FACE="Arial" SIZE="2"><B>sp_grantlogin </B>allows a Microsoft® Windows NT® user or group account to connect to Microsoft SQL Server™ using Windows Authentication.</FONT></P>
<P><FONT FACE="Arial" SIZE="2"><B>sp_grantdbaccess </B>adds a security account in the current database for a Microsoft® SQL Server™ login or Microsoft Windows NT® user or group, and enables it to be granted permissions to perform activities in the
database.</FONT></P>
<P>&nbsp;<B><FONT FACE="Wingdings" SIZE="6" COLOR="#ff0000">?</FONT><FONT FACE="Arial" COLOR="#ff0000" SIZE="2"> </FONT><FONT FACE="Arial" SIZE="2" COLOR="#008080">This is kind of a &quot;trick question&quot;, Mixed mode does not come into play, answer
(B) is the only answer that connects using server access and database access.</FONT></B></P>






143. You have been hired as an administrator of an SQL Server 2000 computer. The server is used to store information for your company's accounting department. The Permissions on the accounting table are configured as shown below.
<P ALIGN="center"><img src="./70-228/images/PIC228-143.jpg"></P>
Bruno is a member of the Managers and Salespeople database roles. While working in the table, he reports that he can edit and remove information. However, he cannot view any of the information in the table. You need to allow Bruno to view the information in the Accounting table. Which Transact-SQL statement should you execute? 

A. GRANT PRIVILEGES ON Accounting TO Bruno
B. GRANT SELECT ON Accounting TO Bruno WITH GRANT OPTION
C. REVOKE GRANT OPTION FOR SELECT ON Accounting TO Bruno
D. REVOKE SELECT ON Accounting FROM Bruno 
 
Answer: D 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">You can revoke a permission that has been granted or denied previously. Revoking is similar to denying in that both remove a granted permission at the same level. However, although revoking a permission removes a granted permission, it does not prevent the user, group, or role from inheriting a granted permission from a higher level. Therefore, if you revoke permission for a user to view a table, you do not necessarily prevent the user from viewing the table because permission to view the table was granted to a role to which he belongs.<BR><BR><B>--REF: (BOL) keyword search "Revoking Permissions"</B></FONT>










144. You have been hired as an administrator of an SQL Server 2000 computer. The server contains a database named Assets. The database is configured as shown in the exhibit: 
<br><BR><button onClick="window.open('./70-228/images/PIC228-144.jpg','Exhibit','height=296,width=464,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Exhibit</button><BR><BR>

Users of the database frequently require details about parts. Database users search for parts information using the following query: 
<P><FONT FACE="Arial" SIZE="2"><FONT COLOR="#0000FF">SELECT</FONT> Parts.SKU, Locations.Description, Manufacturer.Name, <BR>
PartsLocations.City, PartsLocations.LastInventoried <BR>
<BR>
<FONT COLOR="#0000FF">FROM</FONT><FONT COLOR="#808080"> </FONT>Parts <BR>
<BR>
<FONT COLOR="#0000FF">INNER</FONT> <FONT COLOR="#808080">JOIN</FONT> Manufacturer <FONT COLOR="#0000FF">ON</FONT> Parts.ManufacturerID= Manufacturer.ManufacturerID <BR>
<FONT COLOR="#0000FF">INNER</FONT> <FONT COLOR="#808080">JOIN</FONT> Locations <FONT COLOR="#0000FF">ON</FONT> Parts.LocationID= Loactions.LocationID <BR>
<FONT COLOR="#0000FF">WHERE</FONT> SKU = ? </FONT></P>


You need to accelerate query response time. What should you do? 

a. Create a parameterized stored procedure to retrieve the data. 

b. Create a denormalized table that is maintained by triggers. 

c. Use ad hoc queries to retrieve the data. 

d. Create a nonclustered index on the primary key of each table. 

Answer: C 

<P><SPAN ID="COMM0"><FONT COLOR="black" FACE="Arial" SIZE="3"><B>EXPLANATION: </B></FONT><FONT COLOR="black" FACE="Arial" SIZE="2">The Execute SQL task can use global variables to populate input parameters in SQL commands, including queries and stored
procedures when the source data provider supports parameters. You can write a parameterized query where the value in the SQL statement is filled in at run time by using a question mark as a parameter placeholder. Then, you can map a global variable to the
parameter placeholder to specify which global variable will be used at run time in place of the question mark.</FONT></SPAN></P>
<P><FONT FACE="Arial" SIZE="2">For most databases, prepared execution is faster than direct execution for statements executed more than three or four times primarily because the statement is compiled only once, while statements executed directly are
compiled each time they are executed. Prepared statements cannot be used to create temporary objects on SQL Server if the option to generate stored procedures is active. </FONT></P>
<P><FONT FACE="Arial" SIZE="2">In Microsoft® SQL Server™ 2000, using parameters or parameter markers in Transact-SQL statements increases the ability of the relational engine to match new SQL statements with existing, unused execution plans. If an SQL
statement is executed without parameters, SQL Server 2000 parameterizes the statement internally to increase the possibility of matching it against an existing execution plan.</FONT> <FONT FACE="Arial" SIZE="2">Consider this statement:</FONT></P>
<P><CODE><FONT FACE="Arial" SIZE="2"><B>SELECT * FROM Northwind.dbo.Products WHERE CategoryID = 1</B></FONT></CODE></P>
<P><FONT FACE="Arial" SIZE="2">The value 1 at the end of the statement can be specified as a parameter. The relational engine builds the execution plan for this batch as if a parameter had been specified in place of the value 1. Because of this
auto-parameterization, SQL Server 2000 recognizes that the following two statements generate essentially the same execution plan and reuses the first plan for the second statement:</FONT></P>
<P><CODE><FONT FACE="Arial" SIZE="2"><B>SELECT * FROM Northwind.dbo.Products WHERE CategoryID = 1<BR>
SELECT * FROM Northwind.dbo.Products WHERE CategoryID = 4</B><BR>
</FONT></CODE><SPAN ID="COMM0"><B><FONT SIZE="6" COLOR="#FF0000"><FONT FACE="Arial">&nbsp;</FONT><FONT FACE="Wingdings">?</FONT></FONT><FONT COLOR="black" FACE="Wingdings" SIZE="3"> </FONT></B><FONT COLOR="#008080"><FONT FACE="Arial" SIZE="2">Answer (A)
would be wrong because the &quot;?&quot; in the WHERE statement </FONT><FONT FACE="Arial" SIZE="2">makes this a </FONT></FONT></SPAN><FONT COLOR="#008080"><FONT FACE="Verdana" SIZE="2"><SPAN ID="ENGL4">parameterized stored procedure. (B) </SPAN></FONT><FONT FACE="Verdana" SIZE="2"><SPAN ID="ENGL5">denormalizing
the table </SPAN></FONT><FONT FACE="Verdana" SIZE="2"><SPAN ID="ENGL4">would be unconventional but would work based on the relatively small amount of columns involved in the database (a view would be better) But, you would not use triggers to maintain one
table. (C) Creating a </SPAN></FONT><FONT FACE="Verdana" SIZE="2"><SPAN ID="ENGL6">nonclustered index on the primary key of each table. would increase the overhead. The statement does not include any columns with key values nor does the WHERE statement
call on a key. </SPAN></FONT></FONT></P>
<P><B><FONT SIZE="2" FACE="Arial"><SPAN ID="COMM1">--REF: (BOL) keyword search &quot;</SPAN>Parameters and Execution Plan Reuse<SPAN ID="COMM1">&quot;, &quot;</SPAN>Auto-Parameterization<SPAN ID="COMM1">&quot;</SPAN></FONT></B></P>










145. You have been hired as an administrator of an SQL Server 2000 computer that contains confidential information regarding business development for your company. Company management has created a policy that requires that all offers made to purchase other businesses be removed permanently from the database six months after the offer is made. You must configure the database to comply with this policy and minimize server overhead. What should you do? 

a. Create a data Transformation Services (DTS) package to remove bids that have a closing date older 
than six months. 

b. Create a trigger to delete any bids that have a closing data older than six months. 
Bind the trigger to the bids table for all INSERT, UPDATE, and DELETE events. 

c. Create a stored procedure to delete any bids that have a closing date older than six months. 
Use SQL server agent to schedule the stored procedure to run every night. 

d. Create a view that contains a WHERE clause to exclude bids that have a closing date older than six months. 

Answer: C

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">A stored procedure is a group of Transact-SQL statements compiled into a single execution plan. Almost any Transact-SQL code that can be written as a batch can be used to create a stored procedure.<BR><BR>Stored procedures assist in achieving a consistent implementation of logic across applications. The SQL statements and logic needed to perform a commonly performed task can be designed, coded, and tested once in a stored procedure. Each application needing to perform that task can then simply execute the stored procedure. Coding business logic into a single stored procedure also offers a single point of control for ensuring that business rules are correctly enforced.<BR><BR>Every job must have at least one job step. Job steps can be operating system commands, Transact-SQL statements, Microsoft® ActiveX® scripts, or replication tasks.<BR><BR><B>--REF: (BOL) keyword search "Programming Stored Procedures", "SQL Stored Procedures", "Creating Job Steps"</B></FONT>









146. You are the administrator of a SQL Server 2000 computer. The server 
contains a database named Sales. Users report that they cannot add new data to 
the database. You examine the properties of the database. The  database is 
configured as shown in the Sales Properties exhibit.<br><BR><button onClick="window.open('./70-228/images/PIC228-146.jpg','Exhibit','height=458,width=484,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Sales Properties exhibit</button><BR><BR> 

You examine drive E. The hard disk is configured as shown in the Local Disk 
Properties exhibit.<br><BR><button onClick="window.open('./70-228/images/PIC228-146a.jpg','Exhibit','height=434,width=352,status=no,toolbar=no,menubar=no,location=no,titlebar=no,scrollbars=no,alwaysRaised=1,resizable=yes')">Local Disk Properties exhibit</button><BR><BR>
You want the users to be able to add data, and you want to minimize administrative overhead. What should you do? 

A. Increase the maximum file size of Sales_Data to 1,500 MB. 

B. Use the DBCC SHRINKDATABASE statement. 

C. Set automatic file growth to 10 percent.
  
D. Create another data file named Sales_Data2 in a new SECONDARY filegroup. 

Answer: A 

<font size=3 face=Arial color=black><B>EXPLANATION: </B></font><font face="Arial" size="2">
<P><FONT FACE="Wingdings" SIZE="6" COLOR="#ff0000"><B>?</B></FONT>&nbsp;&nbsp;<FONT COLOR="#008080">The easiest way to add space is to increase the database size. All other options would increase administrative overhead. In (C)'s case, through monitoring
the disk space. The database is restricted to 1001MB, you would not be able to add a file or file group without removing the restriction.</FONT></P>









147. You are the administrator of a SQL Server 2000 computer. The Server contains a database that stores product data for your company 

You need to run a report that summarizes data about these products. When you run the report it does not complete. 

Several users are connected to the database. You execute the sp_lock stored procedure and recieve the following output <BR><BR>

<DIV ALIGN="center">
  <CENTER>
  <TABLE BORDER="0" BGCOLOR="#CCCCCC">
    <TR>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#999999" BORDERCOLORDARK="#999999">
        <P ALIGN="center"><FONT FACE="Arial"><B>spid</B></FONT></TD>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#999999" BORDERCOLORDARK="#999999">
        <P ALIGN="center"><FONT FACE="Arial"><B>dbid</B></FONT></TD>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#999999" BORDERCOLORDARK="#999999">
        <P ALIGN="center"><FONT FACE="Arial"><B>objid</B></FONT></TD>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#999999" BORDERCOLORDARK="#999999">
        <P ALIGN="center"><FONT FACE="Arial"><B>indID</B></FONT></TD>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#999999" BORDERCOLORDARK="#999999">
        <P ALIGN="center"><FONT FACE="Arial"><B>Type</B></FONT></TD>
      <TD BGCOLOR="#999999" BORDERCOLORLIGHT="#999999" BORDERCOLORDARK="#999999">
        <P ALIGN="center"><FONT FACE="Arial"><B>&nbsp;Mode </B></FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">67</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">DB</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">S </FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">64</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">&nbsp;7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">DB </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">S</FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">72</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">DB</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">S</FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">72</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">RID</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">S </FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">72</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952 </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">PAG&nbsp; </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">IS</FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">72</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">&nbsp;2145623952</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">TAB </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">IS </FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">72</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952 </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">RID </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">S </FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">78</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">DB</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">S</FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">78</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">1</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">RID</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">X </FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">78</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952 </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">1</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">PAG</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">IX </FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">78</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952 </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">0</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">TAB</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">IX</FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">78</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">1</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">RID </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">X</FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">78</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">1</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">PAG&nbsp; </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">IX</FONT></TD>
    </TR>
    <TR>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">78</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">7 </FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">2145623952</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">1</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">RID</FONT></TD>
      <TD>
        <P ALIGN="center"><FONT FACE="Arial">X </FONT></TD>
    </TR>
  </TABLE>
  </CENTER>
</DIV>

you want the report to complete successfully. What should you do? 

A. Execute the sp_releaseapplock stored procedure 
B. Grant SELECT permissions on the Products Table to all users 
C. Release locks held by 72 
D. Release locks held by 78 

Answer: D

<font size=3 face=Arial color=black><B>EXPLANATION: </B>
 </font><font face="Arial" size="2"><p><font face="Arial">The <b>Type</b> column shows the type of the resource
currently locked.</font></p>
<table border="1" cellPadding="2" cols="2" frame="box" rules="all" width="644">
  <tbody>
    <tr vAlign="top">
      <th class="label" width="115" bgcolor="#008080"><b><font face="Arial" size="2" color="#FFFFFF">Resource
        type</font></b></th>
      <th class="label" width="509" bgcolor="#008080"><b><font face="Arial" size="2" color="#FFFFFF">Description</font></b></th>
    </tr>
    <tr vAlign="top">
      <td width="115" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>RID</b></font></td>
      <td width="509" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>Row
        identifier used to lock a single row within a table.</b></font></td>
    </tr>
    <tr vAlign="top">
      <td width="115" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>KEY</b></font></td>
      <td width="509" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>Row
        lock within an index. Used to protect key ranges in serializable
        transactions.</b></font></td>
    </tr>
    <tr vAlign="top">
      <td width="115" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>PAG</b></font></td>
      <td width="509" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>Data
        or index page.</b></font></td>
    </tr>
    <tr vAlign="top">
      <td width="115" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>EXT</b></font></td>
      <td width="509" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>Contiguous
        group of eight data pages or index pages.</b></font></td>
    </tr>
    <tr vAlign="top">
      <td width="115" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>TAB</b></font></td>
      <td width="509" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>Entire
        table, including all data and indexes.</b></font></td>
    </tr>
    <tr vAlign="top">
      <td width="115" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>DB</b></font></td>
      <td width="509" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow"><b>Database.</b></font></td>
    </tr>
  </tbody>
</table>
<br>
<p><font face="Arial">SQL Server uses these resource lock modes.</font></p>
<table border="1" cellPadding="2" cols="2" frame="box" rules="all" width="643">
  <tbody>
    <tr vAlign="top">
      <th class="label" width="127" bgcolor="#008080"><font face="Arial" size="2" color="#FFFFFF">Lock
        mode</font></th>
      <th class="label" width="496" bgcolor="#008080"><font face="Arial" size="2" color="#FFFFFF">Description</font></th>
    </tr>
    <tr vAlign="top">
      <td width="127" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Shared
        (S)</font></td>
      <td width="496" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Used
        for operations that do not change or update data (read-only operations),
        such as a SELECT statement.</font></td>
    </tr>
    <tr vAlign="top">
      <td width="127" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Update
        (U)</font></td>
      <td width="496" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Used
        on resources that can be updated. Prevents a common form of deadlock
        that occurs when multiple sessions are reading, locking, and potentially
        updating resources later.</font></td>
    </tr>
    <tr vAlign="top">
      <td width="127" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Exclusive
        (X)</font></td>
      <td width="496" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Used
        for data-modification operations, such as INSERT, UPDATE, or DELETE.
        Ensures that multiple updates cannot be made to the same resource at the
        same time.</font></td>
    </tr>
    <tr vAlign="top">
      <td width="127" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Intent</font></td>
      <td width="496" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Used
        to establish a lock hierarchy. The types of intent locks are: intent
        shared (IS), intent exclusive (IX), and shared with intent exclusive
        (SIX).</font></td>
    </tr>
    <tr vAlign="top">
      <td width="127" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Schema</font></td>
      <td width="496" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Used
        when an operation dependent on the schema of a table is executing. The
        types of schema locks are: schema modification (Sch-M) and schema
        stability (Sch-S).</font></td>
    </tr>
    <tr vAlign="top">
      <td width="127" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Bulk
        Update (BU)</font></td>
      <td width="496" bgcolor="#C0C0C0"><font size="2" face="Arial Narrow">Used
        when bulk-copying data into a table and the <b>TABLOCK</b> hint is
        specified.</font></td>
    </tr>  </tbody></table>





